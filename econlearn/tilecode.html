<!DOCTYPE html>
<!-- Generated by Cython 0.20.2 on Thu Aug  7 21:03:24 2014 -->
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">

body { font-family: courier; font-size: 12; }

.code  { font-size: 9; color: #444444; display: none; margin-left: 20px; }
.py_c_api  { color: red; }
.py_macro_api  { color: #FF7000; }
.pyx_c_api  { color: #FF3000; }
.pyx_macro_api  { color: #FF7000; }
.refnanny  { color: #FFA000; }

.error_goto  { color: #FFA000; }

.tag  {  }

.coerce  { color: #008000; border: 1px dotted #008000 }

.py_attr { color: #FF0000; font-weight: bold; }
.c_attr  { color: #0000FF; }

.py_call { color: #FF0000; font-weight: bold; }
.c_call  { color: #0000FF; }

.line { margin: 0em }

</style>
<script>
function toggleDiv(id) {
    theDiv = document.getElementById(id);
    if (theDiv.style.display != 'block') theDiv.style.display = 'block';
    else theDiv.style.display = 'none';
}
</script>
</head>
        <body>
<p>Generated by Cython 0.20.2 on Thu Aug  7 21:03:24 2014
<p>Raw output: <a href="tilecode.c">tilecode.c</a>
<pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line1")'> 1: #!python</pre>
<pre id='line1' class='code' style='background-color: #FFFF79'>  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line2")'> 2: #cython: boundscheck=False, wraparound=False, nonecheck=False, cdivision=False, initializedcheck=False</pre>
<pre id='line2' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line3")'> 3: </pre>
<pre id='line3' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line4")'> 4: from __future__ import division</pre>
<pre id='line4' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line5")'> 5: import pylab</pre>
<pre id='line5' class='code' style='background-color: #FFFF8d'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_pylab, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_pylab, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line6")'> 6: cimport numpy as np</pre>
<pre id='line6' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line7")'> 7: import numpy as np</pre>
<pre id='line7' class='code' style='background-color: #FFFF8d'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line8")'> 8: import time</pre>
<pre id='line8' class='code' style='background-color: #FFFF8d'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_time, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_time, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line9")'> 9: cimport cython</pre>
<pre id='line9' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line10")'> 10: from sklearn.linear_model import LinearRegression as OLS</pre>
<pre id='line10' class='code' style='background-color: #FFFF57'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_LinearRegression);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_LinearRegression);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_LinearRegression);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_sklearn_linear_model, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_LinearRegression);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_OLS, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line11")'> 11: from displace import Displace</pre>
<pre id='line11' class='code' style='background-color: #FFFF57'>
  /* "econlearn/tilecode.pyx":11
 * cimport cython
 * from sklearn.linear_model import LinearRegression as OLS
 * from displace import Displace             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * from cython.parallel import prange, parallel
 * from cython_gsl cimport *
 */
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Displace);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_Displace);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Displace);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_displace, __pyx_t_2, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_Displace);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Displace, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line12")'> 12: from cython.parallel import prange, parallel</pre>
<pre id='line12' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line13")'> 13: from cython_gsl cimport *</pre>
<pre id='line13' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line14")'> 14: </pre>
<pre id='line14' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line15")'> 15: # ===============================================</pre>
<pre id='line15' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line16")'> 16: #   Inline functions</pre>
<pre id='line16' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line17")'> 17: # ===============================================</pre>
<pre id='line17' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line18")'> 18: </pre>
<pre id='line18' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line19")'> 19: cdef inline int getindex(int j, int i, double[:, :] XS, int D, double[:,:] offset, int[:] flat, int size, int dohash, int mem_max, int[:] key) nogil:</pre>
<pre id='line19' class='code' style='background-color: #FFFFff'>static CYTHON_INLINE int __pyx_f_9econlearn_8tilecode_getindex(int __pyx_v_j, int __pyx_v_i, __Pyx_memviewslice __pyx_v_XS, int __pyx_v_D, __Pyx_memviewslice __pyx_v_offset, __Pyx_memviewslice __pyx_v_flat, int __pyx_v_size, int __pyx_v_dohash, int __pyx_v_mem_max, __Pyx_memviewslice __pyx_v_key) {
  int __pyx_v_idx;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line20")'> 20: </pre>
<pre id='line20' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line21")'> 21:     cdef int idx = 0</pre>
<pre id='line21' class='code' style='background-color: #FFFFff'>  __pyx_v_idx = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line22")'> 22: </pre>
<pre id='line22' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line23")'> 23:     idx = index(j, i, XS, D, offset, flat, size)</pre>
<pre id='line23' class='code' style='background-color: #FFFFff'>  __pyx_v_idx = __pyx_f_9econlearn_8tilecode_index(__pyx_v_j, __pyx_v_i, __pyx_v_XS, __pyx_v_D, __pyx_v_offset, __pyx_v_flat, __pyx_v_size);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line24")'> 24: </pre>
<pre id='line24' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line25")'> 25:     if dohash == 1:</pre>
<pre id='line25' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = ((__pyx_v_dohash == 1) != 0);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line26")'> 26:         idx = hash_idx(idx, key, mem_max)</pre>
<pre id='line26' class='code' style='background-color: #FFFFff'>    __pyx_v_idx = __pyx_f_9econlearn_8tilecode_hash_idx(__pyx_v_idx, __pyx_v_key, __pyx_v_mem_max);
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line27")'> 27: </pre>
<pre id='line27' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line28")'> 28:     return idx</pre>
<pre id='line28' class='code' style='background-color: #FFFFff'>  __pyx_r = __pyx_v_idx;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line29")'> 29: </pre>
<pre id='line29' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line30")'> 30: cdef inline int index(int j, int i, double[:, :] XS, int D, double[:,:] offset, int[:] flat, int size) nogil:</pre>
<pre id='line30' class='code' style='background-color: #FFFFff'>static CYTHON_INLINE int __pyx_f_9econlearn_8tilecode_index(int __pyx_v_j, int __pyx_v_i, __Pyx_memviewslice __pyx_v_XS, int __pyx_v_D, __Pyx_memviewslice __pyx_v_offset, __Pyx_memviewslice __pyx_v_flat, int __pyx_v_size) {
  int __pyx_v_k;
  int __pyx_v_idx;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line31")'> 31: </pre>
<pre id='line31' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line32")'> 32:     cdef int k, idx = 0</pre>
<pre id='line32' class='code' style='background-color: #FFFFff'>  __pyx_v_idx = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line33")'> 33: </pre>
<pre id='line33' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line34")'> 34:     for k in range(D):</pre>
<pre id='line34' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_D;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_k = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line35")'> 35:         idx +=  c_int(XS[i, k] + offset[j, k]) * flat[k]</pre>
<pre id='line35' class='code' style='background-color: #FFFFff'>    __pyx_t_3 = __pyx_v_i;
    __pyx_t_4 = __pyx_v_k;
    __pyx_t_5 = __pyx_v_j;
    __pyx_t_6 = __pyx_v_k;
    __pyx_t_7 = __pyx_v_k;
    __pyx_v_idx = (__pyx_v_idx + (Real2Int(((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_XS.data + __pyx_t_3 * __pyx_v_XS.strides[0]) ) + __pyx_t_4 * __pyx_v_XS.strides[1]) ))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_offset.data + __pyx_t_5 * __pyx_v_offset.strides[0]) ) + __pyx_t_6 * __pyx_v_offset.strides[1]) ))))) * (*((int *) ( /* dim=0 */ (__pyx_v_flat.data + __pyx_t_7 * __pyx_v_flat.strides[0]) )))));
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line36")'> 36:     idx += size * j</pre>
<pre id='line36' class='code' style='background-color: #FFFFff'>  __pyx_v_idx = (__pyx_v_idx + (__pyx_v_size * __pyx_v_j));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line37")'> 37: </pre>
<pre id='line37' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line38")'> 38:     return idx</pre>
<pre id='line38' class='code' style='background-color: #FFFFff'>  __pyx_r = __pyx_v_idx;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line39")'> 39: </pre>
<pre id='line39' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line40")'> 40: cdef inline int hash_idx(int idx, int[:] key, int mem_max) nogil:</pre>
<pre id='line40' class='code' style='background-color: #FFFFd4'>static CYTHON_INLINE int __pyx_f_9econlearn_8tilecode_hash_idx(int __pyx_v_idx, __Pyx_memviewslice __pyx_v_key, int __pyx_v_mem_max) {
  int __pyx_v_hashidx;
  int __pyx_v_n;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("econlearn.tilecode.hash_idx", __pyx_clineno, __pyx_lineno, __pyx_filename, 0);
  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line41")'> 41: </pre>
<pre id='line41' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line42")'> 42:     cdef int hashidx = 0</pre>
<pre id='line42' class='code' style='background-color: #FFFFff'>  __pyx_v_hashidx = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line43")'> 43:     cdef int n = 0</pre>
<pre id='line43' class='code' style='background-color: #FFFFff'>  __pyx_v_n = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line44")'> 44: </pre>
<pre id='line44' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line45")'> 45:     hashidx = idx * (idx + 3)   #hash function f(x) = x(x + 3)</pre>
<pre id='line45' class='code' style='background-color: #FFFFff'>  __pyx_v_hashidx = (__pyx_v_idx * (__pyx_v_idx + 3));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line46")'> 46: </pre>
<pre id='line46' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line47")'> 47:     hashidx = c_abs(hashidx % mem_max)</pre>
<pre id='line47' class='code' style='background-color: #FFFFaa'>  if (unlikely(__pyx_v_mem_max == 0)) {
    #ifdef WITH_THREAD
    PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
    #ifdef WITH_THREAD
    PyGILState_Release(__pyx_gilstate_save);
    #endif
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_hashidx = abs(__Pyx_mod_int(__pyx_v_hashidx, __pyx_v_mem_max));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line48")'> 48: </pre>
<pre id='line48' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line49")'> 49:     # Open addressing with linear probing</pre>
<pre id='line49' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line50")'> 50:     while key[hashidx] != idx and n &lt; mem_max:</pre>
<pre id='line50' class='code' style='background-color: #FFFFff'>  while (1) {
    __pyx_t_1 = __pyx_v_hashidx;
    __pyx_t_2 = (((*((int *) ( /* dim=0 */ (__pyx_v_key.data + __pyx_t_1 * __pyx_v_key.strides[0]) ))) != __pyx_v_idx) != 0);
    if (__pyx_t_2) {
      __pyx_t_3 = ((__pyx_v_n &lt; __pyx_v_mem_max) != 0);
      __pyx_t_4 = __pyx_t_3;
    } else {
      __pyx_t_4 = __pyx_t_2;
    }
    if (!__pyx_t_4) break;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line51")'> 51:         hashidx += 1</pre>
<pre id='line51' class='code' style='background-color: #FFFFff'>    __pyx_v_hashidx = (__pyx_v_hashidx + 1);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line52")'> 52:         hashidx = hashidx % mem_max</pre>
<pre id='line52' class='code' style='background-color: #FFFFaa'>    if (unlikely(__pyx_v_mem_max == 0)) {
      #ifdef WITH_THREAD
      PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
      #endif
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
      #ifdef WITH_THREAD
      PyGILState_Release(__pyx_gilstate_save);
      #endif
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 52; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_v_hashidx = __Pyx_mod_int(__pyx_v_hashidx, __pyx_v_mem_max);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line53")'> 53:         if key[hashidx] == 0:</pre>
<pre id='line53' class='code' style='background-color: #FFFFff'>    __pyx_t_5 = __pyx_v_hashidx;
    __pyx_t_4 = (((*((int *) ( /* dim=0 */ (__pyx_v_key.data + __pyx_t_5 * __pyx_v_key.strides[0]) ))) == 0) != 0);
    if (__pyx_t_4) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line54")'> 54:             key[hashidx] = idx</pre>
<pre id='line54' class='code' style='background-color: #FFFFff'>      __pyx_t_6 = __pyx_v_hashidx;
      *((int *) ( /* dim=0 */ (__pyx_v_key.data + __pyx_t_6 * __pyx_v_key.strides[0]) )) = __pyx_v_idx;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line55")'> 55:             break</pre>
<pre id='line55' class='code' style='background-color: #FFFFff'>      goto __pyx_L4_break;
    }
  }
  __pyx_L4_break:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line56")'> 56: </pre>
<pre id='line56' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line57")'> 57:     return hashidx</pre>
<pre id='line57' class='code' style='background-color: #FFFFff'>  __pyx_r = __pyx_v_hashidx;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line58")'> 58: </pre>
<pre id='line58' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line59")'> 59: cdef inline double linear_value(int i, double[:,:] XS, int D, double[:] Tinv, int[:] lin_T, double[:,:] lin_w, double[:,:] lin_c) nogil:</pre>
<pre id='line59' class='code' style='background-color: #FFFFff'>static CYTHON_INLINE double __pyx_f_9econlearn_8tilecode_linear_value(int __pyx_v_i, __Pyx_memviewslice __pyx_v_XS, int __pyx_v_D, __Pyx_memviewslice __pyx_v_Tinv, __Pyx_memviewslice __pyx_v_lin_T, __Pyx_memviewslice __pyx_v_lin_w, __Pyx_memviewslice __pyx_v_lin_c) {
  int __pyx_v_k;
  double __pyx_v_val;
  int __pyx_v_idx;
  double __pyx_v_x;
  double __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line60")'> 60: </pre>
<pre id='line60' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line61")'> 61:     cdef int k = 0</pre>
<pre id='line61' class='code' style='background-color: #FFFFff'>  __pyx_v_k = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line62")'> 62:     cdef double val = 0</pre>
<pre id='line62' class='code' style='background-color: #FFFFff'>  __pyx_v_val = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line63")'> 63:     cdef int idx = 0</pre>
<pre id='line63' class='code' style='background-color: #FFFFff'>  __pyx_v_idx = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line64")'> 64:     cdef double x = 0</pre>
<pre id='line64' class='code' style='background-color: #FFFFff'>  __pyx_v_x = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line65")'> 65: </pre>
<pre id='line65' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line66")'> 66:     for k in range(D):</pre>
<pre id='line66' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_D;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_k = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line67")'> 67:         x = XS[i, k] * Tinv[k]</pre>
<pre id='line67' class='code' style='background-color: #FFFFff'>    __pyx_t_3 = __pyx_v_i;
    __pyx_t_4 = __pyx_v_k;
    __pyx_t_5 = __pyx_v_k;
    __pyx_v_x = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_XS.data + __pyx_t_3 * __pyx_v_XS.strides[0]) ) + __pyx_t_4 * __pyx_v_XS.strides[1]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_Tinv.data + __pyx_t_5 * __pyx_v_Tinv.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line68")'> 68:         idx = c_int(c_min(c_max(x, 0.000001), 0.99999) * lin_T[k])</pre>
<pre id='line68' class='code' style='background-color: #FFFFff'>    __pyx_t_6 = __pyx_v_k;
    __pyx_v_idx = Real2Int((fmin(fmax(__pyx_v_x, 0.000001), 0.99999) * (*((int *) ( /* dim=0 */ (__pyx_v_lin_T.data + __pyx_t_6 * __pyx_v_lin_T.strides[0]) )))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line69")'> 69:         val += lin_w[k, idx] * x + lin_c[k, idx]</pre>
<pre id='line69' class='code' style='background-color: #FFFFff'>    __pyx_t_7 = __pyx_v_k;
    __pyx_t_8 = __pyx_v_idx;
    __pyx_t_9 = __pyx_v_k;
    __pyx_t_10 = __pyx_v_idx;
    __pyx_v_val = (__pyx_v_val + (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_lin_w.data + __pyx_t_7 * __pyx_v_lin_w.strides[0]) ) + __pyx_t_8 * __pyx_v_lin_w.strides[1]) ))) * __pyx_v_x) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_lin_c.data + __pyx_t_9 * __pyx_v_lin_c.strides[0]) ) + __pyx_t_10 * __pyx_v_lin_c.strides[1]) )))));
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line70")'> 70: </pre>
<pre id='line70' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line71")'> 71:     return val</pre>
<pre id='line71' class='code' style='background-color: #FFFFff'>  __pyx_r = __pyx_v_val;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line72")'> 72: </pre>
<pre id='line72' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line73")'> 73: cdef inline double predict(int D, int i, double[:,:]  XS, int extrap, double[:] Tinv, double[:,:] offset, int[:] flat, double Linv, double[:] w, int[:] count, int min_count, int linval, double[:,:] linw, double[:,:] linc, int[:] linT, int size, int L,  int dohash, int mem_max, int[:] key) nogil:</pre>
<pre id='line73' class='code' style='background-color: #FFFFff'>static CYTHON_INLINE double __pyx_f_9econlearn_8tilecode_predict(int __pyx_v_D, int __pyx_v_i, __Pyx_memviewslice __pyx_v_XS, int __pyx_v_extrap, __Pyx_memviewslice __pyx_v_Tinv, __Pyx_memviewslice __pyx_v_offset, __Pyx_memviewslice __pyx_v_flat, double __pyx_v_Linv, __Pyx_memviewslice __pyx_v_w, __Pyx_memviewslice __pyx_v_count, int __pyx_v_min_count, int __pyx_v_linval, __Pyx_memviewslice __pyx_v_linw, __Pyx_memviewslice __pyx_v_linc, __Pyx_memviewslice __pyx_v_linT, int __pyx_v_size, int __pyx_v_L, int __pyx_v_dohash, int __pyx_v_mem_max, __Pyx_memviewslice __pyx_v_key) {
  int __pyx_v_j;
  double __pyx_v_y;
  int __pyx_v_idx;
  CYTHON_UNUSED int __pyx_v_nosample;
  double __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line74")'> 74: </pre>
<pre id='line74' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line75")'> 75:     cdef int j, k</pre>
<pre id='line75' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line76")'> 76:     cdef double y = 0</pre>
<pre id='line76' class='code' style='background-color: #FFFFff'>  __pyx_v_y = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line77")'> 77:     cdef int idx = 0</pre>
<pre id='line77' class='code' style='background-color: #FFFFff'>  __pyx_v_idx = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line78")'> 78:     cdef int nosample = 0</pre>
<pre id='line78' class='code' style='background-color: #FFFFff'>  __pyx_v_nosample = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line79")'> 79: </pre>
<pre id='line79' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line80")'> 80:     if extrap == 0:</pre>
<pre id='line80' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = ((__pyx_v_extrap == 0) != 0);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line81")'> 81:         for j in range(L):</pre>
<pre id='line81' class='code' style='background-color: #FFFFff'>    __pyx_t_2 = __pyx_v_L;
    for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
      __pyx_v_j = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line82")'> 82: </pre>
<pre id='line82' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line83")'> 83:             idx = getindex(j, i, XS, D, offset, flat, size, dohash, mem_max, key)</pre>
<pre id='line83' class='code' style='background-color: #FFFFff'>      __pyx_v_idx = __pyx_f_9econlearn_8tilecode_getindex(__pyx_v_j, __pyx_v_i, __pyx_v_XS, __pyx_v_D, __pyx_v_offset, __pyx_v_flat, __pyx_v_size, __pyx_v_dohash, __pyx_v_mem_max, __pyx_v_key);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line84")'> 84: </pre>
<pre id='line84' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line85")'> 85:             if count[idx] &gt;= min_count:</pre>
<pre id='line85' class='code' style='background-color: #FFFFff'>      __pyx_t_4 = __pyx_v_idx;
      __pyx_t_1 = (((*((int *) ( /* dim=0 */ (__pyx_v_count.data + __pyx_t_4 * __pyx_v_count.strides[0]) ))) &gt;= __pyx_v_min_count) != 0);
      if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line86")'> 86:                 y += w[idx]</pre>
<pre id='line86' class='code' style='background-color: #FFFFff'>        __pyx_t_5 = __pyx_v_idx;
        __pyx_v_y = (__pyx_v_y + (*((double *) ( /* dim=0 */ (__pyx_v_w.data + __pyx_t_5 * __pyx_v_w.strides[0]) ))));
        goto __pyx_L6;
      }
      /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line87")'> 87:             else:</pre>
<pre id='line87' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line88")'> 88:                 if linval == 1:</pre>
<pre id='line88' class='code' style='background-color: #FFFFff'>        __pyx_t_1 = ((__pyx_v_linval == 1) != 0);
        if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line89")'> 89:                     y += linear_value(i, XS, D, Tinv, linT, linw, linc)</pre>
<pre id='line89' class='code' style='background-color: #FFFFff'>          __pyx_v_y = (__pyx_v_y + __pyx_f_9econlearn_8tilecode_linear_value(__pyx_v_i, __pyx_v_XS, __pyx_v_D, __pyx_v_Tinv, __pyx_v_linT, __pyx_v_linw, __pyx_v_linc));
          goto __pyx_L7;
        }
        /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line90")'> 90:                 else:</pre>
<pre id='line90' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line91")'> 91:                     y = 0</pre>
<pre id='line91' class='code' style='background-color: #FFFFff'>          __pyx_v_y = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line92")'> 92:                     break</pre>
<pre id='line92' class='code' style='background-color: #FFFFff'>          goto __pyx_L5_break;
        }
        __pyx_L7:;
      }
      __pyx_L6:;
    }
    __pyx_L5_break:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line93")'> 93:         y =  y * Linv</pre>
<pre id='line93' class='code' style='background-color: #FFFFff'>    __pyx_v_y = (__pyx_v_y * __pyx_v_Linv);
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line94")'> 94:     else:</pre>
<pre id='line94' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line95")'> 95:         if linval == 1:</pre>
<pre id='line95' class='code' style='background-color: #FFFFff'>    __pyx_t_1 = ((__pyx_v_linval == 1) != 0);
    if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line96")'> 96:             y = linear_value(i, XS, D, Tinv, linT, linw, linc)</pre>
<pre id='line96' class='code' style='background-color: #FFFFff'>      __pyx_v_y = __pyx_f_9econlearn_8tilecode_linear_value(__pyx_v_i, __pyx_v_XS, __pyx_v_D, __pyx_v_Tinv, __pyx_v_linT, __pyx_v_linw, __pyx_v_linc);
      goto __pyx_L8;
    }
    __pyx_L8:;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line97")'> 97: </pre>
<pre id='line97' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line98")'> 98:     return y</pre>
<pre id='line98' class='code' style='background-color: #FFFFff'>  __pyx_r = __pyx_v_y;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line99")'> 99: </pre>
<pre id='line99' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line100")'> 100: cdef inline double predict_fast(int D, int i, double[:,:]  XS, int extrap, double[:] Tinv, double Linv, double[:] w, int[:] count, int min_count, int linval, double[:,:] linw, double[:,:] linc, int[:] linT, int L, int[:,:] datastruct_reverse) nogil:</pre>
<pre id='line100' class='code' style='background-color: #FFFFff'>static CYTHON_INLINE double __pyx_f_9econlearn_8tilecode_predict_fast(int __pyx_v_D, int __pyx_v_i, __Pyx_memviewslice __pyx_v_XS, int __pyx_v_extrap, __Pyx_memviewslice __pyx_v_Tinv, double __pyx_v_Linv, __Pyx_memviewslice __pyx_v_w, __Pyx_memviewslice __pyx_v_count, int __pyx_v_min_count, int __pyx_v_linval, __Pyx_memviewslice __pyx_v_linw, __Pyx_memviewslice __pyx_v_linc, __Pyx_memviewslice __pyx_v_linT, int __pyx_v_L, __Pyx_memviewslice __pyx_v_datastruct_reverse) {
  int __pyx_v_j;
  double __pyx_v_y;
  int __pyx_v_idx;
  CYTHON_UNUSED int __pyx_v_nosample;
  double __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line101")'> 101: </pre>
<pre id='line101' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line102")'> 102:     cdef int j, k</pre>
<pre id='line102' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line103")'> 103:     cdef double y = 0</pre>
<pre id='line103' class='code' style='background-color: #FFFFff'>  __pyx_v_y = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line104")'> 104:     cdef int idx = 0</pre>
<pre id='line104' class='code' style='background-color: #FFFFff'>  __pyx_v_idx = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line105")'> 105:     cdef int nosample = 0</pre>
<pre id='line105' class='code' style='background-color: #FFFFff'>  __pyx_v_nosample = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line106")'> 106: </pre>
<pre id='line106' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line107")'> 107:     if extrap == 0:</pre>
<pre id='line107' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = ((__pyx_v_extrap == 0) != 0);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line108")'> 108:         for j in range(L):</pre>
<pre id='line108' class='code' style='background-color: #FFFFff'>    __pyx_t_2 = __pyx_v_L;
    for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
      __pyx_v_j = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line109")'> 109: </pre>
<pre id='line109' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line110")'> 110:             idx = datastruct_reverse[i, j]</pre>
<pre id='line110' class='code' style='background-color: #FFFFff'>      __pyx_t_4 = __pyx_v_i;
      __pyx_t_5 = __pyx_v_j;
      __pyx_v_idx = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_datastruct_reverse.data + __pyx_t_4 * __pyx_v_datastruct_reverse.strides[0]) ) + __pyx_t_5 * __pyx_v_datastruct_reverse.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line111")'> 111: </pre>
<pre id='line111' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line112")'> 112:             if count[idx] &gt;= min_count:</pre>
<pre id='line112' class='code' style='background-color: #FFFFff'>      __pyx_t_6 = __pyx_v_idx;
      __pyx_t_1 = (((*((int *) ( /* dim=0 */ (__pyx_v_count.data + __pyx_t_6 * __pyx_v_count.strides[0]) ))) &gt;= __pyx_v_min_count) != 0);
      if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line113")'> 113:                 y += w[idx]</pre>
<pre id='line113' class='code' style='background-color: #FFFFff'>        __pyx_t_7 = __pyx_v_idx;
        __pyx_v_y = (__pyx_v_y + (*((double *) ( /* dim=0 */ (__pyx_v_w.data + __pyx_t_7 * __pyx_v_w.strides[0]) ))));
        goto __pyx_L6;
      }
      /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line114")'> 114:             else:</pre>
<pre id='line114' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line115")'> 115:                 if linval == 1:</pre>
<pre id='line115' class='code' style='background-color: #FFFFff'>        __pyx_t_1 = ((__pyx_v_linval == 1) != 0);
        if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line116")'> 116:                     y += linear_value(i, XS, D, Tinv, linT, linw, linc)</pre>
<pre id='line116' class='code' style='background-color: #FFFFff'>          __pyx_v_y = (__pyx_v_y + __pyx_f_9econlearn_8tilecode_linear_value(__pyx_v_i, __pyx_v_XS, __pyx_v_D, __pyx_v_Tinv, __pyx_v_linT, __pyx_v_linw, __pyx_v_linc));
          goto __pyx_L7;
        }
        /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line117")'> 117:                 else:</pre>
<pre id='line117' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line118")'> 118:                     y = 0</pre>
<pre id='line118' class='code' style='background-color: #FFFFff'>          __pyx_v_y = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line119")'> 119:                     break</pre>
<pre id='line119' class='code' style='background-color: #FFFFff'>          goto __pyx_L5_break;
        }
        __pyx_L7:;
      }
      __pyx_L6:;
    }
    __pyx_L5_break:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line120")'> 120:         y =  y * Linv</pre>
<pre id='line120' class='code' style='background-color: #FFFFff'>    __pyx_v_y = (__pyx_v_y * __pyx_v_Linv);
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line121")'> 121:     else:</pre>
<pre id='line121' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line122")'> 122:         if linval == 1:</pre>
<pre id='line122' class='code' style='background-color: #FFFFff'>    __pyx_t_1 = ((__pyx_v_linval == 1) != 0);
    if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line123")'> 123:             y = linear_value(i, XS, D, Tinv, linT, linw, linc)</pre>
<pre id='line123' class='code' style='background-color: #FFFFff'>      __pyx_v_y = __pyx_f_9econlearn_8tilecode_linear_value(__pyx_v_i, __pyx_v_XS, __pyx_v_D, __pyx_v_Tinv, __pyx_v_linT, __pyx_v_linw, __pyx_v_linc);
      goto __pyx_L8;
    }
    __pyx_L8:;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line124")'> 124: </pre>
<pre id='line124' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line125")'> 125:     return y</pre>
<pre id='line125' class='code' style='background-color: #FFFFff'>  __pyx_r = __pyx_v_y;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line126")'> 126: </pre>
<pre id='line126' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line127")'> 127: cdef class Tilecode:</pre>
<pre id='line127' class='code' style='background-color: #FFFFff'>struct __pyx_vtabstruct_9econlearn_8tilecode_Tilecode {
  __Pyx_memviewslice (*scale_X)(struct __pyx_obj_9econlearn_8tilecode_Tilecode *, __Pyx_memviewslice, int, __Pyx_memviewslice);
  __Pyx_memviewslice (*check_extrap)(struct __pyx_obj_9econlearn_8tilecode_Tilecode *, __Pyx_memviewslice, int, __Pyx_memviewslice);
  void (*fit_tiles)(struct __pyx_obj_9econlearn_8tilecode_Tilecode *, __Pyx_memviewslice, __Pyx_memviewslice);
  void (*fit_sgd)(struct __pyx_obj_9econlearn_8tilecode_Tilecode *, __Pyx_memviewslice, __Pyx_memviewslice, double, double, int, int);
  void (*fit_linear)(struct __pyx_obj_9econlearn_8tilecode_Tilecode *, __Pyx_memviewslice, __Pyx_memviewslice);
  __Pyx_memviewslice (*matrix_values)(struct __pyx_obj_9econlearn_8tilecode_Tilecode *, __Pyx_memviewslice, int, int, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice);
  double (*one_value)(struct __pyx_obj_9econlearn_8tilecode_Tilecode *, __Pyx_memviewslice);
  __Pyx_memviewslice (*N_values)(struct __pyx_obj_9econlearn_8tilecode_Tilecode *, __Pyx_memviewslice, int, __Pyx_memviewslice, __Pyx_memviewslice);
  __Pyx_memviewslice (*N_values_policy)(struct __pyx_obj_9econlearn_8tilecode_Tilecode *, __Pyx_memviewslice, int, __Pyx_memviewslice);
  void (*fit_data)(struct __pyx_obj_9econlearn_8tilecode_Tilecode *, __Pyx_memviewslice, __Pyx_memviewslice);
  __Pyx_memviewslice (*local_quadratic)(struct __pyx_obj_9econlearn_8tilecode_Tilecode *, __Pyx_memviewslice, int);
  void (*fit_data_reverse)(struct __pyx_obj_9econlearn_8tilecode_Tilecode *, __Pyx_memviewslice, int, __Pyx_memviewslice);
  PyObject *(*partial_fit)(struct __pyx_obj_9econlearn_8tilecode_Tilecode *, __Pyx_memviewslice, int, int __pyx_skip_dispatch);
};
static struct __pyx_vtabstruct_9econlearn_8tilecode_Tilecode *__pyx_vtabptr_9econlearn_8tilecode_Tilecode;

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line128")'> 128: </pre>
<pre id='line128' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line129")'> 129:     """</pre>
<pre id='line129' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line130")'> 130:     Tile coding for function approximation (Supervised Learning).</pre>
<pre id='line130' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line131")'> 131:     Fits by averaging and/or Stochastic Gradient Descent.</pre>
<pre id='line131' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line132")'> 132:     Supports multi-core fit and predict. Options for uniform, random or 'optimal' displacement vectors.</pre>
<pre id='line132' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line133")'> 133:     Provides option for linear spline extrapolation / filling (suitable for small data sets)</pre>
<pre id='line133' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line134")'> 134:     Optimises over first dimension (by grid search) subject to supplied constraints.</pre>
<pre id='line134' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line135")'> 135: </pre>
<pre id='line135' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line136")'> 136:     Parameters</pre>
<pre id='line136' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line137")'> 137:     -----------</pre>
<pre id='line137' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line138")'> 138: </pre>
<pre id='line138' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line139")'> 139:     D : integer</pre>
<pre id='line139' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line140")'> 140:         Total number of dimensions (e.g., action + state dimensions)</pre>
<pre id='line140' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line141")'> 141: </pre>
<pre id='line141' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line142")'> 142:     T : list of integers, length D</pre>
<pre id='line142' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line143")'> 143:         Number of tiles per dimension</pre>
<pre id='line143' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line144")'> 144: </pre>
<pre id='line144' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line145")'> 145:     L : integer</pre>
<pre id='line145' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line146")'> 146:         Number of tiling 'layers'</pre>
<pre id='line146' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line147")'> 147: </pre>
<pre id='line147' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line148")'> 148:     mem_max : double, (default=1)</pre>
<pre id='line148' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line149")'> 149:         Proportion of total tiles to store in memory: less than 1 means hashing is used.</pre>
<pre id='line149' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line150")'> 150: </pre>
<pre id='line150' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line151")'> 151:     min_sample : integer, (default=50)</pre>
<pre id='line151' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line152")'> 152:         Minimum number of observations per tile</pre>
<pre id='line152' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line153")'> 153: </pre>
<pre id='line153' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line154")'> 154:     offset : string, (default='uniform')</pre>
<pre id='line154' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line155")'> 155:         Type of displacement vector one of 'uniform', 'random' or 'optimal'</pre>
<pre id='line155' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line156")'> 156: </pre>
<pre id='line156' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line157")'> 157:     lin_spline : boolean, (default=False)</pre>
<pre id='line157' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line158")'> 158:         Use sparse linear spline model to extrapolate / fill empty tiles</pre>
<pre id='line158' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line159")'> 159: </pre>
<pre id='line159' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line160")'> 160:     linT : integer, (default=6)</pre>
<pre id='line160' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line161")'> 161:         Number of linear spline knots per dimension</pre>
<pre id='line161' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line162")'> 162: </pre>
<pre id='line162' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line163")'> 163:     Attributes</pre>
<pre id='line163' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line164")'> 164:     -----------</pre>
<pre id='line164' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line165")'> 165: </pre>
<pre id='line165' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line166")'> 166:     N : integer</pre>
<pre id='line166' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line167")'> 167:         Number of samples</pre>
<pre id='line167' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line168")'> 168: </pre>
<pre id='line168' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line169")'> 169:     X : array, shape=(N, D)</pre>
<pre id='line169' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line170")'> 170:         Input data (unscaled) (e.g., state-action samples, with action as first dimension X[:,0])</pre>
<pre id='line170' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line171")'> 171: </pre>
<pre id='line171' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line172")'> 172:     Y : array, shape=(N)</pre>
<pre id='line172' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line173")'> 173:         Output data (unscaled), (e.g., Q samples)</pre>
<pre id='line173' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line174")'> 174: </pre>
<pre id='line174' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line175")'> 175:     a : array, shape=(D)</pre>
<pre id='line175' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line176")'> 176:         Minimum of tiling range in each dimension (observations outside of range are ignored)</pre>
<pre id='line176' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line177")'> 177: </pre>
<pre id='line177' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line178")'> 178:     b : array, shape=(D)</pre>
<pre id='line178' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line179")'> 179:         Maximum of tiling range in each dimension (observations outside of range are ignored)</pre>
<pre id='line179' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line180")'> 180: </pre>
<pre id='line180' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line181")'> 181:     R2 : array, shape=(D)</pre>
<pre id='line181' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line182")'> 182:         Score (r-squared)</pre>
<pre id='line182' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line183")'> 183: </pre>
<pre id='line183' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line184")'> 184:     """</pre>
<pre id='line184' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line185")'> 185: </pre>
<pre id='line185' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF19' onclick='toggleDiv("line186")'> 186:     def __init__(self, D, T, L, mem_max = 1, min_sample=1, offset='optimal', lin_spline=False, linT=7, cores=4):</pre>
<pre id='line186' class='code' style='background-color: #FFFF19'>/* Python wrapper */
static int __pyx_pw_9econlearn_8tilecode_8Tilecode_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_9econlearn_8tilecode_8Tilecode_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_D = 0;
  PyObject *__pyx_v_T = 0;
  PyObject *__pyx_v_L = 0;
  PyObject *__pyx_v_mem_max = 0;
  PyObject *__pyx_v_min_sample = 0;
  PyObject *__pyx_v_offset = 0;
  PyObject *__pyx_v_lin_spline = 0;
  PyObject *__pyx_v_linT = 0;
  PyObject *__pyx_v_cores = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_D,&amp;__pyx_n_s_T,&amp;__pyx_n_s_L,&amp;__pyx_n_s_mem_max,&amp;__pyx_n_s_min_sample,&amp;__pyx_n_s_offset,&amp;__pyx_n_s_lin_spline,&amp;__pyx_n_s_linT,&amp;__pyx_n_s_cores,0};
    PyObject* values[9] = {0,0,0,0,0,0,0,0,0};
    values[3] = ((PyObject *)__pyx_int_1);
    values[4] = ((PyObject *)__pyx_int_1);
    values[5] = ((PyObject *)__pyx_n_s_optimal);
    values[6] = ((PyObject *)Py_False);
    values[7] = ((PyObject *)__pyx_int_7);
    values[8] = ((PyObject *)__pyx_int_4);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_D)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_T)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 3, 9, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_L)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 3, 9, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_mem_max);
          if (value) { values[3] = value; kw_args--; }
        }
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_min_sample);
          if (value) { values[4] = value; kw_args--; }
        }
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_offset);
          if (value) { values[5] = value; kw_args--; }
        }
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_lin_spline);
          if (value) { values[6] = value; kw_args--; }
        }
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_linT);
          if (value) { values[7] = value; kw_args--; }
        }
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_cores);
          if (value) { values[8] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_D = values[0];
    __pyx_v_T = values[1];
    __pyx_v_L = values[2];
    __pyx_v_mem_max = values[3];
    __pyx_v_min_sample = values[4];
    __pyx_v_offset = values[5];
    __pyx_v_lin_spline = values[6];
    __pyx_v_linT = values[7];
    __pyx_v_cores = values[8];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 3, 9, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Tilecode.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9econlearn_8tilecode_8Tilecode___init__(((struct __pyx_obj_9econlearn_8tilecode_Tilecode *)__pyx_v_self), __pyx_v_D, __pyx_v_T, __pyx_v_L, __pyx_v_mem_max, __pyx_v_min_sample, __pyx_v_offset, __pyx_v_lin_spline, __pyx_v_linT, __pyx_v_cores);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9econlearn_8tilecode_8Tilecode___init__(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, PyObject *__pyx_v_D, PyObject *__pyx_v_T, PyObject *__pyx_v_L, PyObject *__pyx_v_mem_max, PyObject *__pyx_v_min_sample, PyObject *__pyx_v_offset, PyObject *__pyx_v_lin_spline, PyObject *__pyx_v_linT, PyObject *__pyx_v_cores) {
  PyObject *__pyx_v_width = NULL;
  int __pyx_v_k;
  int __pyx_v_j;
  PyObject *__pyx_v_temp = NULL;
  PyObject *__pyx_v_off = NULL;
  PyObject *__pyx_v_d = NULL;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_34, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_35, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_36, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_37, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_38, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_39, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_40, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Tilecode.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_width);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_temp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_off);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_d);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line187")'> 187: </pre>
<pre id='line187' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line188")'> 188:         self.D = D</pre>
<pre id='line188' class='code' style='background-color: #FFFFd4'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_D);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 188; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self-&gt;D = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line189")'> 189:         self.L = L</pre>
<pre id='line189' class='code' style='background-color: #FFFFd4'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_L);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self-&gt;L = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line190")'> 190:         self.Linv = 1.0 / L</pre>
<pre id='line190' class='code' style='background-color: #FFFF8d'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_float_1_0, __pyx_v_L);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 190; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_self-&gt;Linv = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line191")'> 191:         self.min_sample = min_sample</pre>
<pre id='line191' class='code' style='background-color: #FFFFd4'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_min_sample);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self-&gt;min_sample = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line192")'> 192:         self.T = np.array(T, dtype='int32')</pre>
<pre id='line192' class='code' style='background-color: #FFFF3f'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_T);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_T);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_T);
  __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_6);
  if (unlikely(!__pyx_t_7.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 192; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;T, 0);
  __pyx_v_self-&gt;T = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line193")'> 193:         self.Tinv = np.zeros(D)</pre>
<pre id='line193' class='code' style='background-color: #FFFF57'>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_D);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_D);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_D);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_2);
  if (unlikely(!__pyx_t_8.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 193; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;Tinv, 0);
  __pyx_v_self-&gt;Tinv = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class='line' style='background-color: #FFFF36' onclick='toggleDiv("line194")'> 194:         self.flat = np.ones([self.D], dtype='int32')</pre>
<pre id='line194' class='code' style='background-color: #FFFF36'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_2, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_9.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;flat, 0);
  __pyx_v_self-&gt;flat = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line195")'> 195:         self.SIZE = 1</pre>
<pre id='line195' class='code' style='background-color: #FFFFff'>  __pyx_v_self-&gt;SIZE = 1;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line196")'> 196:         width = np.zeros(self.D)</pre>
<pre id='line196' class='code' style='background-color: #FFFF5e'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_width = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line197")'> 197:         self.offset = np.zeros([self.L, self.D])</pre>
<pre id='line197' class='code' style='background-color: #FFFF41'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;L);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_6);
  if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 197; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;offset, 0);
  __pyx_v_self-&gt;offset = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line198")'> 198:         self.CORES = cores</pre>
<pre id='line198' class='code' style='background-color: #FFFFd4'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_cores);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self-&gt;CORES = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line199")'> 199: </pre>
<pre id='line199' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line200")'> 200:         # Calculate tile widths and total number of tiles</pre>
<pre id='line200' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line201")'> 201:         cdef int k, j</pre>
<pre id='line201' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line202")'> 202:         for k in range(self.D):</pre>
<pre id='line202' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_self-&gt;D;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_1; __pyx_t_11+=1) {
    __pyx_v_k = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line203")'> 203:             self.Tinv[k] = 1.0 / self.T[k]</pre>
<pre id='line203' class='code' style='background-color: #FFFFaa'>    __pyx_t_12 = __pyx_v_k;
    __pyx_t_13 = (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;T.data + __pyx_t_12 * __pyx_v_self-&gt;T.strides[0]) )));
    if (unlikely(__pyx_t_13 == 0)) {
      #ifdef WITH_THREAD
      PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
      #endif
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      #ifdef WITH_THREAD
      PyGILState_Release(__pyx_gilstate_save);
      #endif
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_14 = __pyx_v_k;
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;Tinv.data + __pyx_t_14 * __pyx_v_self-&gt;Tinv.strides[0]) )) = (1.0 / ((double)__pyx_t_13));
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line204")'> 204:             width[k] = 1.0 / self.T[k]</pre>
<pre id='line204' class='code' style='background-color: #FFFF6e'>    __pyx_t_13 = __pyx_v_k;
    __pyx_t_15 = (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;T.data + __pyx_t_13 * __pyx_v_self-&gt;T.strides[0]) )));
    if (unlikely(__pyx_t_15 == 0)) {
      #ifdef WITH_THREAD
      PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
      #endif
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      #ifdef WITH_THREAD
      PyGILState_Release(__pyx_gilstate_save);
      #endif
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((1.0 / ((double)__pyx_t_15)));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_width, __pyx_v_k, __pyx_t_6, int, 1, __Pyx_PyInt_From_int, 0, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line205")'> 205:             self.SIZE *= (self.T[k] + 1)</pre>
<pre id='line205' class='code' style='background-color: #FFFFff'>    __pyx_t_15 = __pyx_v_k;
    __pyx_v_self-&gt;SIZE = (__pyx_v_self-&gt;SIZE * ((*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;T.data + __pyx_t_15 * __pyx_v_self-&gt;T.strides[0]) ))) + 1));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line206")'> 206:             for j in range(k + 1, self.D):</pre>
<pre id='line206' class='code' style='background-color: #FFFFff'>    __pyx_t_16 = __pyx_v_self-&gt;D;
    for (__pyx_t_17 = (__pyx_v_k + 1); __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
      __pyx_v_j = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line207")'> 207:                 self.flat[k] *= (self.T[j] + 1)</pre>
<pre id='line207' class='code' style='background-color: #FFFFff'>      __pyx_t_18 = __pyx_v_j;
      __pyx_t_19 = __pyx_v_k;
      *((int *) ( /* dim=0 */ (__pyx_v_self-&gt;flat.data + __pyx_t_19 * __pyx_v_self-&gt;flat.strides[0]) )) *= ((*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;T.data + __pyx_t_18 * __pyx_v_self-&gt;T.strides[0]) ))) + 1);
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line208")'> 208: </pre>
<pre id='line208' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line209")'> 209:         # Build displacement (offset) vectors</pre>
<pre id='line209' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line210")'> 210:         if offset == 'uniform':</pre>
<pre id='line210' class='code' style='background-color: #FFFFd4'>  __pyx_t_20 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_offset, __pyx_n_s_uniform, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_20 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (__pyx_t_20) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line211")'> 211:             for k in range(self.D):</pre>
<pre id='line211' class='code' style='background-color: #FFFFff'>    __pyx_t_1 = __pyx_v_self-&gt;D;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_1; __pyx_t_11+=1) {
      __pyx_v_k = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line212")'> 212:                 for j in range(self.L):</pre>
<pre id='line212' class='code' style='background-color: #FFFFff'>      __pyx_t_16 = __pyx_v_self-&gt;L;
      for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
        __pyx_v_j = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFF32' onclick='toggleDiv("line213")'> 213:                     self.offset[j, k] = (width[k] - (j + 1) * (width[k] / self.L) ) * self.T[k]</pre>
<pre id='line213' class='code' style='background-color: #FFFF32'>        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_width, __pyx_v_k, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_6 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_j + 1));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_width, __pyx_v_k, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;L);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
        __pyx_t_21 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_6, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_22 = __pyx_v_k;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;T.data + __pyx_t_22 * __pyx_v_self-&gt;T.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_21, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_6);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_23 = __pyx_v_j;
        __pyx_t_24 = __pyx_v_k;
        *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;offset.data + __pyx_t_23 * __pyx_v_self-&gt;offset.strides[0]) ) + __pyx_t_24 * __pyx_v_self-&gt;offset.strides[1]) )) = __pyx_t_3;
      }
    }
    goto __pyx_L7;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line214")'> 214: </pre>
<pre id='line214' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line215")'> 215:         elif offset == 'random':</pre>
<pre id='line215' class='code' style='background-color: #FFFFd4'>  __pyx_t_20 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_offset, __pyx_n_s_random, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_20 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 215; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (__pyx_t_20) {
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line216")'> 216:             temp = range(self.L)</pre>
<pre id='line216' class='code' style='background-color: #FFFF79'>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;L);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_range, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_temp = __pyx_t_6;
    __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line217")'> 217:             for k in range(self.D):</pre>
<pre id='line217' class='code' style='background-color: #FFFFff'>    __pyx_t_1 = __pyx_v_self-&gt;D;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_1; __pyx_t_11+=1) {
      __pyx_v_k = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line218")'> 218:                 np.random.shuffle(temp)</pre>
<pre id='line218' class='code' style='background-color: #FFFF55'>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_shuffle);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_temp);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_temp);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_temp);
      __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 218; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
</pre><pre class='line' style='background-color: #FFFF2d' onclick='toggleDiv("line219")'> 219:                 off = 1.0 * np.array(temp) / self.L + (1/self.L)</pre>
<pre id='line219' class='code' style='background-color: #FFFF2d'>      __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_21, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      __pyx_t_21 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_temp);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0, __pyx_v_temp);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_temp);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_21, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      __pyx_t_21 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_1_0, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;L);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_21, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(__pyx_v_self-&gt;L == 0)) {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        #ifdef WITH_THREAD
        PyGILState_Release(__pyx_gilstate_save);
        #endif
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((1.0 / ((double)__pyx_v_self-&gt;L)));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_21 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 219; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_off, __pyx_t_21);
      __pyx_t_21 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line220")'> 220:                 for j in range(self.L):</pre>
<pre id='line220' class='code' style='background-color: #FFFFff'>      __pyx_t_16 = __pyx_v_self-&gt;L;
      for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
        __pyx_v_j = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFF38' onclick='toggleDiv("line221")'> 221:                     self.offset[j, k] = (width[k] - off[j] * width[k] ) * self.T[k]</pre>
<pre id='line221' class='code' style='background-color: #FFFF38'>        __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_width, __pyx_v_k, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_21 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_off, __pyx_v_j, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_6 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_width, __pyx_v_k, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_21, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_25 = __pyx_v_k;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;T.data + __pyx_t_25 * __pyx_v_self-&gt;T.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_21 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_21);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 221; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
        __pyx_t_26 = __pyx_v_j;
        __pyx_t_27 = __pyx_v_k;
        *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;offset.data + __pyx_t_26 * __pyx_v_self-&gt;offset.strides[0]) ) + __pyx_t_27 * __pyx_v_self-&gt;offset.strides[1]) )) = __pyx_t_3;
      }
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line222")'> 222:             for k in range(self.D):</pre>
<pre id='line222' class='code' style='background-color: #FFFFff'>    __pyx_t_1 = __pyx_v_self-&gt;D;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_1; __pyx_t_11+=1) {
      __pyx_v_k = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFF3c' onclick='toggleDiv("line223")'> 223:                 self.offset[0, k] = (width[k] - 0.5 * width[k] ) * self.T[k]</pre>
<pre id='line223' class='code' style='background-color: #FFFF3c'>      __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_width, __pyx_v_k, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_21 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_width, __pyx_v_k, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_21, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_16 = __pyx_v_k;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;T.data + __pyx_t_16 * __pyx_v_self-&gt;T.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_21 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_21);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      __pyx_t_28 = 0;
      __pyx_t_17 = __pyx_v_k;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;offset.data + __pyx_t_28 * __pyx_v_self-&gt;offset.strides[0]) ) + __pyx_t_17 * __pyx_v_self-&gt;offset.strides[1]) )) = __pyx_t_3;
    }
    goto __pyx_L7;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line224")'> 224: </pre>
<pre id='line224' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line225")'> 225:         elif offset == 'optimal':</pre>
<pre id='line225' class='code' style='background-color: #FFFFd4'>  __pyx_t_20 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_offset, __pyx_n_s_optimal, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_20 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 225; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (__pyx_t_20) {
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line226")'> 226:             d = np.array(Displace().table[self.D][self.L])</pre>
<pre id='line226' class='code' style='background-color: #FFFF41'>    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_21, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_Displace);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_21, __pyx_empty_tuple, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_table);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_21, __pyx_v_self-&gt;D, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, __pyx_v_self-&gt;L, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_21 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_21);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
    __pyx_t_21 = 0;
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_d = __pyx_t_21;
    __pyx_t_21 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line227")'> 227:             for j in range(self.L):</pre>
<pre id='line227' class='code' style='background-color: #FFFFff'>    __pyx_t_1 = __pyx_v_self-&gt;L;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_1; __pyx_t_11+=1) {
      __pyx_v_j = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line228")'> 228:                 for k in range(self.D):</pre>
<pre id='line228' class='code' style='background-color: #FFFFff'>      __pyx_t_29 = __pyx_v_self-&gt;D;
      for (__pyx_t_30 = 0; __pyx_t_30 &lt; __pyx_t_29; __pyx_t_30+=1) {
        __pyx_v_k = __pyx_t_30;
</pre><pre class='line' style='background-color: #FFFF22' onclick='toggleDiv("line229")'> 229:                     self.offset[j, k] = (width[k] - (width[k] / self.L) * (1 + (((j + 1) * d[k]) % self.L ) ) ) * self.T[k]</pre>
<pre id='line229' class='code' style='background-color: #FFFF22'>        __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_width, __pyx_v_k, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_21 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_width, __pyx_v_k, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;L);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_j + 1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_d, __pyx_v_k, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_5 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;L);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_4 = <span class='py_c_api'>PyNumber_Remainder</span>(__pyx_t_2, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_int_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_21, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_31 = __pyx_v_k;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;T.data + __pyx_t_31 * __pyx_v_self-&gt;T.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_21 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_21);<span class='error_goto'> if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
        __pyx_t_32 = __pyx_v_j;
        __pyx_t_33 = __pyx_v_k;
        *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;offset.data + __pyx_t_32 * __pyx_v_self-&gt;offset.strides[0]) ) + __pyx_t_33 * __pyx_v_self-&gt;offset.strides[1]) )) = __pyx_t_3;
      }
    }
    goto __pyx_L7;
  }
  __pyx_L7:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line230")'> 230: </pre>
<pre id='line230' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line231")'> 231:         if mem_max == 1:</pre>
<pre id='line231' class='code' style='background-color: #FFFF8d'>  __pyx_t_21 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_mem_max, __pyx_int_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_21);<span class='error_goto'> if (unlikely(__pyx_t_20 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  if (__pyx_t_20) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line232")'> 232:             self.dohash = 0</pre>
<pre id='line232' class='code' style='background-color: #FFFFff'>    __pyx_v_self-&gt;dohash = 0;
    goto __pyx_L22;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line233")'> 233:         else:</pre>
<pre id='line233' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line234")'> 234:             self.dohash = 1</pre>
<pre id='line234' class='code' style='background-color: #FFFFff'>    __pyx_v_self-&gt;dohash = 1;
  }
  __pyx_L22:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line235")'> 235: </pre>
<pre id='line235' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line236")'> 236:         self.mem_max = int(self.L * self.SIZE * mem_max)</pre>
<pre id='line236' class='code' style='background-color: #FFFF5e'>  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((__pyx_v_self-&gt;L * __pyx_v_self-&gt;SIZE));<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_21, __pyx_v_mem_max);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  __pyx_t_21 = <span class='py_c_api'>PyNumber_Int</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_21);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  __pyx_v_self-&gt;mem_max = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line237")'> 237: </pre>
<pre id='line237' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line238")'> 238:         self.w = np.zeros(self.mem_max)</pre>
<pre id='line238' class='code' style='background-color: #FFFF55'>  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_21, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;mem_max);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_21);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
  __pyx_t_21 = 0;
  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_34 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_21);
  if (unlikely(!__pyx_t_34.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;w, 0);
  __pyx_v_self-&gt;w = __pyx_t_34;
  __pyx_t_34.memview = NULL;
  __pyx_t_34.data = NULL;
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line239")'> 239:         self.count = np.zeros(self.mem_max, dtype='int32')</pre>
<pre id='line239' class='code' style='background-color: #FFFF3e'>  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_21, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;mem_max);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_21);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
  __pyx_t_21 = 0;
  __pyx_t_21 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_21, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  __pyx_t_35 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_6);
  if (unlikely(!__pyx_t_35.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;count, 0);
  __pyx_v_self-&gt;count = __pyx_t_35;
  __pyx_t_35.memview = NULL;
  __pyx_t_35.data = NULL;
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line240")'> 240:         self.key = np.zeros(self.mem_max, dtype='int32')</pre>
<pre id='line240' class='code' style='background-color: #FFFF3e'>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;mem_max);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_21, __pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_36 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_5);
  if (unlikely(!__pyx_t_36.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;key, 0);
  __pyx_v_self-&gt;key = __pyx_t_36;
  __pyx_t_36.memview = NULL;
  __pyx_t_36.data = NULL;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line241")'> 241:         self.xs = np.zeros([1, self.D])</pre>
<pre id='line241' class='code' style='background-color: #FFFF43'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_37 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_37.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;xs, 0);
  __pyx_v_self-&gt;xs = __pyx_t_37;
  __pyx_t_37.memview = NULL;
  __pyx_t_37.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line242")'> 242: </pre>
<pre id='line242' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line243")'> 243:         # Linear Spline (for extrapolation)</pre>
<pre id='line243' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line244")'> 244:         self.lin_spline = 0</pre>
<pre id='line244' class='code' style='background-color: #FFFFff'>  __pyx_v_self-&gt;lin_spline = 0;
</pre><pre class='line' style='background-color: #FFFF36' onclick='toggleDiv("line245")'> 245:         self.lin_T = np.ones(self.D, dtype='int32') * linT</pre>
<pre id='line245' class='code' style='background-color: #FFFF36'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_21, __pyx_v_linT);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_7.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 245; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;lin_T, 0);
  __pyx_v_self-&gt;lin_T = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line246")'> 246:         self.lin_width = np.zeros(self.D)</pre>
<pre id='line246' class='code' style='background-color: #FFFF55'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_21, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_38 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_38.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;lin_width, 0);
  __pyx_v_self-&gt;lin_width = __pyx_t_38;
  __pyx_t_38.memview = NULL;
  __pyx_t_38.data = NULL;
</pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line247")'> 247:         self.lin_SIZE = self.D * linT</pre>
<pre id='line247' class='code' style='background-color: #FFFF79'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_v_linT);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_6);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_self-&gt;lin_SIZE = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line248")'> 248:         self.lin_w = np.zeros([self.D, linT])</pre>
<pre id='line248' class='code' style='background-color: #FFFF43'>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_21 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_21, 0, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_linT);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_21, 1, __pyx_v_linT);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_linT);
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_21);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
  __pyx_t_21 = 0;
  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_39 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_21);
  if (unlikely(!__pyx_t_39.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;lin_w, 0);
  __pyx_v_self-&gt;lin_w = __pyx_t_39;
  __pyx_t_39.memview = NULL;
  __pyx_t_39.data = NULL;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line249")'> 249:         self.lin_c = np.zeros([self.D, linT])</pre>
<pre id='line249' class='code' style='background-color: #FFFF43'>  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_21, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_21);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_linT);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_v_linT);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_linT);
  __pyx_t_21 = 0;
  __pyx_t_21 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_21, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
  __pyx_t_40 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_40.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;lin_c, 0);
  __pyx_v_self-&gt;lin_c = __pyx_t_40;
  __pyx_t_40.memview = NULL;
  __pyx_t_40.data = NULL;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line250")'> 250:         if lin_spline:</pre>
<pre id='line250' class='code' style='background-color: #FFFFd4'>  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_lin_spline);<span class='error_goto'> if (unlikely(__pyx_t_20 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 250; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (__pyx_t_20) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line251")'> 251:             self.lin_spline = 1</pre>
<pre id='line251' class='code' style='background-color: #FFFFff'>    __pyx_v_self-&gt;lin_spline = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line252")'> 252:             for k in range(self.D):</pre>
<pre id='line252' class='code' style='background-color: #FFFFff'>    __pyx_t_1 = __pyx_v_self-&gt;D;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_1; __pyx_t_11+=1) {
      __pyx_v_k = __pyx_t_11;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line253")'> 253:                 self.lin_width[k] = 1.0 / self.lin_T[k]</pre>
<pre id='line253' class='code' style='background-color: #FFFFaa'>      __pyx_t_29 = __pyx_v_k;
      __pyx_t_30 = (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;lin_T.data + __pyx_t_29 * __pyx_v_self-&gt;lin_T.strides[0]) )));
      if (unlikely(__pyx_t_30 == 0)) {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        #ifdef WITH_THREAD
        PyGILState_Release(__pyx_gilstate_save);
        #endif
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_41 = __pyx_v_k;
      *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;lin_width.data + __pyx_t_41 * __pyx_v_self-&gt;lin_width.strides[0]) )) = (1.0 / ((double)__pyx_t_30));
    }
    goto __pyx_L23;
  }
  __pyx_L23:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line254")'> 254: </pre>
<pre id='line254' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF2d' onclick='toggleDiv("line255")'> 255:     def score(self, X, Y):</pre>
<pre id='line255' class='code' style='background-color: #FFFF2d'>/* Python wrapper */
static PyObject *__pyx_pw_9econlearn_8tilecode_8Tilecode_3score(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_9econlearn_8tilecode_8Tilecode_3score(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_Y = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("score (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_X,&amp;__pyx_n_s_Y,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_X)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Y)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("score", 1, 2, 2, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "score") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_X = values[0];
    __pyx_v_Y = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("score", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Tilecode.score", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9econlearn_8tilecode_8Tilecode_2score(((struct __pyx_obj_9econlearn_8tilecode_Tilecode *)__pyx_v_self), __pyx_v_X, __pyx_v_Y);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9econlearn_8tilecode_8Tilecode_2score(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, PyObject *__pyx_v_X, PyObject *__pyx_v_Y) {
  PyObject *__pyx_v_Y_hat = NULL;
  PyObject *__pyx_v_index = NULL;
  PyObject *__pyx_v_SS_tot = NULL;
  PyObject *__pyx_v_SS_res = NULL;
  PyObject *__pyx_v_R2 = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("score", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Y);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Tilecode.score", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Y_hat);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_index);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_SS_tot);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_SS_res);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_R2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Y);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line256")'> 256: </pre>
<pre id='line256' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line257")'> 257:         X = np.array(X)</pre>
<pre id='line257' class='code' style='background-color: #FFFF5e'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_X);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_X);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_X, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line258")'> 258:         Y = np.array(Y)</pre>
<pre id='line258' class='code' style='background-color: #FFFF5e'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Y);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_Y);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Y);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_Y, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line259")'> 259:         Y_hat = self.predict(X)</pre>
<pre id='line259' class='code' style='background-color: #FFFF6e'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_predict);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_X);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_X);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_Y_hat = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line260")'> 260:         index = Y_hat != 0</pre>
<pre id='line260' class='code' style='background-color: #FFFFaa'>  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_Y_hat, __pyx_int_0, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_index = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line261")'> 261: </pre>
<pre id='line261' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF28' onclick='toggleDiv("line262")'> 262:         SS_tot = np.sum((Y[index] - np.mean(Y[index]))**2)</pre>
<pre id='line262' class='code' style='background-color: #FFFF28'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_Y, __pyx_v_index);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_Y, __pyx_v_index);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_t_5, __pyx_int_2, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_SS_tot = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line263")'> 263:         SS_res = np.sum((Y[index] - Y_hat[index])**2)</pre>
<pre id='line263' class='code' style='background-color: #FFFF35'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_Y, __pyx_v_index);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_Y_hat, __pyx_v_index);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_t_1, __pyx_int_2, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 263; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_SS_res = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line264")'> 264: </pre>
<pre id='line264' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line265")'> 265:         R2 = 1 -  SS_res / SS_tot</pre>
<pre id='line265' class='code' style='background-color: #FFFF8d'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_SS_res, __pyx_v_SS_tot);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_int_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_R2 = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line266")'> 266: </pre>
<pre id='line266' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line267")'> 267:         return R2</pre>
<pre id='line267' class='code' style='background-color: #FFFFd4'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_R2);
  __pyx_r = __pyx_v_R2;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line268")'> 268: </pre>
<pre id='line268' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line269")'> 269:     def fit(self, double[:,:] X, double[:] Y, policy=0, pa=-1, pb=-1, unsupervised=False, score=False, copy=True, a=0, b=0,</pre>
<pre id='line269' class='code' style='background-color: #FFFF62'>/* Python wrapper */
static PyObject *__pyx_pw_9econlearn_8tilecode_8Tilecode_5fit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_9econlearn_8tilecode_8Tilecode_4fit[] = "    \n        Fit tilecode function by averaging (then by SGD if sgd=True)\n\n        Parameters\n        -----------\n        X : array, shape=(N, D) \n            Input data (unscaled), policy variable is first dimension X[:,0]\n\n        Y : array, shape=(N) \n            Output data (unscaled), (e.g., Q samples)\n\n        score : boolean, (default=False)\n            Calculate R-squared\n\n        cores : integer, (default=1)\n            Number of CPU cores / jobs to use for fitting\n\n        copy : boolean (default=False)\n            Store X and Y\n\n        setrange : boolean (default=False)\n            Restrict tiling to a percentile range (if False then use min-max of data)\n\n        a : array, optional shape=(D) \n            Percentile to use for minimum tiling range\n        \n        b : array, optional, shape=(D) \n            Percentile to use for maximum tiling range\n\n        pc_samp : float, (default=0.05\n            Proportion of sample to use when calculating percentile ranges (only needed when setrange = True)\n\n        R2 : array, shape=(D)\n            Score (r-squared)\n        \n        sgd : boolean (default=False)\n            Fit by Stochastic Gradient Descent (SGD) (using averaging for starting values)\n\n        eta : float (default=.01)\n            SGD Learning rate\n\n        n_iters : int (default=1)\n            Number of passes over the data set in SGD\n\n        scale : float (default=0)\n            Learning rate scaling factor in SGD\n        ";
static PyObject *__pyx_pw_9econlearn_8tilecode_8Tilecode_5fit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_X = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_Y = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_policy = 0;
  PyObject *__pyx_v_pa = 0;
  PyObject *__pyx_v_pb = 0;
  PyObject *__pyx_v_unsupervised = 0;
  PyObject *__pyx_v_score = 0;
  PyObject *__pyx_v_copy = 0;
  PyObject *__pyx_v_a = 0;
  PyObject *__pyx_v_b = 0;
  PyObject *__pyx_v_pc_samp = 0;
  PyObject *__pyx_v_sgd = 0;
  PyObject *__pyx_v_eta = 0;
  PyObject *__pyx_v_n_iters = 0;
  PyObject *__pyx_v_scale = 0;
  PyObject *__pyx_v_asgd = 0;
  PyObject *__pyx_v_storeindex = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fit (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_X,&amp;__pyx_n_s_Y,&amp;__pyx_n_s_policy,&amp;__pyx_n_s_pa,&amp;__pyx_n_s_pb,&amp;__pyx_n_s_unsupervised,&amp;__pyx_n_s_score,&amp;__pyx_n_s_copy,&amp;__pyx_n_s_a,&amp;__pyx_n_s_b,&amp;__pyx_n_s_pc_samp,&amp;__pyx_n_s_sgd,&amp;__pyx_n_s_eta,&amp;__pyx_n_s_n_iters,&amp;__pyx_n_s_scale,&amp;__pyx_n_s_asgd,&amp;__pyx_n_s_storeindex,0};
    PyObject* values[17] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    values[2] = ((PyObject *)__pyx_int_0);
    values[3] = ((PyObject *)__pyx_int_neg_1);
    values[4] = ((PyObject *)__pyx_int_neg_1);
    values[5] = ((PyObject *)Py_False);
    values[6] = ((PyObject *)Py_False);
    values[7] = ((PyObject *)Py_True);
    values[8] = ((PyObject *)__pyx_int_0);
    values[9] = ((PyObject *)__pyx_int_0);
    values[10] = ((PyObject *)__pyx_int_1);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9econlearn_8tilecode_8Tilecode_4fit(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, __Pyx_memviewslice __pyx_v_X, __Pyx_memviewslice __pyx_v_Y, PyObject *__pyx_v_policy, PyObject *__pyx_v_pa, PyObject *__pyx_v_pb, PyObject *__pyx_v_unsupervised, PyObject *__pyx_v_score, PyObject *__pyx_v_copy, PyObject *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_pc_samp, PyObject *__pyx_v_sgd, PyObject *__pyx_v_eta, PyObject *__pyx_v_n_iters, PyObject *__pyx_v_scale, PyObject *__pyx_v_asgd, PyObject *__pyx_v_storeindex) {
  PyObject *__pyx_v_atemp = NULL;
  PyObject *__pyx_v_btemp = NULL;
  PyObject *__pyx_v_n = NULL;
  int __pyx_v_i;
  PyObject *__pyx_v_dtemp = NULL;
  __Pyx_memviewslice __pyx_v_XS = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_mem_usage = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fit", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_a);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_b);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_19, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_20, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_21, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_22, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_24, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_26, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_27, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_28, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Tilecode.fit", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_atemp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_btemp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dtemp);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_XS, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mem_usage);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_X, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Y, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_a);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_b);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFF11' onclick='toggleDiv("line270")'> 270:             pc_samp=1, sgd=False, eta=0.01, n_iters=1, scale=0, asgd=False, storeindex=False):</pre>
<pre id='line270' class='code' style='background-color: #FFFF11'>    values[11] = ((PyObject *)Py_False);
    values[12] = ((PyObject *)__pyx_float_0_01);
    values[13] = ((PyObject *)__pyx_int_1);
    values[14] = ((PyObject *)__pyx_int_0);
    values[15] = ((PyObject *)Py_False);
    values[16] = ((PyObject *)Py_False);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 17: values[16] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 16);
        case 16: values[15] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 15);
        case 15: values[14] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 14);
        case 14: values[13] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 13);
        case 13: values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
        case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_X)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Y)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fit", 0, 2, 17, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_policy);
          if (value) { values[2] = value; kw_args--; }
        }
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_pa);
          if (value) { values[3] = value; kw_args--; }
        }
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_pb);
          if (value) { values[4] = value; kw_args--; }
        }
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_unsupervised);
          if (value) { values[5] = value; kw_args--; }
        }
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_score);
          if (value) { values[6] = value; kw_args--; }
        }
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_copy);
          if (value) { values[7] = value; kw_args--; }
        }
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_a);
          if (value) { values[8] = value; kw_args--; }
        }
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_b);
          if (value) { values[9] = value; kw_args--; }
        }
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_pc_samp);
          if (value) { values[10] = value; kw_args--; }
        }
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sgd);
          if (value) { values[11] = value; kw_args--; }
        }
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_eta);
          if (value) { values[12] = value; kw_args--; }
        }
        case 13:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_n_iters);
          if (value) { values[13] = value; kw_args--; }
        }
        case 14:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_scale);
          if (value) { values[14] = value; kw_args--; }
        }
        case 15:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_asgd);
          if (value) { values[15] = value; kw_args--; }
        }
        case 16:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_storeindex);
          if (value) { values[16] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "fit") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case 17: values[16] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 16);
        case 16: values[15] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 15);
        case 15: values[14] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 14);
        case 14: values[13] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 13);
        case 13: values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
        case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_X = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[0]);<span class='error_goto'> if (unlikely(!__pyx_v_X.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_Y = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[1]);<span class='error_goto'> if (unlikely(!__pyx_v_Y.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_policy = values[2];
    __pyx_v_pa = values[3];
    __pyx_v_pb = values[4];
    __pyx_v_unsupervised = values[5];
    __pyx_v_score = values[6];
    __pyx_v_copy = values[7];
    __pyx_v_a = values[8];
    __pyx_v_b = values[9];
    __pyx_v_pc_samp = values[10];
    __pyx_v_sgd = values[11];
    __pyx_v_eta = values[12];
    __pyx_v_n_iters = values[13];
    __pyx_v_scale = values[14];
    __pyx_v_asgd = values[15];
    __pyx_v_storeindex = values[16];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("fit", 0, 2, 17, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 269; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Tilecode.fit", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9econlearn_8tilecode_8Tilecode_4fit(((struct __pyx_obj_9econlearn_8tilecode_Tilecode *)__pyx_v_self), __pyx_v_X, __pyx_v_Y, __pyx_v_policy, __pyx_v_pa, __pyx_v_pb, __pyx_v_unsupervised, __pyx_v_score, __pyx_v_copy, __pyx_v_a, __pyx_v_b, __pyx_v_pc_samp, __pyx_v_sgd, __pyx_v_eta, __pyx_v_n_iters, __pyx_v_scale, __pyx_v_asgd, __pyx_v_storeindex);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line271")'> 271: </pre>
<pre id='line271' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line272")'> 272:         """</pre>
<pre id='line272' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line273")'> 273:         Fit tilecode function by averaging (then by SGD if sgd=True)</pre>
<pre id='line273' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line274")'> 274: </pre>
<pre id='line274' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line275")'> 275:         Parameters</pre>
<pre id='line275' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line276")'> 276:         -----------</pre>
<pre id='line276' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line277")'> 277:         X : array, shape=(N, D)</pre>
<pre id='line277' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line278")'> 278:             Input data (unscaled), policy variable is first dimension X[:,0]</pre>
<pre id='line278' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line279")'> 279: </pre>
<pre id='line279' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line280")'> 280:         Y : array, shape=(N)</pre>
<pre id='line280' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line281")'> 281:             Output data (unscaled), (e.g., Q samples)</pre>
<pre id='line281' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line282")'> 282: </pre>
<pre id='line282' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line283")'> 283:         score : boolean, (default=False)</pre>
<pre id='line283' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line284")'> 284:             Calculate R-squared</pre>
<pre id='line284' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line285")'> 285: </pre>
<pre id='line285' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line286")'> 286:         cores : integer, (default=1)</pre>
<pre id='line286' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line287")'> 287:             Number of CPU cores / jobs to use for fitting</pre>
<pre id='line287' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line288")'> 288: </pre>
<pre id='line288' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line289")'> 289:         copy : boolean (default=False)</pre>
<pre id='line289' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line290")'> 290:             Store X and Y</pre>
<pre id='line290' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line291")'> 291: </pre>
<pre id='line291' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line292")'> 292:         setrange : boolean (default=False)</pre>
<pre id='line292' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line293")'> 293:             Restrict tiling to a percentile range (if False then use min-max of data)</pre>
<pre id='line293' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line294")'> 294: </pre>
<pre id='line294' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line295")'> 295:         a : array, optional shape=(D)</pre>
<pre id='line295' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line296")'> 296:             Percentile to use for minimum tiling range</pre>
<pre id='line296' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line297")'> 297: </pre>
<pre id='line297' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line298")'> 298:         b : array, optional, shape=(D)</pre>
<pre id='line298' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line299")'> 299:             Percentile to use for maximum tiling range</pre>
<pre id='line299' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line300")'> 300: </pre>
<pre id='line300' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line301")'> 301:         pc_samp : float, (default=0.05</pre>
<pre id='line301' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line302")'> 302:             Proportion of sample to use when calculating percentile ranges (only needed when setrange = True)</pre>
<pre id='line302' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line303")'> 303: </pre>
<pre id='line303' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line304")'> 304:         R2 : array, shape=(D)</pre>
<pre id='line304' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line305")'> 305:             Score (r-squared)</pre>
<pre id='line305' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line306")'> 306: </pre>
<pre id='line306' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line307")'> 307:         sgd : boolean (default=False)</pre>
<pre id='line307' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line308")'> 308:             Fit by Stochastic Gradient Descent (SGD) (using averaging for starting values)</pre>
<pre id='line308' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line309")'> 309: </pre>
<pre id='line309' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line310")'> 310:         eta : float (default=.01)</pre>
<pre id='line310' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line311")'> 311:             SGD Learning rate</pre>
<pre id='line311' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line312")'> 312: </pre>
<pre id='line312' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line313")'> 313:         n_iters : int (default=1)</pre>
<pre id='line313' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line314")'> 314:             Number of passes over the data set in SGD</pre>
<pre id='line314' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line315")'> 315: </pre>
<pre id='line315' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line316")'> 316:         scale : float (default=0)</pre>
<pre id='line316' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line317")'> 317:             Learning rate scaling factor in SGD</pre>
<pre id='line317' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line318")'> 318:         """</pre>
<pre id='line318' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line319")'> 319:         ##################      Initialize      ####################</pre>
<pre id='line319' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line320")'> 320: </pre>
<pre id='line320' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line321")'> 321:         # Number of data points</pre>
<pre id='line321' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line322")'> 322:         self.N = X.shape[0]</pre>
<pre id='line322' class='code' style='background-color: #FFFFff'>  __pyx_v_self-&gt;N = (__pyx_v_X.shape[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line323")'> 323: </pre>
<pre id='line323' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line324")'> 324:         # Store data</pre>
<pre id='line324' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line325")'> 325:         if copy:</pre>
<pre id='line325' class='code' style='background-color: #FFFFd4'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_copy);<span class='error_goto'> if (unlikely(__pyx_t_1 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 325; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line326")'> 326:             self.X = X</pre>
<pre id='line326' class='code' style='background-color: #FFFFff'>    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;X, 0);
    __PYX_INC_MEMVIEW(&amp;__pyx_v_X, 0);
    __pyx_v_self-&gt;X = __pyx_v_X;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line327")'> 327:             self.Y = Y</pre>
<pre id='line327' class='code' style='background-color: #FFFFff'>    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;Y, 0);
    __PYX_INC_MEMVIEW(&amp;__pyx_v_Y, 0);
    __pyx_v_self-&gt;Y = __pyx_v_Y;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line328")'> 328: </pre>
<pre id='line328' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line329")'> 329:         # Set min-max tiling range</pre>
<pre id='line329' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line330")'> 330:         if a == 0:</pre>
<pre id='line330' class='code' style='background-color: #FFFF8d'>  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_a, __pyx_int_0, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_1 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line331")'> 331:             a = [0]*self.D</pre>
<pre id='line331' class='code' style='background-color: #FFFF8d'>    __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1 * ((__pyx_v_self-&gt;D&lt;0) ? 0:__pyx_v_self-&gt;D));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 331; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    { Py_ssize_t __pyx_temp;
      for (__pyx_temp=0; __pyx_temp &lt; __pyx_v_self-&gt;D; __pyx_temp++) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
        <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, __pyx_temp, __pyx_int_0);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_a, __pyx_t_2);
    __pyx_t_2 = 0;
    goto __pyx_L4;
  }
  __pyx_L4:;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line332")'> 332:         if b == 0:</pre>
<pre id='line332' class='code' style='background-color: #FFFF8d'>  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_b, __pyx_int_0, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_1 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line333")'> 333:             b = [100]*self.D</pre>
<pre id='line333' class='code' style='background-color: #FFFF8d'>    __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1 * ((__pyx_v_self-&gt;D&lt;0) ? 0:__pyx_v_self-&gt;D));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    { Py_ssize_t __pyx_temp;
      for (__pyx_temp=0; __pyx_temp &lt; __pyx_v_self-&gt;D; __pyx_temp++) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_100);
        <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, __pyx_temp, __pyx_int_100);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_100);
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_b, __pyx_t_2);
    __pyx_t_2 = 0;
    goto __pyx_L5;
  }
  __pyx_L5:;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line334")'> 334:         atemp = np.zeros(self.D)</pre>
<pre id='line334' class='code' style='background-color: #FFFF5e'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_atemp = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF5e' onclick='toggleDiv("line335")'> 335:         btemp = np.zeros(self.D)</pre>
<pre id='line335' class='code' style='background-color: #FFFF5e'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_btemp = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line336")'> 336:         n = int(pc_samp * self.N)</pre>
<pre id='line336' class='code' style='background-color: #FFFF6a'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;N);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_pc_samp, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Int</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_n = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line337")'> 337:         for i in range(self.D):</pre>
<pre id='line337' class='code' style='background-color: #FFFFff'>  __pyx_t_5 = __pyx_v_self-&gt;D;
  for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_i = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line338")'> 338:             atemp[i] = np.percentile(X[1:n, i], a[i])</pre>
<pre id='line338' class='code' style='background-color: #FFFF43'>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_percentile);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_n);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = -1;
    __pyx_t_8.data = __pyx_v_X.data;
    __pyx_t_8.memview = __pyx_v_X.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_8, 0);
    if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_8,
    __pyx_v_X.shape[0], __pyx_v_X.strides[0], __pyx_v_X.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_9,
    1,
    __pyx_t_7,
    0,
    1,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_X.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_X.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_8.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_8, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_a, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    __pyx_t_2 = 0;
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_atemp, __pyx_v_i, __pyx_t_4, int, 1, __Pyx_PyInt_From_int, 0, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line339")'> 339:             btemp[i] = np.percentile(X[1:n, i], b[i])</pre>
<pre id='line339' class='code' style='background-color: #FFFF43'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_percentile);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_n);<span class='error_goto'> if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_9 = -1;
    __pyx_t_11.data = __pyx_v_X.data;
    __pyx_t_11.memview = __pyx_v_X.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_11, 0);
    if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_11,
    __pyx_v_X.shape[0], __pyx_v_X.strides[0], __pyx_v_X.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_9,
    1,
    __pyx_t_7,
    0,
    1,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_v_X.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_X.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_11.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_11, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_b, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_3 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    __pyx_t_4 = 0;
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_btemp, __pyx_v_i, __pyx_t_3, int, 1, __Pyx_PyInt_From_int, 0, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line340")'> 340: </pre>
<pre id='line340' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line341")'> 341:         if not(pa == -1):</pre>
<pre id='line341' class='code' style='background-color: #FFFF8d'>  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_pa, __pyx_int_neg_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_1 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_12 = ((!__pyx_t_1) != 0);
  if (__pyx_t_12) {
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line342")'> 342:             atemp[policy] = pa</pre>
<pre id='line342' class='code' style='background-color: #FFFFaa'>    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_atemp, __pyx_v_policy, __pyx_v_pa) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L8;
  }
  __pyx_L8:;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line343")'> 343:         if not(pb == -1):</pre>
<pre id='line343' class='code' style='background-color: #FFFF8d'>  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_pb, __pyx_int_neg_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_12 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 343; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_1 = ((!__pyx_t_12) != 0);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line344")'> 344:             btemp[policy] = pb</pre>
<pre id='line344' class='code' style='background-color: #FFFFaa'>    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_btemp, __pyx_v_policy, __pyx_v_pb) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    goto __pyx_L9;
  }
  __pyx_L9:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line345")'> 345: </pre>
<pre id='line345' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line346")'> 346:         dtemp = 1 / (btemp - atemp)</pre>
<pre id='line346' class='code' style='background-color: #FFFF8d'>  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_btemp, __pyx_v_atemp);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_int_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 346; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_dtemp = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line347")'> 347:         # Memoryviews</pre>
<pre id='line347' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line348")'> 348:         self.a = atemp</pre>
<pre id='line348' class='code' style='background-color: #FFFFd4'>  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_atemp);
  if (unlikely(!__pyx_t_13.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;a, 0);
  __pyx_v_self-&gt;a = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line349")'> 349:         self.b = btemp</pre>
<pre id='line349' class='code' style='background-color: #FFFFd4'>  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_btemp);
  if (unlikely(!__pyx_t_13.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 349; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;b, 0);
  __pyx_v_self-&gt;b = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line350")'> 350:         self.d = dtemp</pre>
<pre id='line350' class='code' style='background-color: #FFFFd4'>  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_dtemp);
  if (unlikely(!__pyx_t_13.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 350; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;d, 0);
  __pyx_v_self-&gt;d = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line351")'> 351: </pre>
<pre id='line351' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line352")'> 352:         # Zero weights</pre>
<pre id='line352' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line353")'> 353:         self.w = np.zeros([self.mem_max])</pre>
<pre id='line353' class='code' style='background-color: #FFFF46'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;mem_max);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_10);
  if (unlikely(!__pyx_t_14.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;w, 0);
  __pyx_v_self-&gt;w = __pyx_t_14;
  __pyx_t_14.memview = NULL;
  __pyx_t_14.data = NULL;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line354")'> 354:         self.wav = np.zeros([self.mem_max])</pre>
<pre id='line354' class='code' style='background-color: #FFFF46'>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;mem_max);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_3);
  if (unlikely(!__pyx_t_15.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;wav, 0);
  __pyx_v_self-&gt;wav = __pyx_t_15;
  __pyx_t_15.memview = NULL;
  __pyx_t_15.data = NULL;
</pre><pre class='line' style='background-color: #FFFF36' onclick='toggleDiv("line355")'> 355:         self.count = np.zeros([self.mem_max], dtype='int32')</pre>
<pre id='line355' class='code' style='background-color: #FFFF36'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;mem_max);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_16.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 355; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;count, 0);
  __pyx_v_self-&gt;count = __pyx_t_16;
  __pyx_t_16.memview = NULL;
  __pyx_t_16.data = NULL;
</pre><pre class='line' style='background-color: #FFFF36' onclick='toggleDiv("line356")'> 356:         self.key = np.zeros([self.mem_max], dtype='int32')</pre>
<pre id='line356' class='code' style='background-color: #FFFF36'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;mem_max);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_10);
  if (unlikely(!__pyx_t_17.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 356; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;key, 0);
  __pyx_v_self-&gt;key = __pyx_t_17;
  __pyx_t_17.memview = NULL;
  __pyx_t_17.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line357")'> 357: </pre>
<pre id='line357' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line358")'> 358:         if self.dohash == 0:</pre>
<pre id='line358' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = ((__pyx_v_self-&gt;dohash == 0) != 0);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line359")'> 359:             self.key = np.array(range(self.mem_max), dtype='int32')</pre>
<pre id='line359' class='code' style='background-color: #FFFF33'>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;mem_max);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_10);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    __pyx_t_10 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_range, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_10);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    __pyx_t_10 = 0;
    __pyx_t_10 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_2);
    if (unlikely(!__pyx_t_17.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 359; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;key, 0);
    __pyx_v_self-&gt;key = __pyx_t_17;
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
    goto __pyx_L10;
  }
  __pyx_L10:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line360")'> 360: </pre>
<pre id='line360' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line361")'> 361:         self.extrap = np.zeros(self.N, dtype='int32')</pre>
<pre id='line361' class='code' style='background-color: #FFFF3e'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;N);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_3);
  if (unlikely(!__pyx_t_18.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;extrap, 0);
  __pyx_v_self-&gt;extrap = __pyx_t_18;
  __pyx_t_18.memview = NULL;
  __pyx_t_18.data = NULL;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line362")'> 362:         cdef double[:,:] XS = np.zeros([self.N, self.D])</pre>
<pre id='line362' class='code' style='background-color: #FFFF41'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;N);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_10);
  if (unlikely(!__pyx_t_19.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 362; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_v_XS = __pyx_t_19;
  __pyx_t_19.memview = NULL;
  __pyx_t_19.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line363")'> 363:         ###############################################################</pre>
<pre id='line363' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line364")'> 364: </pre>
<pre id='line364' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line365")'> 365:         XS = self.scale_X(X, self.N, XS)</pre>
<pre id='line365' class='code' style='background-color: #FFFFff'>  __pyx_t_20 = ((struct __pyx_vtabstruct_9econlearn_8tilecode_Tilecode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;scale_X(__pyx_v_self, __pyx_v_X, __pyx_v_self-&gt;N, __pyx_v_XS);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 365; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_XS, 1);
  __pyx_v_XS = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line366")'> 366:         self.extrap = self.check_extrap(XS, self.N, self.extrap)</pre>
<pre id='line366' class='code' style='background-color: #FFFFff'>  __pyx_t_21 = ((struct __pyx_vtabstruct_9econlearn_8tilecode_Tilecode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;check_extrap(__pyx_v_self, __pyx_v_XS, __pyx_v_self-&gt;N, __pyx_v_self-&gt;extrap);<span class='error_goto'> if (unlikely(!__pyx_t_21.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 366; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;extrap, 0);
  __pyx_v_self-&gt;extrap = __pyx_t_21;
  __pyx_t_21.memview = NULL;
  __pyx_t_21.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line367")'> 367: </pre>
<pre id='line367' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line368")'> 368:         self.fit_tiles(XS, Y)</pre>
<pre id='line368' class='code' style='background-color: #FFFFff'>  ((struct __pyx_vtabstruct_9econlearn_8tilecode_Tilecode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;fit_tiles(__pyx_v_self, __pyx_v_XS, __pyx_v_Y);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line369")'> 369: </pre>
<pre id='line369' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line370")'> 370:         if storeindex:</pre>
<pre id='line370' class='code' style='background-color: #FFFFd4'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_storeindex);<span class='error_goto'> if (unlikely(__pyx_t_1 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 370; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line371")'> 371:             self.datastruct_reverse = np.zeros([self.N, self.L], dtype='int32')</pre>
<pre id='line371' class='code' style='background-color: #FFFF33'>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;N);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;L);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_10);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    __pyx_t_10 = 0;
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_22 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_10);
    if (unlikely(!__pyx_t_22.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;datastruct_reverse, 0);
    __pyx_v_self-&gt;datastruct_reverse = __pyx_t_22;
    __pyx_t_22.memview = NULL;
    __pyx_t_22.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line372")'> 372:             self.fit_data_reverse(XS, self.N, self.extrap)</pre>
<pre id='line372' class='code' style='background-color: #FFFFff'>    ((struct __pyx_vtabstruct_9econlearn_8tilecode_Tilecode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;fit_data_reverse(__pyx_v_self, __pyx_v_XS, __pyx_v_self-&gt;N, __pyx_v_self-&gt;extrap);
    goto __pyx_L11;
  }
  __pyx_L11:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line373")'> 373: </pre>
<pre id='line373' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line374")'> 374:         self.sgd = 0</pre>
<pre id='line374' class='code' style='background-color: #FFFFff'>  __pyx_v_self-&gt;sgd = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line375")'> 375:         if sgd:</pre>
<pre id='line375' class='code' style='background-color: #FFFFd4'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_sgd);<span class='error_goto'> if (unlikely(__pyx_t_1 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line376")'> 376:             self.sgd = 1</pre>
<pre id='line376' class='code' style='background-color: #FFFFff'>    __pyx_v_self-&gt;sgd = 1;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line377")'> 377:             if asgd == True:</pre>
<pre id='line377' class='code' style='background-color: #FFFF8d'>    __pyx_t_10 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_asgd, Py_True, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(__pyx_t_1 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 377; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line378")'> 378:                 self.asgd = 1</pre>
<pre id='line378' class='code' style='background-color: #FFFFff'>      __pyx_v_self-&gt;asgd = 1;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line379")'> 379:                 self.wav = np.zeros([self.mem_max])</pre>
<pre id='line379' class='code' style='background-color: #FFFF46'>      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;mem_max);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_10);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
      __pyx_t_10 = 0;
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_2);
      if (unlikely(!__pyx_t_15.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;wav, 0);
      __pyx_v_self-&gt;wav = __pyx_t_15;
      __pyx_t_15.memview = NULL;
      __pyx_t_15.data = NULL;
      goto __pyx_L13;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line380")'> 380:             else:</pre>
<pre id='line380' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line381")'> 381:                 self.asgd = 0</pre>
<pre id='line381' class='code' style='background-color: #FFFFff'>      __pyx_v_self-&gt;asgd = 0;
    }
    __pyx_L13:;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line382")'> 382:             self.eta = eta</pre>
<pre id='line382' class='code' style='background-color: #FFFFaa'>    __pyx_t_23 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_eta);<span class='error_goto'> if (unlikely((__pyx_t_23 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 382; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_self-&gt;eta = __pyx_t_23;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line383")'> 383:             self.scale = scale</pre>
<pre id='line383' class='code' style='background-color: #FFFFaa'>    __pyx_t_23 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_scale);<span class='error_goto'> if (unlikely((__pyx_t_23 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_self-&gt;scale = __pyx_t_23;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line384")'> 384: </pre>
<pre id='line384' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line385")'> 385:             self.tempidx = np.zeros(self.L, dtype='int32')</pre>
<pre id='line385' class='code' style='background-color: #FFFF3e'>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;L);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_4);
    if (unlikely(!__pyx_t_24.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;tempidx, 0);
    __pyx_v_self-&gt;tempidx = __pyx_t_24;
    __pyx_t_24.memview = NULL;
    __pyx_t_24.data = NULL;
</pre><pre class='line' style='background-color: #FFFF73' onclick='toggleDiv("line386")'> 386:             self.fit_sgd(XS, Y, eta, scale, n_iters, self.asgd)</pre>
<pre id='line386' class='code' style='background-color: #FFFF73'>    __pyx_t_23 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_eta);<span class='error_goto'> if (unlikely((__pyx_t_23 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_25 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_scale);<span class='error_goto'> if (unlikely((__pyx_t_25 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_n_iters);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 386; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    ((struct __pyx_vtabstruct_9econlearn_8tilecode_Tilecode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;fit_sgd(__pyx_v_self, __pyx_v_XS, __pyx_v_Y, __pyx_t_23, __pyx_t_25, __pyx_t_5, __pyx_v_self-&gt;asgd);
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line387")'> 387:             self.wav = np.zeros([self.mem_max])</pre>
<pre id='line387' class='code' style='background-color: #FFFF46'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;mem_max);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_3);
    if (unlikely(!__pyx_t_15.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 387; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;wav, 0);
    __pyx_v_self-&gt;wav = __pyx_t_15;
    __pyx_t_15.memview = NULL;
    __pyx_t_15.data = NULL;
    goto __pyx_L12;
  }
  __pyx_L12:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line388")'> 388: </pre>
<pre id='line388' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line389")'> 389:         if self.lin_spline == 1:</pre>
<pre id='line389' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = ((__pyx_v_self-&gt;lin_spline == 1) != 0);
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line390")'> 390:             self.fit_linear(XS, Y)</pre>
<pre id='line390' class='code' style='background-color: #FFFFff'>    ((struct __pyx_vtabstruct_9econlearn_8tilecode_Tilecode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;fit_linear(__pyx_v_self, __pyx_v_XS, __pyx_v_Y);
    goto __pyx_L14;
  }
  __pyx_L14:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line391")'> 391: </pre>
<pre id='line391' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line392")'> 392:         if score:</pre>
<pre id='line392' class='code' style='background-color: #FFFFd4'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_score);<span class='error_goto'> if (unlikely(__pyx_t_1 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line393")'> 393:             self.R2 = self.score(X, Y)</pre>
<pre id='line393' class='code' style='background-color: #FFFF57'>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_score);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_X, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_Y, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    __pyx_t_4 = 0;
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_25 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_25 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_self-&gt;R2 = __pyx_t_25;
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line394")'> 394:             print 'R-squared: ' + str(self.R2)</pre>
<pre id='line394' class='code' style='background-color: #FFFF4d'>    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;R2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyString_Type))), __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_R_squared, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_10) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 394; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    goto __pyx_L15;
  }
  __pyx_L15:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line395")'> 395: </pre>
<pre id='line395' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line396")'> 396:         if unsupervised:</pre>
<pre id='line396' class='code' style='background-color: #FFFFd4'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_unsupervised);<span class='error_goto'> if (unlikely(__pyx_t_1 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 396; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF26' onclick='toggleDiv("line397")'> 397:             self.datastruct = np.ones(int(np.sum(self.count) + 10), dtype='int32')</pre>
<pre id='line397' class='code' style='background-color: #FFFF26'>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;count, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_10);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    __pyx_t_10 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_10, __pyx_int_10);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='py_c_api'>PyNumber_Int</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_10);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    __pyx_t_10 = 0;
    __pyx_t_10 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_26 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_3);
    if (unlikely(!__pyx_t_26.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 397; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;datastruct, 0);
    __pyx_v_self-&gt;datastruct = __pyx_t_26;
    __pyx_t_26.memview = NULL;
    __pyx_t_26.data = NULL;
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line398")'> 398:             self.datahash = np.zeros(self.mem_max, dtype='int32')</pre>
<pre id='line398' class='code' style='background-color: #FFFF3e'>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;mem_max);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_27 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_2);
    if (unlikely(!__pyx_t_27.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 398; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;datahash, 0);
    __pyx_v_self-&gt;datahash = __pyx_t_27;
    __pyx_t_27.memview = NULL;
    __pyx_t_27.data = NULL;
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line399")'> 399:             self.fit_data(XS, np.zeros(self.mem_max, dtype='int32'))</pre>
<pre id='line399' class='code' style='background-color: #FFFF3e'>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;mem_max);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_28 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_10);
    if (unlikely(!__pyx_t_28.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 399; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    ((struct __pyx_vtabstruct_9econlearn_8tilecode_Tilecode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;fit_data(__pyx_v_self, __pyx_v_XS, __pyx_t_28);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_28, 1);
</pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line400")'> 400:             self.max_neigh = np.max(self.count) * self.L</pre>
<pre id='line400' class='code' style='background-color: #FFFF44'>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_max);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;count, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_10);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    __pyx_t_10 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;L);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_10, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_self-&gt;max_neigh = __pyx_t_5;
    goto __pyx_L16;
  }
  __pyx_L16:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line401")'> 401: </pre>
<pre id='line401' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line402")'> 402:         mem_usage = np.count_nonzero(self.count) / self.mem_max</pre>
<pre id='line402' class='code' style='background-color: #FFFF52'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_count_nonzero);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;count, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;mem_max);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_2, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 402; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_v_mem_usage = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line403")'> 403:         if mem_usage &lt; 0.025:</pre>
<pre id='line403' class='code' style='background-color: #FFFF8d'>  __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_mem_usage, __pyx_float_0_025, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_1 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_1) {
</pre><pre class='line' style='background-color: #FFFF57' onclick='toggleDiv("line404")'> 404:             print 'Tilecoding memory usage: ' + str(mem_usage)</pre>
<pre id='line404' class='code' style='background-color: #FFFF57'>    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mem_usage);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_mem_usage);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_mem_usage);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyString_Type))), __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_Tilecoding_memory_usage, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_4) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 404; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF20' onclick='toggleDiv("line405")'> 405:             print 'On average ' + str(np.count_nonzero(self.count)/self.L) + ' of ' + str(self.SIZE) + ' tiles are active per layer'</pre>
<pre id='line405' class='code' style='background-color: #FFFF20'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_count_nonzero);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;count, 1, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;L);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_10);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    __pyx_t_10 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyString_Type))), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_On_average, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_kp_s_of);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;SIZE);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyString_Type))), __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_10, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_kp_s_tiles_are_active_per_layer);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    goto __pyx_L17;
  }
  __pyx_L17:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line406")'> 406: </pre>
<pre id='line406' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line407")'> 407:     cdef int[:] check_extrap(self, double[:,:] XS, int N, int[:] extrap):</pre>
<pre id='line407' class='code' style='background-color: #FFFFaa'>static __Pyx_memviewslice __pyx_f_9econlearn_8tilecode_8Tilecode_check_extrap(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, __Pyx_memviewslice __pyx_v_XS, CYTHON_UNUSED int __pyx_v_N, __Pyx_memviewslice __pyx_v_extrap) {
  int __pyx_v_i;
  int __pyx_v_k;
  double __pyx_v_xs;
  double __pyx_v_xmax;
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("check_extrap", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError,"Memoryview return value is not initialized");
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line408")'> 408: </pre>
<pre id='line408' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line409")'> 409:         cdef int i, k</pre>
<pre id='line409' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line410")'> 410:         cdef double xs = 0</pre>
<pre id='line410' class='code' style='background-color: #FFFFff'>  __pyx_v_xs = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line411")'> 411:         cdef double xmax = 0</pre>
<pre id='line411' class='code' style='background-color: #FFFFff'>  __pyx_v_xmax = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line412")'> 412: </pre>
<pre id='line412' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line413")'> 413:         for i in prange(N, nogil=True, num_threads=self.CORES, schedule=dynamic):</pre>
<pre id='line413' class='code' style='background-color: #FFFFff'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_N;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_k) lastprivate(__pyx_v_xs) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_xmax)        __pyx_t_1 = __pyx_v_N;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_k) lastprivate(__pyx_v_xs) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_xmax) num_threads(__pyx_v_self-&gt;CORES)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_i = 0 + 1 * __pyx_t_2;
                            /* Initialize private variables to invalid values */
                            __pyx_v_k = ((int)0xbad0bad0);
                            __pyx_v_xs = ((double)__PYX_NAN());
                            __pyx_v_xmax = ((double)__PYX_NAN());
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line414")'> 414:             for k in range(self.D):</pre>
<pre id='line414' class='code' style='background-color: #FFFFff'>                            __pyx_t_4 = __pyx_v_self-&gt;D;
                            for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
                              __pyx_v_k = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line415")'> 415:                 xs = XS[i, k]</pre>
<pre id='line415' class='code' style='background-color: #FFFFff'>                              __pyx_t_6 = __pyx_v_i;
                              __pyx_t_7 = __pyx_v_k;
                              __pyx_v_xs = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_XS.data + __pyx_t_6 * __pyx_v_XS.strides[0]) ) + __pyx_t_7 * __pyx_v_XS.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line416")'> 416:                 xmax = self.T[k] + 0.0001</pre>
<pre id='line416' class='code' style='background-color: #FFFFff'>                              __pyx_t_8 = __pyx_v_k;
                              __pyx_v_xmax = ((*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;T.data + __pyx_t_8 * __pyx_v_self-&gt;T.strides[0]) ))) + 0.0001);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line417")'> 417:                 if xs &lt; -0.0001 or xs &gt; xmax:</pre>
<pre id='line417' class='code' style='background-color: #FFFFff'>                              __pyx_t_9 = ((__pyx_v_xs &lt; -0.0001) != 0);
                              if (!__pyx_t_9) {
                                __pyx_t_10 = ((__pyx_v_xs &gt; __pyx_v_xmax) != 0);
                                __pyx_t_11 = __pyx_t_10;
                              } else {
                                __pyx_t_11 = __pyx_t_9;
                              }
                              if (__pyx_t_11) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line418")'> 418:                     extrap[i] = 1</pre>
<pre id='line418' class='code' style='background-color: #FFFFff'>                                __pyx_t_12 = __pyx_v_i;
                                *((int *) ( /* dim=0 */ (__pyx_v_extrap.data + __pyx_t_12 * __pyx_v_extrap.strides[0]) )) = 1;
                                goto __pyx_L12;
                              }
                              __pyx_L12:;
                            }
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line419")'> 419: </pre>
<pre id='line419' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line420")'> 420:         return extrap</pre>
<pre id='line420' class='code' style='background-color: #FFFFff'>  __PYX_INC_MEMVIEW(&amp;__pyx_v_extrap, 0);
  __pyx_r = __pyx_v_extrap;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line421")'> 421: </pre>
<pre id='line421' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line422")'> 422:     cdef double[:,:] scale_X(self, double[:,:] X, int N, double[:,:] XS):</pre>
<pre id='line422' class='code' style='background-color: #FFFFaa'>static __Pyx_memviewslice __pyx_f_9econlearn_8tilecode_8Tilecode_scale_X(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, __Pyx_memviewslice __pyx_v_X, CYTHON_UNUSED int __pyx_v_N, __Pyx_memviewslice __pyx_v_XS) {
  int __pyx_v_i;
  int __pyx_v_k;
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("scale_X", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError,"Memoryview return value is not initialized");
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line423")'> 423: </pre>
<pre id='line423' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line424")'> 424:         cdef int i, k</pre>
<pre id='line424' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line425")'> 425: </pre>
<pre id='line425' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line426")'> 426:         for i in prange(N, nogil=True, num_threads=self.CORES, schedule=dynamic):</pre>
<pre id='line426' class='code' style='background-color: #FFFFff'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_N;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_k)        __pyx_t_1 = __pyx_v_N;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_k) num_threads(__pyx_v_self-&gt;CORES)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_i = 0 + 1 * __pyx_t_2;
                            /* Initialize private variables to invalid values */
                            __pyx_v_k = ((int)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line427")'> 427:             for k in range(self.D):</pre>
<pre id='line427' class='code' style='background-color: #FFFFff'>                            __pyx_t_4 = __pyx_v_self-&gt;D;
                            for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
                              __pyx_v_k = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line428")'> 428:                 XS[i, k] = ((X[i, k] - self.a[k]) * self.d[k]) * self.T[k]</pre>
<pre id='line428' class='code' style='background-color: #FFFFff'>                              __pyx_t_6 = __pyx_v_i;
                              __pyx_t_7 = __pyx_v_k;
                              __pyx_t_8 = __pyx_v_k;
                              __pyx_t_9 = __pyx_v_k;
                              __pyx_t_10 = __pyx_v_k;
                              __pyx_t_11 = __pyx_v_i;
                              __pyx_t_12 = __pyx_v_k;
                              *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_XS.data + __pyx_t_11 * __pyx_v_XS.strides[0]) ) + __pyx_t_12 * __pyx_v_XS.strides[1]) )) = ((((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_X.data + __pyx_t_6 * __pyx_v_X.strides[0]) ) + __pyx_t_7 * __pyx_v_X.strides[1]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;a.data + __pyx_t_8 * __pyx_v_self-&gt;a.strides[0]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;d.data + __pyx_t_9 * __pyx_v_self-&gt;d.strides[0]) )))) * (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;T.data + __pyx_t_10 * __pyx_v_self-&gt;T.strides[0]) ))));
                            }
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line429")'> 429: </pre>
<pre id='line429' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line430")'> 430:         return XS</pre>
<pre id='line430' class='code' style='background-color: #FFFFff'>  __PYX_INC_MEMVIEW(&amp;__pyx_v_XS, 0);
  __pyx_r = __pyx_v_XS;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line431")'> 431: </pre>
<pre id='line431' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line432")'> 432: </pre>
<pre id='line432' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line433")'> 433:     cdef void fit_tiles(self, double[:,:] X, double[:] Y):</pre>
<pre id='line433' class='code' style='background-color: #FFFFff'>static void __pyx_f_9econlearn_8tilecode_8Tilecode_fit_tiles(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, __Pyx_memviewslice __pyx_v_X, __Pyx_memviewslice __pyx_v_Y) {
  int __pyx_v_idx;
  int __pyx_v_i;
  int __pyx_v_j;
  double __pyx_v_n;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fit_tiles", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line434")'> 434: </pre>
<pre id='line434' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line435")'> 435:         cdef int idx = 0</pre>
<pre id='line435' class='code' style='background-color: #FFFFff'>  __pyx_v_idx = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line436")'> 436:         cdef int i, j</pre>
<pre id='line436' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line437")'> 437:         cdef double n = 0</pre>
<pre id='line437' class='code' style='background-color: #FFFFff'>  __pyx_v_n = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line438")'> 438: </pre>
<pre id='line438' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line439")'> 439:         for j in prange(self.L, nogil=True, num_threads=self.CORES, schedule=guided):</pre>
<pre id='line439' class='code' style='background-color: #FFFFff'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_self-&gt;L;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_i) firstprivate(__pyx_v_j) lastprivate(__pyx_v_j) lastprivate(__pyx_v_idx)        __pyx_t_1 = __pyx_v_self-&gt;L;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_i) firstprivate(__pyx_v_j) lastprivate(__pyx_v_j) lastprivate(__pyx_v_idx) num_threads(__pyx_v_self-&gt;CORES)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_j = 0 + 1 * __pyx_t_2;
                            /* Initialize private variables to invalid values */
                            __pyx_v_i = ((int)0xbad0bad0);
                            __pyx_v_idx = ((int)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line440")'> 440:             for i in range(self.N):</pre>
<pre id='line440' class='code' style='background-color: #FFFFff'>                            __pyx_t_4 = __pyx_v_self-&gt;N;
                            for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
                              __pyx_v_i = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line441")'> 441:                 if self.extrap[i] == 0:</pre>
<pre id='line441' class='code' style='background-color: #FFFFff'>                              __pyx_t_6 = __pyx_v_i;
                              __pyx_t_7 = (((*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;extrap.data + __pyx_t_6 * __pyx_v_self-&gt;extrap.strides[0]) ))) == 0) != 0);
                              if (__pyx_t_7) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line442")'> 442:                     idx = getindex(j, i, X, self.D, self.offset, self.flat, self.SIZE, self.dohash, self.mem_max, self.key)</pre>
<pre id='line442' class='code' style='background-color: #FFFFff'>                                __pyx_v_idx = __pyx_f_9econlearn_8tilecode_getindex(__pyx_v_j, __pyx_v_i, __pyx_v_X, __pyx_v_self-&gt;D, __pyx_v_self-&gt;offset, __pyx_v_self-&gt;flat, __pyx_v_self-&gt;SIZE, __pyx_v_self-&gt;dohash, __pyx_v_self-&gt;mem_max, __pyx_v_self-&gt;key);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line443")'> 443:                     self.count[idx] += 1</pre>
<pre id='line443' class='code' style='background-color: #FFFFff'>                                __pyx_t_8 = __pyx_v_idx;
                                *((int *) ( /* dim=0 */ (__pyx_v_self-&gt;count.data + __pyx_t_8 * __pyx_v_self-&gt;count.strides[0]) )) += 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line444")'> 444:                     self.w[idx] += Y[i]</pre>
<pre id='line444' class='code' style='background-color: #FFFFff'>                                __pyx_t_9 = __pyx_v_i;
                                __pyx_t_10 = __pyx_v_idx;
                                *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;w.data + __pyx_t_10 * __pyx_v_self-&gt;w.strides[0]) )) += (*((double *) ( /* dim=0 */ (__pyx_v_Y.data + __pyx_t_9 * __pyx_v_Y.strides[0]) )));
                                goto __pyx_L12;
                              }
                              __pyx_L12:;
                            }
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line445")'> 445: </pre>
<pre id='line445' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line446")'> 446:         for j in prange(self.mem_max, nogil=True, num_threads=self.CORES, schedule=dynamic):</pre>
<pre id='line446' class='code' style='background-color: #FFFFff'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
        __pyx_t_3 = __pyx_v_self-&gt;mem_max;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_1 = (__pyx_t_3 - 0) / 1;
            if (__pyx_t_1 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_n) firstprivate(__pyx_v_j) lastprivate(__pyx_v_j)        __pyx_t_3 = __pyx_v_self-&gt;mem_max;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_1 = (__pyx_t_3 - 0) / 1;
            if (__pyx_t_1 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_n) firstprivate(__pyx_v_j) lastprivate(__pyx_v_j) num_threads(__pyx_v_self-&gt;CORES)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2++){
                        {
                            __pyx_v_j = 0 + 1 * __pyx_t_2;
                            /* Initialize private variables to invalid values */
                            __pyx_v_n = ((double)__PYX_NAN());
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L17;
        }
        __pyx_L17:;
      }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line447")'> 447:             n = self.count[j]</pre>
<pre id='line447' class='code' style='background-color: #FFFFff'>                            __pyx_t_4 = __pyx_v_j;
                            __pyx_v_n = (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;count.data + __pyx_t_4 * __pyx_v_self-&gt;count.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line448")'> 448:             if n &gt; 0:</pre>
<pre id='line448' class='code' style='background-color: #FFFFff'>                            __pyx_t_7 = ((__pyx_v_n &gt; 0.0) != 0);
                            if (__pyx_t_7) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line449")'> 449:                 self.w[j] = self.w[j] * (n**-1)</pre>
<pre id='line449' class='code' style='background-color: #FFFFff'>                              __pyx_t_5 = __pyx_v_j;
                              __pyx_t_11 = __pyx_v_j;
                              *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;w.data + __pyx_t_11 * __pyx_v_self-&gt;w.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;w.data + __pyx_t_5 * __pyx_v_self-&gt;w.strides[0]) ))) * pow(__pyx_v_n, -1.0));
                              goto __pyx_L22;
                            }
                            __pyx_L22:;
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line450")'> 450: </pre>
<pre id='line450' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line451")'> 451:     cdef void fit_data(self, double[:,:] X, int[:] countsofar):</pre>
<pre id='line451' class='code' style='background-color: #FFFFff'>static void __pyx_f_9econlearn_8tilecode_8Tilecode_fit_data(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, __Pyx_memviewslice __pyx_v_X, __Pyx_memviewslice __pyx_v_countsofar) {
  int __pyx_v_idx;
  int __pyx_v_dataidx;
  int __pyx_v_i;
  int __pyx_v_j;
  CYTHON_UNUSED double __pyx_v_n;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fit_data", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line452")'> 452: </pre>
<pre id='line452' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line453")'> 453:         """ fit data structure mapping tiles to data points """</pre>
<pre id='line453' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line454")'> 454: </pre>
<pre id='line454' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line455")'> 455:         cdef int idx, dataidx = 0</pre>
<pre id='line455' class='code' style='background-color: #FFFFff'>  __pyx_v_dataidx = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line456")'> 456:         cdef int i, j</pre>
<pre id='line456' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line457")'> 457:         cdef double n = 0</pre>
<pre id='line457' class='code' style='background-color: #FFFFff'>  __pyx_v_n = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line458")'> 458: </pre>
<pre id='line458' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line459")'> 459:         for i in range(1, self.mem_max):</pre>
<pre id='line459' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_self-&gt;mem_max;
  for (__pyx_t_2 = 1; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line460")'> 460:             self.datahash[i] = self.datahash[i-1] + self.count[i-1]</pre>
<pre id='line460' class='code' style='background-color: #FFFFff'>    __pyx_t_3 = (__pyx_v_i - 1);
    __pyx_t_4 = (__pyx_v_i - 1);
    __pyx_t_5 = __pyx_v_i;
    *((int *) ( /* dim=0 */ (__pyx_v_self-&gt;datahash.data + __pyx_t_5 * __pyx_v_self-&gt;datahash.strides[0]) )) = ((*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;datahash.data + __pyx_t_3 * __pyx_v_self-&gt;datahash.strides[0]) ))) + (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;count.data + __pyx_t_4 * __pyx_v_self-&gt;count.strides[0]) ))));
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line461")'> 461: </pre>
<pre id='line461' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line462")'> 462:         for i in prange(self.N, num_threads=self.CORES, nogil=True, schedule=guided):</pre>
<pre id='line462' class='code' style='background-color: #FFFFff'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_self-&gt;N;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_6 = (__pyx_t_1 - 0) / 1;
            if (__pyx_t_6 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_idx) lastprivate(__pyx_v_dataidx) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_j)        __pyx_t_1 = __pyx_v_self-&gt;N;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_6 = (__pyx_t_1 - 0) / 1;
            if (__pyx_t_6 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_idx) lastprivate(__pyx_v_dataidx) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_j) num_threads(__pyx_v_self-&gt;CORES)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_6; __pyx_t_2++){
                        {
                            __pyx_v_i = 0 + 1 * __pyx_t_2;
                            /* Initialize private variables to invalid values */
                            __pyx_v_idx = ((int)0xbad0bad0);
                            __pyx_v_dataidx = ((int)0xbad0bad0);
                            __pyx_v_j = ((int)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L7;
        }
        __pyx_L7:;
      }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line463")'> 463:             if self.extrap[i] == 0:</pre>
<pre id='line463' class='code' style='background-color: #FFFFff'>                            __pyx_t_7 = __pyx_v_i;
                            __pyx_t_8 = (((*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;extrap.data + __pyx_t_7 * __pyx_v_self-&gt;extrap.strides[0]) ))) == 0) != 0);
                            if (__pyx_t_8) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line464")'> 464:                 for j in range(self.L):</pre>
<pre id='line464' class='code' style='background-color: #FFFFff'>                              __pyx_t_9 = __pyx_v_self-&gt;L;
                              for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
                                __pyx_v_j = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line465")'> 465:                     idx = getindex(j, i, X, self.D, self.offset, self.flat, self.SIZE, self.dohash, self.mem_max, self.key)</pre>
<pre id='line465' class='code' style='background-color: #FFFFff'>                                __pyx_v_idx = __pyx_f_9econlearn_8tilecode_getindex(__pyx_v_j, __pyx_v_i, __pyx_v_X, __pyx_v_self-&gt;D, __pyx_v_self-&gt;offset, __pyx_v_self-&gt;flat, __pyx_v_self-&gt;SIZE, __pyx_v_self-&gt;dohash, __pyx_v_self-&gt;mem_max, __pyx_v_self-&gt;key);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line466")'> 466:                     dataidx = self.datahash[idx]</pre>
<pre id='line466' class='code' style='background-color: #FFFFff'>                                __pyx_t_11 = __pyx_v_idx;
                                __pyx_v_dataidx = (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;datahash.data + __pyx_t_11 * __pyx_v_self-&gt;datahash.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line467")'> 467:                     self.datastruct[dataidx + countsofar[idx]] = i</pre>
<pre id='line467' class='code' style='background-color: #FFFFff'>                                __pyx_t_12 = __pyx_v_idx;
                                __pyx_t_13 = (__pyx_v_dataidx + (*((int *) ( /* dim=0 */ (__pyx_v_countsofar.data + __pyx_t_12 * __pyx_v_countsofar.strides[0]) ))));
                                *((int *) ( /* dim=0 */ (__pyx_v_self-&gt;datastruct.data + __pyx_t_13 * __pyx_v_self-&gt;datastruct.strides[0]) )) = __pyx_v_i;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line468")'> 468:                     countsofar[idx] += 1</pre>
<pre id='line468' class='code' style='background-color: #FFFFff'>                                __pyx_t_14 = __pyx_v_idx;
                                *((int *) ( /* dim=0 */ (__pyx_v_countsofar.data + __pyx_t_14 * __pyx_v_countsofar.strides[0]) )) += 1;
                              }
                              goto __pyx_L12;
                            }
                            __pyx_L12:;
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line469")'> 469: </pre>
<pre id='line469' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line470")'> 470:     cdef void fit_data_reverse(self, double[:,:] X, int N, int[:] extrap):</pre>
<pre id='line470' class='code' style='background-color: #FFFFff'>static void __pyx_f_9econlearn_8tilecode_8Tilecode_fit_data_reverse(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, __Pyx_memviewslice __pyx_v_X, CYTHON_UNUSED int __pyx_v_N, __Pyx_memviewslice __pyx_v_extrap) {
  int __pyx_v_idx;
  CYTHON_UNUSED int __pyx_v_dataidx;
  int __pyx_v_i;
  int __pyx_v_j;
  CYTHON_UNUSED double __pyx_v_n;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fit_data_reverse", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line471")'> 471: </pre>
<pre id='line471' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line472")'> 472:         """ fit data structure mapping data points to tiles """</pre>
<pre id='line472' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line473")'> 473: </pre>
<pre id='line473' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line474")'> 474:         cdef int idx, dataidx = 0</pre>
<pre id='line474' class='code' style='background-color: #FFFFff'>  __pyx_v_dataidx = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line475")'> 475:         cdef int i, j</pre>
<pre id='line475' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line476")'> 476:         cdef double n = 0</pre>
<pre id='line476' class='code' style='background-color: #FFFFff'>  __pyx_v_n = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line477")'> 477: </pre>
<pre id='line477' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line478")'> 478:         for i in prange(N, num_threads=self.CORES, nogil=True, schedule=guided):</pre>
<pre id='line478' class='code' style='background-color: #FFFFff'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_N;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_j) lastprivate(__pyx_v_idx)        __pyx_t_1 = __pyx_v_N;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_j) lastprivate(__pyx_v_idx) num_threads(__pyx_v_self-&gt;CORES)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_i = 0 + 1 * __pyx_t_2;
                            /* Initialize private variables to invalid values */
                            __pyx_v_j = ((int)0xbad0bad0);
                            __pyx_v_idx = ((int)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line479")'> 479:             if extrap[i] == 0:</pre>
<pre id='line479' class='code' style='background-color: #FFFFff'>                            __pyx_t_4 = __pyx_v_i;
                            __pyx_t_5 = (((*((int *) ( /* dim=0 */ (__pyx_v_extrap.data + __pyx_t_4 * __pyx_v_extrap.strides[0]) ))) == 0) != 0);
                            if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line480")'> 480:                 for j in range(self.L):</pre>
<pre id='line480' class='code' style='background-color: #FFFFff'>                              __pyx_t_6 = __pyx_v_self-&gt;L;
                              for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
                                __pyx_v_j = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line481")'> 481:                     idx = getindex(j, i, X, self.D, self.offset, self.flat, self.SIZE, self.dohash, self.mem_max, self.key)</pre>
<pre id='line481' class='code' style='background-color: #FFFFff'>                                __pyx_v_idx = __pyx_f_9econlearn_8tilecode_getindex(__pyx_v_j, __pyx_v_i, __pyx_v_X, __pyx_v_self-&gt;D, __pyx_v_self-&gt;offset, __pyx_v_self-&gt;flat, __pyx_v_self-&gt;SIZE, __pyx_v_self-&gt;dohash, __pyx_v_self-&gt;mem_max, __pyx_v_self-&gt;key);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line482")'> 482:                     self.datastruct_reverse[i, j] = idx</pre>
<pre id='line482' class='code' style='background-color: #FFFFff'>                                __pyx_t_8 = __pyx_v_i;
                                __pyx_t_9 = __pyx_v_j;
                                *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;datastruct_reverse.data + __pyx_t_8 * __pyx_v_self-&gt;datastruct_reverse.strides[0]) ) + __pyx_t_9 * __pyx_v_self-&gt;datastruct_reverse.strides[1]) )) = __pyx_v_idx;
                              }
                              goto __pyx_L10;
                            }
                            __pyx_L10:;
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line483")'> 483: </pre>
<pre id='line483' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line484")'> 484:     def predict_quad(self, X):</pre>
<pre id='line484' class='code' style='background-color: #FFFF8d'>/* Python wrapper */
static PyObject *__pyx_pw_9econlearn_8tilecode_8Tilecode_7predict_quad(PyObject *__pyx_v_self, PyObject *__pyx_v_X); /*proto*/
static char __pyx_doc_9econlearn_8tilecode_8Tilecode_6predict_quad[] = "    \n        Return predicted value \n\n        Parameters\n        -----------\n        X : array, shape=(N, D) or (D,)\n            Input data\n\n        Returns\n        --------\n    \n        Y : array, shape=(N,)\n            Predicted values\n        ";
static PyObject *__pyx_pw_9econlearn_8tilecode_8Tilecode_7predict_quad(PyObject *__pyx_v_self, PyObject *__pyx_v_X) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("predict_quad (wrapper)", 0);
  __pyx_r = __pyx_pf_9econlearn_8tilecode_8Tilecode_6predict_quad(((struct __pyx_obj_9econlearn_8tilecode_Tilecode *)__pyx_v_self), ((PyObject *)__pyx_v_X));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9econlearn_8tilecode_8Tilecode_6predict_quad(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, PyObject *__pyx_v_X) {
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_XS = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("predict_quad", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Tilecode.predict_quad", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_XS, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line485")'> 485: </pre>
<pre id='line485' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line486")'> 486:         """</pre>
<pre id='line486' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line487")'> 487:         Return predicted value</pre>
<pre id='line487' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line488")'> 488: </pre>
<pre id='line488' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line489")'> 489:         Parameters</pre>
<pre id='line489' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line490")'> 490:         -----------</pre>
<pre id='line490' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line491")'> 491:         X : array, shape=(N, D) or (D,)</pre>
<pre id='line491' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line492")'> 492:             Input data</pre>
<pre id='line492' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line493")'> 493: </pre>
<pre id='line493' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line494")'> 494:         Returns</pre>
<pre id='line494' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line495")'> 495:         --------</pre>
<pre id='line495' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line496")'> 496: </pre>
<pre id='line496' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line497")'> 497:         Y : array, shape=(N,)</pre>
<pre id='line497' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line498")'> 498:             Predicted values</pre>
<pre id='line498' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line499")'> 499:         """</pre>
<pre id='line499' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line500")'> 500: </pre>
<pre id='line500' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line501")'> 501:         cdef int i, k, N = 0</pre>
<pre id='line501' class='code' style='background-color: #FFFFff'>  __pyx_v_N = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line502")'> 502: </pre>
<pre id='line502' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line503")'> 503:         if len(X.shape) == 1:</pre>
<pre id='line503' class='code' style='background-color: #FFFF8d'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 503; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 503; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = ((__pyx_t_2 == 1) != 0);
  if (__pyx_t_3) {
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line504")'> 504:             X = X.reshape([1, self.D])</pre>
<pre id='line504' class='code' style='background-color: #FFFF4d'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_X, __pyx_t_5);
    __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line505")'> 505:             N = 1</pre>
<pre id='line505' class='code' style='background-color: #FFFFff'>    __pyx_v_N = 1;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line506")'> 506:         else:</pre>
<pre id='line506' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line507")'> 507:             N = X.shape[0]</pre>
<pre id='line507' class='code' style='background-color: #FFFF8d'>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_6 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_N = __pyx_t_6;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line508")'> 508: </pre>
<pre id='line508' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line509")'> 509:         cdef double[:,:] XS = np.zeros([N, self.D])</pre>
<pre id='line509' class='code' style='background-color: #FFFF41'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_4 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_7);
  if (unlikely(!__pyx_t_8.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_XS = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line510")'> 510: </pre>
<pre id='line510' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line511")'> 511:         XS = self.scale_X(X, N, XS)</pre>
<pre id='line511' class='code' style='background-color: #FFFFd4'>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_X);
  if (unlikely(!__pyx_t_9.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_10 = ((struct __pyx_vtabstruct_9econlearn_8tilecode_Tilecode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;scale_X(__pyx_v_self, __pyx_t_9, __pyx_v_N, __pyx_v_XS);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_XS, 1);
  __pyx_v_XS = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line512")'> 512: </pre>
<pre id='line512' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line513")'> 513:         return np.array(self.local_quadratic(XS, N))</pre>
<pre id='line513' class='code' style='background-color: #FFFF62'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_11 = ((struct __pyx_vtabstruct_9econlearn_8tilecode_Tilecode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;local_quadratic(__pyx_v_self, __pyx_v_XS, __pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_t_11, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_r = __pyx_t_7;
  __pyx_t_7 = 0;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line514")'> 514: </pre>
<pre id='line514' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF79' onclick='toggleDiv("line515")'> 515:     cdef double[:] local_quadratic(self, double[:, :] X, int N):</pre>
<pre id='line515' class='code' style='background-color: #FFFF79'>static __Pyx_memviewslice __pyx_f_9econlearn_8tilecode_8Tilecode_local_quadratic(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, __Pyx_memviewslice __pyx_v_X, int __pyx_v_N) {
  __Pyx_memviewslice __pyx_v_neigh_idx = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_neigh_count = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_neigh_key = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_n = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_col = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_k;
  int __pyx_v_pointidx;
  int __pyx_v_dataidx;
  int __pyx_v_idx;
  int __pyx_v_key;
  int __pyx_v_h;
  int __pyx_v_data;
  int __pyx_v_z;
  __Pyx_memviewslice __pyx_v_x = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_weight;
  double __pyx_v_totalcount;
  __Pyx_memviewslice __pyx_v_yhat = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_cols;
  gsl_vector *__pyx_v_S;
  gsl_vector *__pyx_v_beta;
  gsl_matrix *__pyx_v_V;
  gsl_matrix *__pyx_v_Xm;
  gsl_matrix *__pyx_v_XX;
  gsl_vector *__pyx_v_Xy;
  gsl_vector *__pyx_v_y;
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("local_quadratic", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Tilecode.local_quadratic", __pyx_clineno, __pyx_lineno, __pyx_filename);

  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError,"Memoryview return value is not initialized");
  }
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_neigh_idx, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_neigh_count, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_neigh_key, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_n, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_col, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_x, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_yhat, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line516")'> 516: </pre>
<pre id='line516' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line517")'> 517:         cdef int[:] neigh_idx = np.zeros(self.max_neigh, dtype='int32')</pre>
<pre id='line517' class='code' style='background-color: #FFFF3e'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;max_neigh);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_neigh_idx = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line518")'> 518:         cdef int[:] neigh_count = np.zeros(self.max_neigh, dtype='int32')</pre>
<pre id='line518' class='code' style='background-color: #FFFF3e'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;max_neigh);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_2);
  if (unlikely(!__pyx_t_6.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_neigh_count = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line519")'> 519:         cdef int[:] neigh_key = np.zeros(self.N, dtype='int32')</pre>
<pre id='line519' class='code' style='background-color: #FFFF3e'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;N);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_1);
  if (unlikely(!__pyx_t_7.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_neigh_key = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line520")'> 520:         cdef int[:] n = np.zeros(N, dtype='int32')</pre>
<pre id='line520' class='code' style='background-color: #FFFF3e'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_8.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_n = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line521")'> 521:         cdef int[:] col = np.zeros(N, dtype='int32')</pre>
<pre id='line521' class='code' style='background-color: #FFFF3e'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_2);
  if (unlikely(!__pyx_t_9.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_col = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line522")'> 522:         cdef int i, j, k, pointidx, dataidx, idx, key, h, data, z</pre>
<pre id='line522' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line523")'> 523:         cdef double[:] x = np.zeros(self.D + 1)</pre>
<pre id='line523' class='code' style='background-color: #FFFF55'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_self-&gt;D + 1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_2);
  if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_x = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line524")'> 524:         cdef double weight, totalcount = 0</pre>
<pre id='line524' class='code' style='background-color: #FFFFff'>  __pyx_v_totalcount = 0.0;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line525")'> 525:         cdef double[:] yhat = np.zeros(N)</pre>
<pre id='line525' class='code' style='background-color: #FFFF55'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_2);
  if (unlikely(!__pyx_t_11.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_yhat = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line526")'> 526:         cdef int cols = &lt;int&gt; (((self.D + 1)*(self.D + 2)) / 2)</pre>
<pre id='line526' class='code' style='background-color: #FFFFff'>  __pyx_v_cols = ((int)(((double)((__pyx_v_self-&gt;D + 1) * (__pyx_v_self-&gt;D + 2))) / 2.0));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line527")'> 527: </pre>
<pre id='line527' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line528")'> 528:         cdef gsl_vector *S</pre>
<pre id='line528' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line529")'> 529:         cdef gsl_vector *beta</pre>
<pre id='line529' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line530")'> 530:         cdef gsl_matrix *V</pre>
<pre id='line530' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line531")'> 531:         cdef gsl_matrix *Xm</pre>
<pre id='line531' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line532")'> 532:         cdef gsl_matrix *XX</pre>
<pre id='line532' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line533")'> 533:         cdef gsl_vector *Xy</pre>
<pre id='line533' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line534")'> 534:         cdef gsl_vector *y</pre>
<pre id='line534' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line535")'> 535: </pre>
<pre id='line535' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line536")'> 536:         V = gsl_matrix_alloc(cols, cols)</pre>
<pre id='line536' class='code' style='background-color: #FFFFff'>  __pyx_v_V = gsl_matrix_alloc(__pyx_v_cols, __pyx_v_cols);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line537")'> 537:         S = gsl_vector_alloc(cols)</pre>
<pre id='line537' class='code' style='background-color: #FFFFff'>  __pyx_v_S = gsl_vector_alloc(__pyx_v_cols);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line538")'> 538:         beta = gsl_vector_calloc(cols)</pre>
<pre id='line538' class='code' style='background-color: #FFFFff'>  __pyx_v_beta = gsl_vector_calloc(__pyx_v_cols);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line539")'> 539:         Xm = gsl_matrix_calloc(10, cols)</pre>
<pre id='line539' class='code' style='background-color: #FFFFff'>  __pyx_v_Xm = gsl_matrix_calloc(10, __pyx_v_cols);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line540")'> 540:         XX = gsl_matrix_calloc(cols, cols)</pre>
<pre id='line540' class='code' style='background-color: #FFFFff'>  __pyx_v_XX = gsl_matrix_calloc(__pyx_v_cols, __pyx_v_cols);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line541")'> 541:         Xy = gsl_vector_calloc(cols)</pre>
<pre id='line541' class='code' style='background-color: #FFFFff'>  __pyx_v_Xy = gsl_vector_calloc(__pyx_v_cols);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line542")'> 542:         y = gsl_vector_calloc(10)</pre>
<pre id='line542' class='code' style='background-color: #FFFFff'>  __pyx_v_y = gsl_vector_calloc(10);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line543")'> 543: </pre>
<pre id='line543' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line544")'> 544:         for i in range(N): #, nogil=True, num_threads=self.CORES, schedule=static):</pre>
<pre id='line544' class='code' style='background-color: #FFFFff'>  __pyx_t_12 = __pyx_v_N;
  for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
    __pyx_v_i = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line545")'> 545: </pre>
<pre id='line545' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line546")'> 546:             # ==============================</pre>
<pre id='line546' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line547")'> 547:             # Find nearest neighbors</pre>
<pre id='line547' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line548")'> 548:             #===============================</pre>
<pre id='line548' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line549")'> 549: </pre>
<pre id='line549' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line550")'> 550:             totalcount = 0</pre>
<pre id='line550' class='code' style='background-color: #FFFFff'>    __pyx_v_totalcount = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line551")'> 551:             data = 1</pre>
<pre id='line551' class='code' style='background-color: #FFFFff'>    __pyx_v_data = 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line552")'> 552:             for j in range(self.L):</pre>
<pre id='line552' class='code' style='background-color: #FFFFff'>    __pyx_t_14 = __pyx_v_self-&gt;L;
    for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_14; __pyx_t_15+=1) {
      __pyx_v_j = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line553")'> 553:                 idx = getindex(j, i, X, self.D, self.offset, self.flat, self.SIZE, self.dohash, self.mem_max, self.key)</pre>
<pre id='line553' class='code' style='background-color: #FFFFff'>      __pyx_v_idx = __pyx_f_9econlearn_8tilecode_getindex(__pyx_v_j, __pyx_v_i, __pyx_v_X, __pyx_v_self-&gt;D, __pyx_v_self-&gt;offset, __pyx_v_self-&gt;flat, __pyx_v_self-&gt;SIZE, __pyx_v_self-&gt;dohash, __pyx_v_self-&gt;mem_max, __pyx_v_self-&gt;key);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line554")'> 554:                 if self.count[idx] == 0:</pre>
<pre id='line554' class='code' style='background-color: #FFFFff'>      __pyx_t_16 = __pyx_v_idx;
      __pyx_t_17 = (((*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;count.data + __pyx_t_16 * __pyx_v_self-&gt;count.strides[0]) ))) == 0) != 0);
      if (__pyx_t_17) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line555")'> 555:                     data = 0</pre>
<pre id='line555' class='code' style='background-color: #FFFFff'>        __pyx_v_data = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line556")'> 556:                     break</pre>
<pre id='line556' class='code' style='background-color: #FFFFff'>        goto __pyx_L6_break;
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line557")'> 557:                 dataidx = self.datahash[idx]</pre>
<pre id='line557' class='code' style='background-color: #FFFFff'>      __pyx_t_18 = __pyx_v_idx;
      __pyx_v_dataidx = (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;datahash.data + __pyx_t_18 * __pyx_v_self-&gt;datahash.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line558")'> 558:                 totalcount += self.count[idx]</pre>
<pre id='line558' class='code' style='background-color: #FFFFff'>      __pyx_t_19 = __pyx_v_idx;
      __pyx_v_totalcount = (__pyx_v_totalcount + (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;count.data + __pyx_t_19 * __pyx_v_self-&gt;count.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line559")'> 559:                 for k in range(self.count[idx]):</pre>
<pre id='line559' class='code' style='background-color: #FFFFff'>      __pyx_t_20 = __pyx_v_idx;
      __pyx_t_21 = (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;count.data + __pyx_t_20 * __pyx_v_self-&gt;count.strides[0]) )));
      for (__pyx_t_22 = 0; __pyx_t_22 &lt; __pyx_t_21; __pyx_t_22+=1) {
        __pyx_v_k = __pyx_t_22;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line560")'> 560:                     pointidx = self.datastruct[dataidx + k]</pre>
<pre id='line560' class='code' style='background-color: #FFFFff'>        __pyx_t_23 = (__pyx_v_dataidx + __pyx_v_k);
        __pyx_v_pointidx = (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;datastruct.data + __pyx_t_23 * __pyx_v_self-&gt;datastruct.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line561")'> 561:                     key = neigh_key[pointidx]</pre>
<pre id='line561' class='code' style='background-color: #FFFFff'>        __pyx_t_24 = __pyx_v_pointidx;
        __pyx_v_key = (*((int *) ( /* dim=0 */ (__pyx_v_neigh_key.data + __pyx_t_24 * __pyx_v_neigh_key.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line562")'> 562:                     if key == 0:</pre>
<pre id='line562' class='code' style='background-color: #FFFFff'>        __pyx_t_17 = ((__pyx_v_key == 0) != 0);
        if (__pyx_t_17) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line563")'> 563:                         neigh_idx[n[i]] = pointidx</pre>
<pre id='line563' class='code' style='background-color: #FFFFff'>          __pyx_t_25 = __pyx_v_i;
          __pyx_t_26 = (*((int *) ( /* dim=0 */ (__pyx_v_n.data + __pyx_t_25 * __pyx_v_n.strides[0]) )));
          *((int *) ( /* dim=0 */ (__pyx_v_neigh_idx.data + __pyx_t_26 * __pyx_v_neigh_idx.strides[0]) )) = __pyx_v_pointidx;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line564")'> 564:                         neigh_key[pointidx] = n[i]</pre>
<pre id='line564' class='code' style='background-color: #FFFFff'>          __pyx_t_27 = __pyx_v_i;
          __pyx_t_28 = __pyx_v_pointidx;
          *((int *) ( /* dim=0 */ (__pyx_v_neigh_key.data + __pyx_t_28 * __pyx_v_neigh_key.strides[0]) )) = (*((int *) ( /* dim=0 */ (__pyx_v_n.data + __pyx_t_27 * __pyx_v_n.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line565")'> 565:                         neigh_count[n[i]] += 1</pre>
<pre id='line565' class='code' style='background-color: #FFFFff'>          __pyx_t_29 = __pyx_v_i;
          __pyx_t_30 = (*((int *) ( /* dim=0 */ (__pyx_v_n.data + __pyx_t_29 * __pyx_v_n.strides[0]) )));
          *((int *) ( /* dim=0 */ (__pyx_v_neigh_count.data + __pyx_t_30 * __pyx_v_neigh_count.strides[0]) )) += 1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line566")'> 566:                         n[i] += 1</pre>
<pre id='line566' class='code' style='background-color: #FFFFff'>          __pyx_t_31 = __pyx_v_i;
          *((int *) ( /* dim=0 */ (__pyx_v_n.data + __pyx_t_31 * __pyx_v_n.strides[0]) )) += 1;
          goto __pyx_L10;
        }
        /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line567")'> 567:                     else:</pre>
<pre id='line567' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line568")'> 568:                         neigh_count[key] += 1</pre>
<pre id='line568' class='code' style='background-color: #FFFFff'>          __pyx_t_32 = __pyx_v_key;
          *((int *) ( /* dim=0 */ (__pyx_v_neigh_count.data + __pyx_t_32 * __pyx_v_neigh_count.strides[0]) )) += 1;
        }
        __pyx_L10:;
      }
    }
    __pyx_L6_break:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line569")'> 569: </pre>
<pre id='line569' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line570")'> 570:             if n[i] &gt; (2 * cols) and data == 1:</pre>
<pre id='line570' class='code' style='background-color: #FFFFff'>    __pyx_t_14 = __pyx_v_i;
    __pyx_t_17 = (((*((int *) ( /* dim=0 */ (__pyx_v_n.data + __pyx_t_14 * __pyx_v_n.strides[0]) ))) &gt; (2 * __pyx_v_cols)) != 0);
    if (__pyx_t_17) {
      __pyx_t_33 = ((__pyx_v_data == 1) != 0);
      __pyx_t_34 = __pyx_t_33;
    } else {
      __pyx_t_34 = __pyx_t_17;
    }
    if (__pyx_t_34) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line571")'> 571: </pre>
<pre id='line571' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line572")'> 572:                 #==============================================</pre>
<pre id='line572' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line573")'> 573:                 # Fit quadratic by OLS, using the c GSL library</pre>
<pre id='line573' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line574")'> 574:                 #==============================================</pre>
<pre id='line574' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line575")'> 575: </pre>
<pre id='line575' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line576")'> 576:                 #n[i] = &lt;int&gt; c_min(n[i], 1000)</pre>
<pre id='line576' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line577")'> 577: </pre>
<pre id='line577' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line578")'> 578:                 V = gsl_matrix_calloc(cols, cols)</pre>
<pre id='line578' class='code' style='background-color: #FFFFff'>      __pyx_v_V = gsl_matrix_calloc(__pyx_v_cols, __pyx_v_cols);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line579")'> 579:                 S = gsl_vector_calloc(cols)</pre>
<pre id='line579' class='code' style='background-color: #FFFFff'>      __pyx_v_S = gsl_vector_calloc(__pyx_v_cols);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line580")'> 580:                 beta = gsl_vector_calloc(cols)</pre>
<pre id='line580' class='code' style='background-color: #FFFFff'>      __pyx_v_beta = gsl_vector_calloc(__pyx_v_cols);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line581")'> 581:                 Xm = gsl_matrix_calloc(n[i], cols)</pre>
<pre id='line581' class='code' style='background-color: #FFFFff'>      __pyx_t_15 = __pyx_v_i;
      __pyx_v_Xm = gsl_matrix_calloc((*((int *) ( /* dim=0 */ (__pyx_v_n.data + __pyx_t_15 * __pyx_v_n.strides[0]) ))), __pyx_v_cols);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line582")'> 582:                 XX = gsl_matrix_calloc(cols, cols)</pre>
<pre id='line582' class='code' style='background-color: #FFFFff'>      __pyx_v_XX = gsl_matrix_calloc(__pyx_v_cols, __pyx_v_cols);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line583")'> 583:                 Xy = gsl_vector_calloc(cols)</pre>
<pre id='line583' class='code' style='background-color: #FFFFff'>      __pyx_v_Xy = gsl_vector_calloc(__pyx_v_cols);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line584")'> 584:                 y = gsl_vector_calloc(n[i])</pre>
<pre id='line584' class='code' style='background-color: #FFFFff'>      __pyx_t_21 = __pyx_v_i;
      __pyx_v_y = gsl_vector_calloc((*((int *) ( /* dim=0 */ (__pyx_v_n.data + __pyx_t_21 * __pyx_v_n.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line585")'> 585: </pre>
<pre id='line585' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line586")'> 586:                 #NN_counter = gsl_vector_view_array(neigh_count, n[i])</pre>
<pre id='line586' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line587")'> 587:                 #gsl_sort_vector_index(NN_counter.vector)</pre>
<pre id='line587' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line588")'> 588: </pre>
<pre id='line588' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line589")'> 589:                 for h in range(n[i]):</pre>
<pre id='line589' class='code' style='background-color: #FFFFff'>      __pyx_t_22 = __pyx_v_i;
      __pyx_t_35 = (*((int *) ( /* dim=0 */ (__pyx_v_n.data + __pyx_t_22 * __pyx_v_n.strides[0]) )));
      for (__pyx_t_36 = 0; __pyx_t_36 &lt; __pyx_t_35; __pyx_t_36+=1) {
        __pyx_v_h = __pyx_t_36;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line590")'> 590:                     x[0] = 1</pre>
<pre id='line590' class='code' style='background-color: #FFFFff'>        __pyx_t_37 = 0;
        *((double *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_37 * __pyx_v_x.strides[0]) )) = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line591")'> 591:                     weight = (neigh_count[h] * (totalcount**-1)) #** c_max( ((n / 2000)**0.5), 1)</pre>
<pre id='line591' class='code' style='background-color: #FFFFff'>        __pyx_t_38 = __pyx_v_h;
        __pyx_v_weight = ((*((int *) ( /* dim=0 */ (__pyx_v_neigh_count.data + __pyx_t_38 * __pyx_v_neigh_count.strides[0]) ))) * pow(__pyx_v_totalcount, -1.0));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line592")'> 592:                     for k in range(self.D):</pre>
<pre id='line592' class='code' style='background-color: #FFFFff'>        __pyx_t_39 = __pyx_v_self-&gt;D;
        for (__pyx_t_40 = 0; __pyx_t_40 &lt; __pyx_t_39; __pyx_t_40+=1) {
          __pyx_v_k = __pyx_t_40;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line593")'> 593:                         x[k + 1] = ((self.X[neigh_idx[h], k] - self.a[k] ) * self.d[k]) * self.T[k]</pre>
<pre id='line593' class='code' style='background-color: #FFFFff'>          __pyx_t_41 = __pyx_v_h;
          __pyx_t_42 = (*((int *) ( /* dim=0 */ (__pyx_v_neigh_idx.data + __pyx_t_41 * __pyx_v_neigh_idx.strides[0]) )));
          __pyx_t_43 = __pyx_v_k;
          __pyx_t_44 = __pyx_v_k;
          __pyx_t_45 = __pyx_v_k;
          __pyx_t_46 = __pyx_v_k;
          __pyx_t_47 = (__pyx_v_k + 1);
          *((double *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_47 * __pyx_v_x.strides[0]) )) = ((((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;X.data + __pyx_t_42 * __pyx_v_self-&gt;X.strides[0]) ) + __pyx_t_43 * __pyx_v_self-&gt;X.strides[1]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;a.data + __pyx_t_44 * __pyx_v_self-&gt;a.strides[0]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;d.data + __pyx_t_45 * __pyx_v_self-&gt;d.strides[0]) )))) * (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;T.data + __pyx_t_46 * __pyx_v_self-&gt;T.strides[0]) ))));
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line594")'> 594:                     gsl_vector_set(y, h, self.Y[neigh_idx[h]] * weight)</pre>
<pre id='line594' class='code' style='background-color: #FFFFff'>        __pyx_t_39 = __pyx_v_h;
        __pyx_t_40 = (*((int *) ( /* dim=0 */ (__pyx_v_neigh_idx.data + __pyx_t_39 * __pyx_v_neigh_idx.strides[0]) )));
        gsl_vector_set(__pyx_v_y, __pyx_v_h, ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;Y.data + __pyx_t_40 * __pyx_v_self-&gt;Y.strides[0]) ))) * __pyx_v_weight));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line595")'> 595:                     col[i] = 0</pre>
<pre id='line595' class='code' style='background-color: #FFFFff'>        __pyx_t_48 = __pyx_v_i;
        *((int *) ( /* dim=0 */ (__pyx_v_col.data + __pyx_t_48 * __pyx_v_col.strides[0]) )) = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line596")'> 596:                     for k in range(self.D + 1):</pre>
<pre id='line596' class='code' style='background-color: #FFFFff'>        __pyx_t_49 = (__pyx_v_self-&gt;D + 1);
        for (__pyx_t_50 = 0; __pyx_t_50 &lt; __pyx_t_49; __pyx_t_50+=1) {
          __pyx_v_k = __pyx_t_50;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line597")'> 597:                         for z in range(k, self.D + 1):</pre>
<pre id='line597' class='code' style='background-color: #FFFFff'>          __pyx_t_51 = (__pyx_v_self-&gt;D + 1);
          for (__pyx_t_52 = __pyx_v_k; __pyx_t_52 &lt; __pyx_t_51; __pyx_t_52+=1) {
            __pyx_v_z = __pyx_t_52;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line598")'> 598:                             gsl_matrix_set(Xm, h, col[i], x[k] * x[z] * weight)</pre>
<pre id='line598' class='code' style='background-color: #FFFFff'>            __pyx_t_53 = __pyx_v_i;
            __pyx_t_54 = __pyx_v_k;
            __pyx_t_55 = __pyx_v_z;
            gsl_matrix_set(__pyx_v_Xm, __pyx_v_h, (*((int *) ( /* dim=0 */ (__pyx_v_col.data + __pyx_t_53 * __pyx_v_col.strides[0]) ))), (((*((double *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_54 * __pyx_v_x.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_55 * __pyx_v_x.strides[0]) )))) * __pyx_v_weight));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line599")'> 599:                             col[i] += 1</pre>
<pre id='line599' class='code' style='background-color: #FFFFff'>            __pyx_t_56 = __pyx_v_i;
            *((int *) ( /* dim=0 */ (__pyx_v_col.data + __pyx_t_56 * __pyx_v_col.strides[0]) )) += 1;
          }
        }
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line600")'> 600: </pre>
<pre id='line600' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line601")'> 601:                 gsl_blas_dgemm(CblasTrans, CblasNoTrans, 1.0, Xm, Xm, 0, XX)</pre>
<pre id='line601' class='code' style='background-color: #FFFFff'>      gsl_blas_dgemm(CblasTrans, CblasNoTrans, 1.0, __pyx_v_Xm, __pyx_v_Xm, 0.0, __pyx_v_XX);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line602")'> 602:                 gsl_blas_dgemv(CblasTrans, 1.0, Xm, y, 0, Xy)</pre>
<pre id='line602' class='code' style='background-color: #FFFFff'>      gsl_blas_dgemv(CblasTrans, 1.0, __pyx_v_Xm, __pyx_v_y, 0.0, __pyx_v_Xy);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line603")'> 603: </pre>
<pre id='line603' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line604")'> 604:                 gsl_linalg_cholesky_decomp(XX)</pre>
<pre id='line604' class='code' style='background-color: #FFFFff'>      gsl_linalg_cholesky_decomp(__pyx_v_XX);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line605")'> 605:                 gsl_linalg_cholesky_solve(XX, Xy, beta)</pre>
<pre id='line605' class='code' style='background-color: #FFFFff'>      gsl_linalg_cholesky_solve(__pyx_v_XX, __pyx_v_Xy, __pyx_v_beta);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line606")'> 606: </pre>
<pre id='line606' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line607")'> 607:                 #gsl_linalg_SV_decomp_jacobi(Xm, V, S)</pre>
<pre id='line607' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line608")'> 608:                 #gsl_linalg_SV_solve(Xm, V, S, y, beta)</pre>
<pre id='line608' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line609")'> 609: </pre>
<pre id='line609' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line610")'> 610:                 #for h in range(cols):</pre>
<pre id='line610' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line611")'> 611:                 #    print 'Beta: ' + str(gsl_vector_get(beta, h))</pre>
<pre id='line611' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line612")'> 612: </pre>
<pre id='line612' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line613")'> 613:                 # =========================================</pre>
<pre id='line613' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line614")'> 614:                 # Evaluate quadratic</pre>
<pre id='line614' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line615")'> 615:                 # =========================================</pre>
<pre id='line615' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line616")'> 616: </pre>
<pre id='line616' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line617")'> 617:                 x[0] = 1</pre>
<pre id='line617' class='code' style='background-color: #FFFFff'>      __pyx_t_57 = 0;
      *((double *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_57 * __pyx_v_x.strides[0]) )) = 1.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line618")'> 618:                 for k in range(self.D):</pre>
<pre id='line618' class='code' style='background-color: #FFFFff'>      __pyx_t_35 = __pyx_v_self-&gt;D;
      for (__pyx_t_36 = 0; __pyx_t_36 &lt; __pyx_t_35; __pyx_t_36+=1) {
        __pyx_v_k = __pyx_t_36;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line619")'> 619:                     x[k + 1] = X[i, k]</pre>
<pre id='line619' class='code' style='background-color: #FFFFff'>        __pyx_t_50 = __pyx_v_i;
        __pyx_t_52 = __pyx_v_k;
        __pyx_t_49 = (__pyx_v_k + 1);
        *((double *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_49 * __pyx_v_x.strides[0]) )) = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_X.data + __pyx_t_50 * __pyx_v_X.strides[0]) ) + __pyx_t_52 * __pyx_v_X.strides[1]) )));
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line620")'> 620: </pre>
<pre id='line620' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line621")'> 621:                 col[i] = 0</pre>
<pre id='line621' class='code' style='background-color: #FFFFff'>      __pyx_t_35 = __pyx_v_i;
      *((int *) ( /* dim=0 */ (__pyx_v_col.data + __pyx_t_35 * __pyx_v_col.strides[0]) )) = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line622")'> 622:                 for k in range(self.D + 1):</pre>
<pre id='line622' class='code' style='background-color: #FFFFff'>      __pyx_t_51 = (__pyx_v_self-&gt;D + 1);
      for (__pyx_t_36 = 0; __pyx_t_36 &lt; __pyx_t_51; __pyx_t_36+=1) {
        __pyx_v_k = __pyx_t_36;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line623")'> 623:                     for z in range(k, self.D + 1):</pre>
<pre id='line623' class='code' style='background-color: #FFFFff'>        __pyx_t_58 = (__pyx_v_self-&gt;D + 1);
        for (__pyx_t_59 = __pyx_v_k; __pyx_t_59 &lt; __pyx_t_58; __pyx_t_59+=1) {
          __pyx_v_z = __pyx_t_59;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line624")'> 624:                         yhat[i] += gsl_vector_get(beta, col[i]) * x[k] * x[z]</pre>
<pre id='line624' class='code' style='background-color: #FFFFff'>          __pyx_t_60 = __pyx_v_i;
          __pyx_t_61 = __pyx_v_k;
          __pyx_t_62 = __pyx_v_z;
          __pyx_t_63 = __pyx_v_i;
          *((double *) ( /* dim=0 */ (__pyx_v_yhat.data + __pyx_t_63 * __pyx_v_yhat.strides[0]) )) += ((gsl_vector_get(__pyx_v_beta, (*((int *) ( /* dim=0 */ (__pyx_v_col.data + __pyx_t_60 * __pyx_v_col.strides[0]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_61 * __pyx_v_x.strides[0]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_x.data + __pyx_t_62 * __pyx_v_x.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line625")'> 625:                         col[i] += 1</pre>
<pre id='line625' class='code' style='background-color: #FFFFff'>          __pyx_t_64 = __pyx_v_i;
          *((int *) ( /* dim=0 */ (__pyx_v_col.data + __pyx_t_64 * __pyx_v_col.strides[0]) )) += 1;
        }
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line626")'> 626: </pre>
<pre id='line626' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line627")'> 627:                 # ========================================</pre>
<pre id='line627' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line628")'> 628:                 # zero for next iteration</pre>
<pre id='line628' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line629")'> 629:                 # ========================================</pre>
<pre id='line629' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line630")'> 630: </pre>
<pre id='line630' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line631")'> 631:                 for j in range(self.max_neigh):</pre>
<pre id='line631' class='code' style='background-color: #FFFFff'>      __pyx_t_36 = __pyx_v_self-&gt;max_neigh;
      for (__pyx_t_59 = 0; __pyx_t_59 &lt; __pyx_t_36; __pyx_t_59+=1) {
        __pyx_v_j = __pyx_t_59;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line632")'> 632:                     neigh_idx[j] = 0</pre>
<pre id='line632' class='code' style='background-color: #FFFFff'>        __pyx_t_65 = __pyx_v_j;
        *((int *) ( /* dim=0 */ (__pyx_v_neigh_idx.data + __pyx_t_65 * __pyx_v_neigh_idx.strides[0]) )) = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line633")'> 633:                     neigh_count[j] = 0</pre>
<pre id='line633' class='code' style='background-color: #FFFFff'>        __pyx_t_66 = __pyx_v_j;
        *((int *) ( /* dim=0 */ (__pyx_v_neigh_count.data + __pyx_t_66 * __pyx_v_neigh_count.strides[0]) )) = 0;
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line634")'> 634: </pre>
<pre id='line634' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line635")'> 635:                 for j in range(self.N):</pre>
<pre id='line635' class='code' style='background-color: #FFFFff'>      __pyx_t_36 = __pyx_v_self-&gt;N;
      for (__pyx_t_59 = 0; __pyx_t_59 &lt; __pyx_t_36; __pyx_t_59+=1) {
        __pyx_v_j = __pyx_t_59;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line636")'> 636:                     neigh_key[j] = 0</pre>
<pre id='line636' class='code' style='background-color: #FFFFff'>        __pyx_t_67 = __pyx_v_j;
        *((int *) ( /* dim=0 */ (__pyx_v_neigh_key.data + __pyx_t_67 * __pyx_v_neigh_key.strides[0]) )) = 0;
      }
      goto __pyx_L11;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line637")'> 637:             else:</pre>
<pre id='line637' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line638")'> 638:                 yhat[i] = 0</pre>
<pre id='line638' class='code' style='background-color: #FFFFff'>      __pyx_t_36 = __pyx_v_i;
      *((double *) ( /* dim=0 */ (__pyx_v_yhat.data + __pyx_t_36 * __pyx_v_yhat.strides[0]) )) = 0.0;
    }
    __pyx_L11:;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line639")'> 639:         else:</pre>
<pre id='line639' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line640")'> 640:             yhat[i] = 0</pre>
<pre id='line640' class='code' style='background-color: #FFFFff'>    __pyx_t_13 = __pyx_v_i;
    *((double *) ( /* dim=0 */ (__pyx_v_yhat.data + __pyx_t_13 * __pyx_v_yhat.strides[0]) )) = 0.0;
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line641")'> 641: </pre>
<pre id='line641' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line642")'> 642:         gsl_vector_free(beta)</pre>
<pre id='line642' class='code' style='background-color: #FFFFff'>  gsl_vector_free(__pyx_v_beta);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line643")'> 643:         gsl_vector_free(S)</pre>
<pre id='line643' class='code' style='background-color: #FFFFff'>  gsl_vector_free(__pyx_v_S);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line644")'> 644:         gsl_matrix_free(V)</pre>
<pre id='line644' class='code' style='background-color: #FFFFff'>  gsl_matrix_free(__pyx_v_V);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line645")'> 645:         gsl_matrix_free(Xm)</pre>
<pre id='line645' class='code' style='background-color: #FFFFff'>  gsl_matrix_free(__pyx_v_Xm);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line646")'> 646:         gsl_matrix_free(XX)</pre>
<pre id='line646' class='code' style='background-color: #FFFFff'>  gsl_matrix_free(__pyx_v_XX);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line647")'> 647:         gsl_vector_free(Xy)</pre>
<pre id='line647' class='code' style='background-color: #FFFFff'>  gsl_vector_free(__pyx_v_Xy);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line648")'> 648:         gsl_vector_free(y)</pre>
<pre id='line648' class='code' style='background-color: #FFFFff'>  gsl_vector_free(__pyx_v_y);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line649")'> 649: </pre>
<pre id='line649' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line650")'> 650:         return yhat</pre>
<pre id='line650' class='code' style='background-color: #FFFFff'>  __PYX_INC_MEMVIEW(&amp;__pyx_v_yhat, 0);
  __pyx_r = __pyx_v_yhat;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line651")'> 651: </pre>
<pre id='line651' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line652")'> 652:     cpdef partial_fit(self, double[:] Y, int copy):</pre>
<pre id='line652' class='code' style='background-color: #FFFF23'>static PyObject *__pyx_pw_9econlearn_8tilecode_8Tilecode_9partial_fit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_9econlearn_8tilecode_8Tilecode_partial_fit(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, __Pyx_memviewslice __pyx_v_Y, int __pyx_v_copy, int __pyx_skip_dispatch) {
  int __pyx_v_i;
  int __pyx_v_k;
  int __pyx_v_pointidx;
  int __pyx_v_dataidx;
  int __pyx_v_idx;
  int __pyx_v_t;
  double __pyx_v_n;
  double __pyx_v_y;
  double __pyx_v_error;
  double __pyx_v_alpha;
  double __pyx_v_power;
  int __pyx_v_j;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("partial_fit", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_partial_fit);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_9econlearn_8tilecode_8Tilecode_9partial_fit)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_Y, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_copy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      __pyx_t_2 = 0;
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_r = __pyx_t_3;
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_33, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Tilecode.partial_fit", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_9econlearn_8tilecode_8Tilecode_9partial_fit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_9econlearn_8tilecode_8Tilecode_9partial_fit(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_Y = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_copy;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("partial_fit (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_Y,&amp;__pyx_n_s_copy,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Y)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_copy)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("partial_fit", 1, 2, 2, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "partial_fit") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_Y = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[0]);<span class='error_goto'> if (unlikely(!__pyx_v_Y.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_copy = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_copy == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("partial_fit", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Tilecode.partial_fit", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9econlearn_8tilecode_8Tilecode_8partial_fit(((struct __pyx_obj_9econlearn_8tilecode_Tilecode *)__pyx_v_self), __pyx_v_Y, __pyx_v_copy);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9econlearn_8tilecode_8Tilecode_8partial_fit(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, __Pyx_memviewslice __pyx_v_Y, int __pyx_v_copy) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("partial_fit", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_9econlearn_8tilecode_Tilecode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;partial_fit(__pyx_v_self, __pyx_v_Y, __pyx_v_copy, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Tilecode.partial_fit", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Y, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line653")'> 653: </pre>
<pre id='line653' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line654")'> 654:         cdef int i, k, pointidx, dataidx, idx, t = 0</pre>
<pre id='line654' class='code' style='background-color: #FFFFff'>  __pyx_v_t = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line655")'> 655:         cdef double n, new_w</pre>
<pre id='line655' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line656")'> 656:         cdef double y, error, alpha, power = (2.0/3.0)*-1</pre>
<pre id='line656' class='code' style='background-color: #FFFFff'>  __pyx_v_power = ((2.0 / 3.0) * -1.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line657")'> 657: </pre>
<pre id='line657' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line658")'> 658:         # Fit by averaging (assuming we have data structure)</pre>
<pre id='line658' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line659")'> 659:         for i in prange(self.mem_max, nogil=True, num_threads=self.CORES, schedule=guided):</pre>
<pre id='line659' class='code' style='background-color: #FFFFff'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
        __pyx_t_5 = __pyx_v_self-&gt;mem_max;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_7 = (__pyx_t_5 - 0) / 1;
            if (__pyx_t_7 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_dataidx) lastprivate(__pyx_v_k) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_pointidx) lastprivate(__pyx_v_n)        __pyx_t_5 = __pyx_v_self-&gt;mem_max;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_7 = (__pyx_t_5 - 0) / 1;
            if (__pyx_t_7 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_dataidx) lastprivate(__pyx_v_k) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_pointidx) lastprivate(__pyx_v_n) num_threads(__pyx_v_self-&gt;CORES)
                    #endif /* _OPENMP */
                    for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_7; __pyx_t_6++){
                        {
                            __pyx_v_i = 0 + 1 * __pyx_t_6;
                            /* Initialize private variables to invalid values */
                            __pyx_v_dataidx = ((int)0xbad0bad0);
                            __pyx_v_k = ((int)0xbad0bad0);
                            __pyx_v_pointidx = ((int)0xbad0bad0);
                            __pyx_v_n = ((double)__PYX_NAN());
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line660")'> 660:             dataidx = self.datahash[i]</pre>
<pre id='line660' class='code' style='background-color: #FFFFff'>                            __pyx_t_8 = __pyx_v_i;
                            __pyx_v_dataidx = (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;datahash.data + __pyx_t_8 * __pyx_v_self-&gt;datahash.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line661")'> 661:             self.w[i] = 0</pre>
<pre id='line661' class='code' style='background-color: #FFFFff'>                            __pyx_t_9 = __pyx_v_i;
                            *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;w.data + __pyx_t_9 * __pyx_v_self-&gt;w.strides[0]) )) = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line662")'> 662:             for k in range(self.count[i]):</pre>
<pre id='line662' class='code' style='background-color: #FFFFff'>                            __pyx_t_10 = __pyx_v_i;
                            __pyx_t_11 = (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;count.data + __pyx_t_10 * __pyx_v_self-&gt;count.strides[0]) )));
                            for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
                              __pyx_v_k = __pyx_t_12;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line663")'> 663:                 pointidx = self.datastruct[dataidx + k]</pre>
<pre id='line663' class='code' style='background-color: #FFFFff'>                              __pyx_t_13 = (__pyx_v_dataidx + __pyx_v_k);
                              __pyx_v_pointidx = (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;datastruct.data + __pyx_t_13 * __pyx_v_self-&gt;datastruct.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line664")'> 664:                 self.w[i] += Y[pointidx]</pre>
<pre id='line664' class='code' style='background-color: #FFFFff'>                              __pyx_t_14 = __pyx_v_pointidx;
                              __pyx_t_15 = __pyx_v_i;
                              *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;w.data + __pyx_t_15 * __pyx_v_self-&gt;w.strides[0]) )) += (*((double *) ( /* dim=0 */ (__pyx_v_Y.data + __pyx_t_14 * __pyx_v_Y.strides[0]) )));
                            }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line665")'> 665:             n = self.count[i]</pre>
<pre id='line665' class='code' style='background-color: #FFFFff'>                            __pyx_t_11 = __pyx_v_i;
                            __pyx_v_n = (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;count.data + __pyx_t_11 * __pyx_v_self-&gt;count.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line666")'> 666:             self.w[i] = self.w[i] * (n**-1)</pre>
<pre id='line666' class='code' style='background-color: #FFFFff'>                            __pyx_t_12 = __pyx_v_i;
                            __pyx_t_16 = __pyx_v_i;
                            *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;w.data + __pyx_t_16 * __pyx_v_self-&gt;w.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;w.data + __pyx_t_12 * __pyx_v_self-&gt;w.strides[0]) ))) * pow(__pyx_v_n, -1.0));
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line667")'> 667: </pre>
<pre id='line667' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line668")'> 668:         # Store Y values</pre>
<pre id='line668' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line669")'> 669:         if copy == 1:</pre>
<pre id='line669' class='code' style='background-color: #FFFFff'>  __pyx_t_17 = ((__pyx_v_copy == 1) != 0);
  if (__pyx_t_17) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line670")'> 670:             for i in range(self.N):</pre>
<pre id='line670' class='code' style='background-color: #FFFFff'>    __pyx_t_7 = __pyx_v_self-&gt;N;
    for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_7; __pyx_t_6+=1) {
      __pyx_v_i = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line671")'> 671:                 self.Y[i] = Y[i]</pre>
<pre id='line671' class='code' style='background-color: #FFFFff'>      __pyx_t_5 = __pyx_v_i;
      __pyx_t_18 = __pyx_v_i;
      *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;Y.data + __pyx_t_18 * __pyx_v_self-&gt;Y.strides[0]) )) = (*((double *) ( /* dim=0 */ (__pyx_v_Y.data + __pyx_t_5 * __pyx_v_Y.strides[0]) )));
    }
    goto __pyx_L14;
  }
  __pyx_L14:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line672")'> 672: </pre>
<pre id='line672' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line673")'> 673:         # Fit by SGD / ASGD (assuming we have - reverse data structure)</pre>
<pre id='line673' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line674")'> 674:         if self.sgd == 1:</pre>
<pre id='line674' class='code' style='background-color: #FFFFff'>  __pyx_t_17 = ((__pyx_v_self-&gt;sgd == 1) != 0);
  if (__pyx_t_17) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line675")'> 675:             for i in range(self.N):</pre>
<pre id='line675' class='code' style='background-color: #FFFFff'>    __pyx_t_7 = __pyx_v_self-&gt;N;
    for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_7; __pyx_t_6+=1) {
      __pyx_v_i = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line676")'> 676:                 if self.extrap[i] == 0:</pre>
<pre id='line676' class='code' style='background-color: #FFFFff'>      __pyx_t_19 = __pyx_v_i;
      __pyx_t_17 = (((*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;extrap.data + __pyx_t_19 * __pyx_v_self-&gt;extrap.strides[0]) ))) == 0) != 0);
      if (__pyx_t_17) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line677")'> 677:                     t += 1</pre>
<pre id='line677' class='code' style='background-color: #FFFFff'>        __pyx_v_t = (__pyx_v_t + 1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line678")'> 678:                     alpha =  self.eta * (1 +  self.eta * self.scale * t)**power</pre>
<pre id='line678' class='code' style='background-color: #FFFFff'>        __pyx_v_alpha = (__pyx_v_self-&gt;eta * pow((1.0 + ((__pyx_v_self-&gt;eta * __pyx_v_self-&gt;scale) * __pyx_v_t)), __pyx_v_power));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line679")'> 679:                     y = 0</pre>
<pre id='line679' class='code' style='background-color: #FFFFff'>        __pyx_v_y = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line680")'> 680:                     for j in range(self.L):</pre>
<pre id='line680' class='code' style='background-color: #FFFFff'>        __pyx_t_20 = __pyx_v_self-&gt;L;
        for (__pyx_t_21 = 0; __pyx_t_21 &lt; __pyx_t_20; __pyx_t_21+=1) {
          __pyx_v_j = __pyx_t_21;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line681")'> 681:                         idx = self.datastruct_reverse[i, j]</pre>
<pre id='line681' class='code' style='background-color: #FFFFff'>          __pyx_t_22 = __pyx_v_i;
          __pyx_t_23 = __pyx_v_j;
          __pyx_v_idx = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;datastruct_reverse.data + __pyx_t_22 * __pyx_v_self-&gt;datastruct_reverse.strides[0]) ) + __pyx_t_23 * __pyx_v_self-&gt;datastruct_reverse.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line682")'> 682:                         y += self.w[idx]</pre>
<pre id='line682' class='code' style='background-color: #FFFFff'>          __pyx_t_24 = __pyx_v_idx;
          __pyx_v_y = (__pyx_v_y + (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;w.data + __pyx_t_24 * __pyx_v_self-&gt;w.strides[0]) ))));
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line683")'> 683:                     y =  y * self.Linv</pre>
<pre id='line683' class='code' style='background-color: #FFFFff'>        __pyx_v_y = (__pyx_v_y * __pyx_v_self-&gt;Linv);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line684")'> 684: </pre>
<pre id='line684' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line685")'> 685:                     error = (Y[i] - y) * self.Linv</pre>
<pre id='line685' class='code' style='background-color: #FFFFff'>        __pyx_t_20 = __pyx_v_i;
        __pyx_v_error = (((*((double *) ( /* dim=0 */ (__pyx_v_Y.data + __pyx_t_20 * __pyx_v_Y.strides[0]) ))) - __pyx_v_y) * __pyx_v_self-&gt;Linv);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line686")'> 686: </pre>
<pre id='line686' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line687")'> 687:                     for j in range(self.L):</pre>
<pre id='line687' class='code' style='background-color: #FFFFff'>        __pyx_t_21 = __pyx_v_self-&gt;L;
        for (__pyx_t_25 = 0; __pyx_t_25 &lt; __pyx_t_21; __pyx_t_25+=1) {
          __pyx_v_j = __pyx_t_25;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line688")'> 688:                         idx = self.datastruct_reverse[i, j]</pre>
<pre id='line688' class='code' style='background-color: #FFFFff'>          __pyx_t_26 = __pyx_v_i;
          __pyx_t_27 = __pyx_v_j;
          __pyx_v_idx = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;datastruct_reverse.data + __pyx_t_26 * __pyx_v_self-&gt;datastruct_reverse.strides[0]) ) + __pyx_t_27 * __pyx_v_self-&gt;datastruct_reverse.strides[1]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line689")'> 689:                         self.w[idx] += error * alpha</pre>
<pre id='line689' class='code' style='background-color: #FFFFff'>          __pyx_t_28 = __pyx_v_idx;
          *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;w.data + __pyx_t_28 * __pyx_v_self-&gt;w.strides[0]) )) += (__pyx_v_error * __pyx_v_alpha);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line690")'> 690:                         self.wav[idx] += self.w[idx]</pre>
<pre id='line690' class='code' style='background-color: #FFFFff'>          __pyx_t_29 = __pyx_v_idx;
          __pyx_t_30 = __pyx_v_idx;
          *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;wav.data + __pyx_t_30 * __pyx_v_self-&gt;wav.strides[0]) )) += (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;w.data + __pyx_t_29 * __pyx_v_self-&gt;w.strides[0]) )));
        }
        goto __pyx_L20;
      }
      __pyx_L20:;
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line691")'> 691:             if self.asgd == 1:</pre>
<pre id='line691' class='code' style='background-color: #FFFFff'>    __pyx_t_17 = ((__pyx_v_self-&gt;asgd == 1) != 0);
    if (__pyx_t_17) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line692")'> 692:                 for i in prange(self.mem_max, nogil=True, num_threads=self.CORES, schedule=guided):</pre>
<pre id='line692' class='code' style='background-color: #FFFFff'>      {
          #ifdef WITH_THREAD
          PyThreadState *_save;
          Py_UNBLOCK_THREADS
          #endif
          /*try:*/ {
            __pyx_t_7 = __pyx_v_self-&gt;mem_max;
            if (1 == 0) abort();
            {
                #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                    #undef likely
                    #undef unlikely
                    #define likely(x)   (x)
                    #define unlikely(x) (x)
                #endif
                __pyx_t_21 = (__pyx_t_7 - 0) / 1;
                if (__pyx_t_21 &gt; 0)
                {
                    #ifdef _OPENMP
                    #pragma omp parallel
                    #endif /* _OPENMP */
                    {
                        #ifdef _OPENMP
                        #pragma omp for lastprivate(__pyx_v_n) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i)            __pyx_t_7 = __pyx_v_self-&gt;mem_max;
            if (1 == 0) abort();
            {
                #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                    #undef likely
                    #undef unlikely
                    #define likely(x)   (x)
                    #define unlikely(x) (x)
                #endif
                __pyx_t_21 = (__pyx_t_7 - 0) / 1;
                if (__pyx_t_21 &gt; 0)
                {
                    #ifdef _OPENMP
                    #pragma omp parallel
                    #endif /* _OPENMP */
                    {
                        #ifdef _OPENMP
                        #pragma omp for lastprivate(__pyx_v_n) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) num_threads(__pyx_v_self-&gt;CORES)
                        #endif /* _OPENMP */
                        for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_21; __pyx_t_6++){
                            {
                                __pyx_v_i = 0 + 1 * __pyx_t_6;
                                /* Initialize private variables to invalid values */
                                __pyx_v_n = ((double)__PYX_NAN());
/* … */
          /*finally:*/ {
            /*normal exit:*/{
              #ifdef WITH_THREAD
              Py_BLOCK_THREADS
              #endif
              goto __pyx_L28;
            }
            __pyx_L28:;
          }
      }
      goto __pyx_L25;
    }
    __pyx_L25:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line693")'> 693:                     n = self.count[i]</pre>
<pre id='line693' class='code' style='background-color: #FFFFff'>                                __pyx_t_25 = __pyx_v_i;
                                __pyx_v_n = (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;count.data + __pyx_t_25 * __pyx_v_self-&gt;count.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line694")'> 694:                     self.w[i] = self.wav[i] * (n**-1)</pre>
<pre id='line694' class='code' style='background-color: #FFFFff'>                                __pyx_t_31 = __pyx_v_i;
                                __pyx_t_32 = __pyx_v_i;
                                *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;w.data + __pyx_t_32 * __pyx_v_self-&gt;w.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;wav.data + __pyx_t_31 * __pyx_v_self-&gt;wav.strides[0]) ))) * pow(__pyx_v_n, -1.0));
                            }
                        }
                    }
                }
            }
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   __builtin_expect(!!(x), 1)
                #define unlikely(x) __builtin_expect(!!(x), 0)
            #endif
          }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line695")'> 695: </pre>
<pre id='line695' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line696")'> 696:             self.wav = np.zeros([self.mem_max])</pre>
<pre id='line696' class='code' style='background-color: #FFFF46'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;mem_max);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_33 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_4);
    if (unlikely(!__pyx_t_33.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 696; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;wav, 0);
    __pyx_v_self-&gt;wav = __pyx_t_33;
    __pyx_t_33.memview = NULL;
    __pyx_t_33.data = NULL;
    goto __pyx_L17;
  }
  __pyx_L17:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line697")'> 697: </pre>
<pre id='line697' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line698")'> 698:     cdef void fit_sgd(self, double[:,:] X, double[:] Y, double eta, double scale, int n_iters, int ASGD):</pre>
<pre id='line698' class='code' style='background-color: #FFFFff'>static void __pyx_f_9econlearn_8tilecode_8Tilecode_fit_sgd(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, __Pyx_memviewslice __pyx_v_X, __Pyx_memviewslice __pyx_v_Y, double __pyx_v_eta, double __pyx_v_scale, int __pyx_v_n_iters, int __pyx_v_ASGD) {
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_t;
  CYTHON_UNUSED int __pyx_v_it;
  __Pyx_memviewslice __pyx_v_idx = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_y;
  double __pyx_v_alpha;
  double __pyx_v_error;
  double __pyx_v_n;
  double __pyx_v_power;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fit_sgd", 0);
/* … */
  /* function exit code */
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_idx, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line699")'> 699: </pre>
<pre id='line699' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line700")'> 700:         cdef int i, j, k, t, it = 0</pre>
<pre id='line700' class='code' style='background-color: #FFFFff'>  __pyx_v_it = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line701")'> 701:         cdef int[:] idx = self.tempidx</pre>
<pre id='line701' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_self-&gt;tempidx;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_idx = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line702")'> 702:         cdef double Yhat</pre>
<pre id='line702' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line703")'> 703:         cdef double y</pre>
<pre id='line703' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line704")'> 704:         cdef double alpha = 0</pre>
<pre id='line704' class='code' style='background-color: #FFFFff'>  __pyx_v_alpha = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line705")'> 705:         cdef double error = 0</pre>
<pre id='line705' class='code' style='background-color: #FFFFff'>  __pyx_v_error = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line706")'> 706:         cdef double n = 0</pre>
<pre id='line706' class='code' style='background-color: #FFFFff'>  __pyx_v_n = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line707")'> 707:         cdef double power = (2.0/3.0)</pre>
<pre id='line707' class='code' style='background-color: #FFFFff'>  __pyx_v_power = (2.0 / 3.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line708")'> 708: </pre>
<pre id='line708' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line709")'> 709:         for it in range(n_iters):</pre>
<pre id='line709' class='code' style='background-color: #FFFFff'>  __pyx_t_2 = __pyx_v_n_iters;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_it = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line710")'> 710:             t = 0</pre>
<pre id='line710' class='code' style='background-color: #FFFFff'>    __pyx_v_t = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line711")'> 711:             for i in range(self.N):</pre>
<pre id='line711' class='code' style='background-color: #FFFFff'>    __pyx_t_4 = __pyx_v_self-&gt;N;
    for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
      __pyx_v_i = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line712")'> 712:                 if self.extrap[i] == 0:</pre>
<pre id='line712' class='code' style='background-color: #FFFFff'>      __pyx_t_6 = __pyx_v_i;
      __pyx_t_7 = (((*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;extrap.data + __pyx_t_6 * __pyx_v_self-&gt;extrap.strides[0]) ))) == 0) != 0);
      if (__pyx_t_7) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line713")'> 713:                     t += 1</pre>
<pre id='line713' class='code' style='background-color: #FFFFff'>        __pyx_v_t = (__pyx_v_t + 1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line714")'> 714:                     alpha =  eta * (((1 +  eta * scale * t)**power)**-1)</pre>
<pre id='line714' class='code' style='background-color: #FFFFff'>        __pyx_v_alpha = (__pyx_v_eta * pow(pow((1.0 + ((__pyx_v_eta * __pyx_v_scale) * __pyx_v_t)), __pyx_v_power), -1.0));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line715")'> 715: </pre>
<pre id='line715' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line716")'> 716:                     # predict yhat</pre>
<pre id='line716' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line717")'> 717:                     y = 0</pre>
<pre id='line717' class='code' style='background-color: #FFFFff'>        __pyx_v_y = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line718")'> 718:                     for j in range(self.L):</pre>
<pre id='line718' class='code' style='background-color: #FFFFff'>        __pyx_t_8 = __pyx_v_self-&gt;L;
        for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
          __pyx_v_j = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line719")'> 719:                         idx[j] = getindex(j, i, X, self.D, self.offset, self.flat, self.SIZE, self.dohash, self.mem_max, self.key)</pre>
<pre id='line719' class='code' style='background-color: #FFFFff'>          __pyx_t_10 = __pyx_v_j;
          *((int *) ( /* dim=0 */ (__pyx_v_idx.data + __pyx_t_10 * __pyx_v_idx.strides[0]) )) = __pyx_f_9econlearn_8tilecode_getindex(__pyx_v_j, __pyx_v_i, __pyx_v_X, __pyx_v_self-&gt;D, __pyx_v_self-&gt;offset, __pyx_v_self-&gt;flat, __pyx_v_self-&gt;SIZE, __pyx_v_self-&gt;dohash, __pyx_v_self-&gt;mem_max, __pyx_v_self-&gt;key);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line720")'> 720:                         y += self.w[idx[j]]</pre>
<pre id='line720' class='code' style='background-color: #FFFFff'>          __pyx_t_11 = __pyx_v_j;
          __pyx_t_12 = (*((int *) ( /* dim=0 */ (__pyx_v_idx.data + __pyx_t_11 * __pyx_v_idx.strides[0]) )));
          __pyx_v_y = (__pyx_v_y + (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;w.data + __pyx_t_12 * __pyx_v_self-&gt;w.strides[0]) ))));
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line721")'> 721:                     y =  y * self.Linv</pre>
<pre id='line721' class='code' style='background-color: #FFFFff'>        __pyx_v_y = (__pyx_v_y * __pyx_v_self-&gt;Linv);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line722")'> 722: </pre>
<pre id='line722' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line723")'> 723:                     # compute error</pre>
<pre id='line723' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line724")'> 724:                     error = (Y[i] - y) * self.Linv</pre>
<pre id='line724' class='code' style='background-color: #FFFFff'>        __pyx_t_8 = __pyx_v_i;
        __pyx_v_error = (((*((double *) ( /* dim=0 */ (__pyx_v_Y.data + __pyx_t_8 * __pyx_v_Y.strides[0]) ))) - __pyx_v_y) * __pyx_v_self-&gt;Linv);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line725")'> 725: </pre>
<pre id='line725' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line726")'> 726:                     for j in range(self.L):</pre>
<pre id='line726' class='code' style='background-color: #FFFFff'>        __pyx_t_9 = __pyx_v_self-&gt;L;
        for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_9; __pyx_t_13+=1) {
          __pyx_v_j = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line727")'> 727:                         self.w[idx[j]] += error * alpha</pre>
<pre id='line727' class='code' style='background-color: #FFFFff'>          __pyx_t_14 = __pyx_v_j;
          __pyx_t_15 = (*((int *) ( /* dim=0 */ (__pyx_v_idx.data + __pyx_t_14 * __pyx_v_idx.strides[0]) )));
          *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;w.data + __pyx_t_15 * __pyx_v_self-&gt;w.strides[0]) )) += (__pyx_v_error * __pyx_v_alpha);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line728")'> 728:                         self.wav[idx[j]] += self.w[idx[j]]</pre>
<pre id='line728' class='code' style='background-color: #FFFFff'>          __pyx_t_16 = __pyx_v_j;
          __pyx_t_17 = (*((int *) ( /* dim=0 */ (__pyx_v_idx.data + __pyx_t_16 * __pyx_v_idx.strides[0]) )));
          __pyx_t_18 = __pyx_v_j;
          __pyx_t_19 = (*((int *) ( /* dim=0 */ (__pyx_v_idx.data + __pyx_t_18 * __pyx_v_idx.strides[0]) )));
          *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;wav.data + __pyx_t_19 * __pyx_v_self-&gt;wav.strides[0]) )) += (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;w.data + __pyx_t_17 * __pyx_v_self-&gt;w.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line729")'> 729:                         idx[j] = 0</pre>
<pre id='line729' class='code' style='background-color: #FFFFff'>          __pyx_t_20 = __pyx_v_j;
          *((int *) ( /* dim=0 */ (__pyx_v_idx.data + __pyx_t_20 * __pyx_v_idx.strides[0]) )) = 0;
        }
        goto __pyx_L7;
      }
      __pyx_L7:;
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line730")'> 730: </pre>
<pre id='line730' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line731")'> 731:         if ASGD == 1:</pre>
<pre id='line731' class='code' style='background-color: #FFFFff'>  __pyx_t_7 = ((__pyx_v_ASGD == 1) != 0);
  if (__pyx_t_7) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line732")'> 732:             for i in prange(self.mem_max, nogil=True, num_threads=self.CORES, schedule=guided):</pre>
<pre id='line732' class='code' style='background-color: #FFFFff'>    {
        #ifdef WITH_THREAD
        PyThreadState *_save;
        Py_UNBLOCK_THREADS
        #endif
        /*try:*/ {
          __pyx_t_2 = __pyx_v_self-&gt;mem_max;
          if (1 == 0) abort();
          {
              #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                  #undef likely
                  #undef unlikely
                  #define likely(x)   (x)
                  #define unlikely(x) (x)
              #endif
              __pyx_t_4 = (__pyx_t_2 - 0) / 1;
              if (__pyx_t_4 &gt; 0)
              {
                  #ifdef _OPENMP
                  #pragma omp parallel
                  #endif /* _OPENMP */
                  {
                      #ifdef _OPENMP
                      #pragma omp for firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_n)          __pyx_t_2 = __pyx_v_self-&gt;mem_max;
          if (1 == 0) abort();
          {
              #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                  #undef likely
                  #undef unlikely
                  #define likely(x)   (x)
                  #define unlikely(x) (x)
              #endif
              __pyx_t_4 = (__pyx_t_2 - 0) / 1;
              if (__pyx_t_4 &gt; 0)
              {
                  #ifdef _OPENMP
                  #pragma omp parallel
                  #endif /* _OPENMP */
                  {
                      #ifdef _OPENMP
                      #pragma omp for firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_n) num_threads(__pyx_v_self-&gt;CORES)
                      #endif /* _OPENMP */
                      for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_4; __pyx_t_3++){
                          {
                              __pyx_v_i = 0 + 1 * __pyx_t_3;
                              /* Initialize private variables to invalid values */
                              __pyx_v_n = ((double)__PYX_NAN());
/* … */
        /*finally:*/ {
          /*normal exit:*/{
            #ifdef WITH_THREAD
            Py_BLOCK_THREADS
            #endif
            goto __pyx_L15;
          }
          __pyx_L15:;
        }
    }
    goto __pyx_L12;
  }
  __pyx_L12:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line733")'> 733:                 n = self.count[i]</pre>
<pre id='line733' class='code' style='background-color: #FFFFff'>                              __pyx_t_5 = __pyx_v_i;
                              __pyx_v_n = (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;count.data + __pyx_t_5 * __pyx_v_self-&gt;count.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line734")'> 734:                 self.w[i] = self.wav[i] * (n**-1)</pre>
<pre id='line734' class='code' style='background-color: #FFFFff'>                              __pyx_t_9 = __pyx_v_i;
                              __pyx_t_13 = __pyx_v_i;
                              *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;w.data + __pyx_t_13 * __pyx_v_self-&gt;w.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;wav.data + __pyx_t_9 * __pyx_v_self-&gt;wav.strides[0]) ))) * pow(__pyx_v_n, -1.0));
                          }
                      }
                  }
              }
          }
          #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
              #undef likely
              #undef unlikely
              #define likely(x)   __builtin_expect(!!(x), 1)
              #define unlikely(x) __builtin_expect(!!(x), 0)
          #endif
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line735")'> 735: </pre>
<pre id='line735' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line736")'> 736: </pre>
<pre id='line736' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line737")'> 737: </pre>
<pre id='line737' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line738")'> 738:     cdef void fit_linear(self,  double[:,:] X, double[:] Y):</pre>
<pre id='line738' class='code' style='background-color: #FFFF96'>static void __pyx_f_9econlearn_8tilecode_8Tilecode_fit_linear(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, __Pyx_memviewslice __pyx_v_X, __Pyx_memviewslice __pyx_v_Y) {
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_k;
  int __pyx_v_z;
  double __pyx_v_x;
  __Pyx_memviewslice __pyx_v_Xreg = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_beta = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_c;
  PyObject *__pyx_v_ols = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fit_linear", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_22, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_24, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("econlearn.tilecode.Tilecode.fit_linear", __pyx_clineno, __pyx_lineno, __pyx_filename, 0);
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Xreg, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_beta, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ols);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line739")'> 739: </pre>
<pre id='line739' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line740")'> 740:         cdef int i, j, k, z = 0</pre>
<pre id='line740' class='code' style='background-color: #FFFFff'>  __pyx_v_z = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line741")'> 741:         cdef double x</pre>
<pre id='line741' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line742")'> 742:         cdef double[:,:] Xreg = np.zeros([self.N, self.lin_SIZE])</pre>
<pre id='line742' class='code' style='background-color: #FFFF41'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;lin_SIZE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  __pyx_t_1 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_Xreg = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line743")'> 743:         cdef double[:] beta = np.zeros(self.lin_SIZE)</pre>
<pre id='line743' class='code' style='background-color: #FFFF55'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 743; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 743; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;lin_SIZE);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 743; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 743; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 743; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_6.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 743; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_beta = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line744")'> 744:         cdef double c = 0</pre>
<pre id='line744' class='code' style='background-color: #FFFFff'>  __pyx_v_c = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line745")'> 745: </pre>
<pre id='line745' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line746")'> 746:         for i in range(self.N):</pre>
<pre id='line746' class='code' style='background-color: #FFFFff'>  __pyx_t_7 = __pyx_v_self-&gt;N;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line747")'> 747:             z = 0</pre>
<pre id='line747' class='code' style='background-color: #FFFFff'>    __pyx_v_z = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line748")'> 748:             for j in range(self.D):</pre>
<pre id='line748' class='code' style='background-color: #FFFFff'>    __pyx_t_9 = __pyx_v_self-&gt;D;
    for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
      __pyx_v_j = __pyx_t_10;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line749")'> 749:                 x = X[i, j] / self.T[j]</pre>
<pre id='line749' class='code' style='background-color: #FFFFaa'>      __pyx_t_11 = __pyx_v_i;
      __pyx_t_12 = __pyx_v_j;
      __pyx_t_13 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_X.data + __pyx_t_11 * __pyx_v_X.strides[0]) ) + __pyx_t_12 * __pyx_v_X.strides[1]) )));
      __pyx_t_14 = __pyx_v_j;
      __pyx_t_15 = (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;T.data + __pyx_t_14 * __pyx_v_self-&gt;T.strides[0]) )));
      if (unlikely(__pyx_t_15 == 0)) {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        #ifdef WITH_THREAD
        PyGILState_Release(__pyx_gilstate_save);
        #endif
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 749; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_v_x = (__pyx_t_13 / ((double)__pyx_t_15));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line750")'> 750:                 for k in range(self.lin_T[j]):</pre>
<pre id='line750' class='code' style='background-color: #FFFFff'>      __pyx_t_15 = __pyx_v_j;
      __pyx_t_16 = (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;lin_T.data + __pyx_t_15 * __pyx_v_self-&gt;lin_T.strides[0]) )));
      for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
        __pyx_v_k = __pyx_t_17;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line751")'> 751:                     Xreg[i, z] = c_max(x - self.lin_width[j] * k, 0)</pre>
<pre id='line751' class='code' style='background-color: #FFFFff'>        __pyx_t_18 = __pyx_v_j;
        __pyx_t_19 = __pyx_v_i;
        __pyx_t_20 = __pyx_v_z;
        *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Xreg.data + __pyx_t_19 * __pyx_v_Xreg.strides[0]) ) + __pyx_t_20 * __pyx_v_Xreg.strides[1]) )) = fmax((__pyx_v_x - ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;lin_width.data + __pyx_t_18 * __pyx_v_self-&gt;lin_width.strides[0]) ))) * __pyx_v_k)), 0.0);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line752")'> 752:                     z +=1</pre>
<pre id='line752' class='code' style='background-color: #FFFFff'>        __pyx_v_z = (__pyx_v_z + 1);
      }
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line753")'> 753: </pre>
<pre id='line753' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3f' onclick='toggleDiv("line754")'> 754:         ols = OLS(fit_intercept=True).fit(Xreg, Y)</pre>
<pre id='line754' class='code' style='background-color: #FFFF3f'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_OLS);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 754; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 754; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_fit_intercept, Py_True) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 754; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 754; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_fit);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 754; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_Xreg, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 754; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_Y, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 754; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 754; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 754; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_ols = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line755")'> 755:         beta = ols.coef_</pre>
<pre id='line755' class='code' style='background-color: #FFFFaa'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ols, __pyx_n_s_coef);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 755; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_6.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 755; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_beta, 1);
  __pyx_v_beta = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line756")'> 756:         c = ols.intercept_ / self.D</pre>
<pre id='line756' class='code' style='background-color: #FFFF6a'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ols, __pyx_n_s_intercept);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 756; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 756; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 756; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_13 == (double)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 756; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_c = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line757")'> 757: </pre>
<pre id='line757' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line758")'> 758:         z = 0</pre>
<pre id='line758' class='code' style='background-color: #FFFFff'>  __pyx_v_z = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line759")'> 759: </pre>
<pre id='line759' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line760")'> 760:         self.lin_w = np.zeros([self.D, self.lin_T[0]])</pre>
<pre id='line760' class='code' style='background-color: #FFFF41'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 760; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 760; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 760; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_21 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;lin_T.data + __pyx_t_21 * __pyx_v_self-&gt;lin_T.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 760; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 760; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 760; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 760; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_22 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_3);
  if (unlikely(!__pyx_t_22.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 760; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;lin_w, 0);
  __pyx_v_self-&gt;lin_w = __pyx_t_22;
  __pyx_t_22.memview = NULL;
  __pyx_t_22.data = NULL;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line761")'> 761:         self.lin_c = np.zeros([self.D, self.lin_T[0]])</pre>
<pre id='line761' class='code' style='background-color: #FFFF41'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 761; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 761; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 761; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_23 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>((*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;lin_T.data + __pyx_t_23 * __pyx_v_self-&gt;lin_T.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 761; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 761; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_3 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 761; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 761; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_2);
  if (unlikely(!__pyx_t_24.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 761; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;lin_c, 0);
  __pyx_v_self-&gt;lin_c = __pyx_t_24;
  __pyx_t_24.memview = NULL;
  __pyx_t_24.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line762")'> 762: </pre>
<pre id='line762' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line763")'> 763:         for j in range(self.D):</pre>
<pre id='line763' class='code' style='background-color: #FFFFff'>  __pyx_t_7 = __pyx_v_self-&gt;D;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_j = __pyx_t_8;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line764")'> 764:             for k in range(self.lin_T[j]):</pre>
<pre id='line764' class='code' style='background-color: #FFFFff'>    __pyx_t_9 = __pyx_v_j;
    __pyx_t_10 = (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;lin_T.data + __pyx_t_9 * __pyx_v_self-&gt;lin_T.strides[0]) )));
    for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_10; __pyx_t_16+=1) {
      __pyx_v_k = __pyx_t_16;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line765")'> 765:                 if k &gt; 0:</pre>
<pre id='line765' class='code' style='background-color: #FFFFff'>      __pyx_t_25 = ((__pyx_v_k &gt; 0) != 0);
      if (__pyx_t_25) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line766")'> 766:                     self.lin_w[j, k] = beta[z] + self.lin_w[j, k - 1]</pre>
<pre id='line766' class='code' style='background-color: #FFFFff'>        __pyx_t_17 = __pyx_v_z;
        __pyx_t_26 = __pyx_v_j;
        __pyx_t_27 = (__pyx_v_k - 1);
        __pyx_t_28 = __pyx_v_j;
        __pyx_t_29 = __pyx_v_k;
        *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;lin_w.data + __pyx_t_28 * __pyx_v_self-&gt;lin_w.strides[0]) ) + __pyx_t_29 * __pyx_v_self-&gt;lin_w.strides[1]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_beta.data + __pyx_t_17 * __pyx_v_beta.strides[0]) ))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;lin_w.data + __pyx_t_26 * __pyx_v_self-&gt;lin_w.strides[0]) ) + __pyx_t_27 * __pyx_v_self-&gt;lin_w.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line767")'> 767:                     self.lin_c[j, k] += self.lin_w[j, k - 1] * self.lin_width[j] * k - self.lin_w[j, k] * self.lin_width[j] * k + self.lin_c[j, k -1]</pre>
<pre id='line767' class='code' style='background-color: #FFFFff'>        __pyx_t_30 = __pyx_v_j;
        __pyx_t_31 = (__pyx_v_k - 1);
        __pyx_t_32 = __pyx_v_j;
        __pyx_t_33 = __pyx_v_j;
        __pyx_t_34 = __pyx_v_k;
        __pyx_t_35 = __pyx_v_j;
        __pyx_t_36 = __pyx_v_j;
        __pyx_t_37 = (__pyx_v_k - 1);
        __pyx_t_38 = __pyx_v_j;
        __pyx_t_39 = __pyx_v_k;
        *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;lin_c.data + __pyx_t_38 * __pyx_v_self-&gt;lin_c.strides[0]) ) + __pyx_t_39 * __pyx_v_self-&gt;lin_c.strides[1]) )) += (((((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;lin_w.data + __pyx_t_30 * __pyx_v_self-&gt;lin_w.strides[0]) ) + __pyx_t_31 * __pyx_v_self-&gt;lin_w.strides[1]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;lin_width.data + __pyx_t_32 * __pyx_v_self-&gt;lin_width.strides[0]) )))) * __pyx_v_k) - (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;lin_w.data + __pyx_t_33 * __pyx_v_self-&gt;lin_w.strides[0]) ) + __pyx_t_34 * __pyx_v_self-&gt;lin_w.strides[1]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;lin_width.data + __pyx_t_35 * __pyx_v_self-&gt;lin_width.strides[0]) )))) * __pyx_v_k)) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;lin_c.data + __pyx_t_36 * __pyx_v_self-&gt;lin_c.strides[0]) ) + __pyx_t_37 * __pyx_v_self-&gt;lin_c.strides[1]) ))));
        goto __pyx_L13;
      }
      /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line768")'> 768:                 else:</pre>
<pre id='line768' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line769")'> 769:                     self.lin_w[j, k] = beta[z]</pre>
<pre id='line769' class='code' style='background-color: #FFFFff'>        __pyx_t_40 = __pyx_v_z;
        __pyx_t_41 = __pyx_v_j;
        __pyx_t_42 = __pyx_v_k;
        *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;lin_w.data + __pyx_t_41 * __pyx_v_self-&gt;lin_w.strides[0]) ) + __pyx_t_42 * __pyx_v_self-&gt;lin_w.strides[1]) )) = (*((double *) ( /* dim=0 */ (__pyx_v_beta.data + __pyx_t_40 * __pyx_v_beta.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line770")'> 770:                     self.lin_c[j, k] = c</pre>
<pre id='line770' class='code' style='background-color: #FFFFff'>        __pyx_t_43 = __pyx_v_j;
        __pyx_t_44 = __pyx_v_k;
        *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;lin_c.data + __pyx_t_43 * __pyx_v_self-&gt;lin_c.strides[0]) ) + __pyx_t_44 * __pyx_v_self-&gt;lin_c.strides[1]) )) = __pyx_v_c;
      }
      __pyx_L13:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line771")'> 771: </pre>
<pre id='line771' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line772")'> 772:                 z += 1</pre>
<pre id='line772' class='code' style='background-color: #FFFFff'>      __pyx_v_z = (__pyx_v_z + 1);
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line773")'> 773: </pre>
<pre id='line773' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line774")'> 774:     def predict(self, X, store_XS=False):</pre>
<pre id='line774' class='code' style='background-color: #FFFF37'>/* Python wrapper */
static PyObject *__pyx_pw_9econlearn_8tilecode_8Tilecode_11predict(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_9econlearn_8tilecode_8Tilecode_10predict[] = "    \n        Return predicted value \n\n        Parameters\n        -----------\n        X : array, shape=(N, D) or (D,)\n            Input data\n\n        Returns\n        --------\n    \n        Y : array, shape=(N,)\n            Predicted values\n        ";
static PyObject *__pyx_pw_9econlearn_8tilecode_8Tilecode_11predict(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_store_XS = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("predict (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_X,&amp;__pyx_n_s_store_XS,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)Py_False);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_X)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_store_XS);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "predict") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 774; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_X = values[0];
    __pyx_v_store_XS = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("predict", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 774; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Tilecode.predict", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9econlearn_8tilecode_8Tilecode_10predict(((struct __pyx_obj_9econlearn_8tilecode_Tilecode *)__pyx_v_self), __pyx_v_X, __pyx_v_store_XS);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9econlearn_8tilecode_8Tilecode_10predict(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, PyObject *__pyx_v_X, PyObject *__pyx_v_store_XS) {
  int __pyx_v_i;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_v_Y = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_XS = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_extraptemp = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("predict", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Tilecode.predict", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Y, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_XS, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_extraptemp, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line775")'> 775: </pre>
<pre id='line775' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line776")'> 776:         """</pre>
<pre id='line776' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line777")'> 777:         Return predicted value</pre>
<pre id='line777' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line778")'> 778: </pre>
<pre id='line778' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line779")'> 779:         Parameters</pre>
<pre id='line779' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line780")'> 780:         -----------</pre>
<pre id='line780' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line781")'> 781:         X : array, shape=(N, D) or (D,)</pre>
<pre id='line781' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line782")'> 782:             Input data</pre>
<pre id='line782' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line783")'> 783: </pre>
<pre id='line783' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line784")'> 784:         Returns</pre>
<pre id='line784' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line785")'> 785:         --------</pre>
<pre id='line785' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line786")'> 786: </pre>
<pre id='line786' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line787")'> 787:         Y : array, shape=(N,)</pre>
<pre id='line787' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line788")'> 788:             Predicted values</pre>
<pre id='line788' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line789")'> 789:         """</pre>
<pre id='line789' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line790")'> 790: </pre>
<pre id='line790' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line791")'> 791:         cdef int i, k, N = 0</pre>
<pre id='line791' class='code' style='background-color: #FFFFff'>  __pyx_v_N = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line792")'> 792: </pre>
<pre id='line792' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line793")'> 793:         if len(X.shape) == 1:</pre>
<pre id='line793' class='code' style='background-color: #FFFF8d'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = ((__pyx_t_2 == 1) != 0);
  if (__pyx_t_3) {
</pre><pre class='line' style='background-color: #FFFF4d' onclick='toggleDiv("line794")'> 794:             X = X.reshape([1, self.D])</pre>
<pre id='line794' class='code' style='background-color: #FFFF4d'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_X, __pyx_t_5);
    __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line795")'> 795:             N = 1</pre>
<pre id='line795' class='code' style='background-color: #FFFFff'>    __pyx_v_N = 1;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line796")'> 796:         else:</pre>
<pre id='line796' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line797")'> 797:             N = X.shape[0]</pre>
<pre id='line797' class='code' style='background-color: #FFFF8d'>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 797; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 797; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_6 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 797; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_N = __pyx_t_6;
  }
  __pyx_L3:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line798")'> 798: </pre>
<pre id='line798' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line799")'> 799:         cdef double[:] Y = np.zeros(N)</pre>
<pre id='line799' class='code' style='background-color: #FFFF55'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 799; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 799; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 799; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 799; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 799; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_7.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 799; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_Y = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line800")'> 800:         cdef double[:,:] XS = np.zeros([N, self.D])</pre>
<pre id='line800' class='code' style='background-color: #FFFF41'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_8);
  if (unlikely(!__pyx_t_9.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_XS = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line801")'> 801:         cdef int[:] extraptemp = np.zeros(N, dtype='int32')</pre>
<pre id='line801' class='code' style='background-color: #FFFF3e'>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 801; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 801; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 801; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 801; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 801; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 801; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 801; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_4);
  if (unlikely(!__pyx_t_10.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 801; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_extraptemp = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line802")'> 802: </pre>
<pre id='line802' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line803")'> 803:         XS = self.scale_X(X, N, XS)</pre>
<pre id='line803' class='code' style='background-color: #FFFFd4'>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_X);
  if (unlikely(!__pyx_t_11.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 803; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_12 = ((struct __pyx_vtabstruct_9econlearn_8tilecode_Tilecode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;scale_X(__pyx_v_self, __pyx_t_11, __pyx_v_N, __pyx_v_XS);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 803; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_XS, 1);
  __pyx_v_XS = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line804")'> 804:         extraptemp = self.check_extrap(XS, N, extraptemp)</pre>
<pre id='line804' class='code' style='background-color: #FFFFff'>  __pyx_t_13 = ((struct __pyx_vtabstruct_9econlearn_8tilecode_Tilecode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;check_extrap(__pyx_v_self, __pyx_v_XS, __pyx_v_N, __pyx_v_extraptemp);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 804; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_extraptemp, 1);
  __pyx_v_extraptemp = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line805")'> 805: </pre>
<pre id='line805' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line806")'> 806:         if store_XS:</pre>
<pre id='line806' class='code' style='background-color: #FFFFd4'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_store_XS);<span class='error_goto'> if (unlikely(__pyx_t_3 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 806; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (__pyx_t_3) {
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line807")'> 807:             self.XS = np.zeros([N, self.D])</pre>
<pre id='line807' class='code' style='background-color: #FFFF41'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 807; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 807; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 807; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 807; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 807; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    __pyx_t_4 = 0;
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 807; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 807; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_5);
    if (unlikely(!__pyx_t_14.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 807; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;XS, 0);
    __pyx_v_self-&gt;XS = __pyx_t_14;
    __pyx_t_14.memview = NULL;
    __pyx_t_14.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line808")'> 808:             self.XS[...] = XS</pre>
<pre id='line808' class='code' style='background-color: #FFFFff'>    if (unlikely(__pyx_memoryview_copy_contents(__pyx_v_XS, __pyx_v_self-&gt;XS, 2, 2, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line809")'> 809:             self.extrapXS = np.zeros(N, dtype='int32')</pre>
<pre id='line809' class='code' style='background-color: #FFFF3e'>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_8, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_4);
    if (unlikely(!__pyx_t_15.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;extrapXS, 0);
    __pyx_v_self-&gt;extrapXS = __pyx_t_15;
    __pyx_t_15.memview = NULL;
    __pyx_t_15.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line810")'> 810:             self.extrapXS[...] = extraptemp</pre>
<pre id='line810' class='code' style='background-color: #FFFFff'>    if (unlikely(__pyx_memoryview_copy_contents(__pyx_v_extraptemp, __pyx_v_self-&gt;extrapXS, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 810; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line811")'> 811:             self.XSN = N</pre>
<pre id='line811' class='code' style='background-color: #FFFFff'>    __pyx_v_self-&gt;XSN = __pyx_v_N;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line812")'> 812:             self.fastvalues = np.zeros(N)</pre>
<pre id='line812' class='code' style='background-color: #FFFF55'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 812; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 812; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 812; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 812; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 812; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_4);
    if (unlikely(!__pyx_t_16.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 812; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;fastvalues, 0);
    __pyx_v_self-&gt;fastvalues = __pyx_t_16;
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
</pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line813")'> 813:             self.datastruct_reverse = np.zeros([N, self.L], dtype='int32')</pre>
<pre id='line813' class='code' style='background-color: #FFFF33'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;L);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    __pyx_t_4 = 0;
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_4);
    if (unlikely(!__pyx_t_17.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;datastruct_reverse, 0);
    __pyx_v_self-&gt;datastruct_reverse = __pyx_t_17;
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line814")'> 814:             self.fit_data_reverse(XS, N, extraptemp)</pre>
<pre id='line814' class='code' style='background-color: #FFFFff'>    ((struct __pyx_vtabstruct_9econlearn_8tilecode_Tilecode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;fit_data_reverse(__pyx_v_self, __pyx_v_XS, __pyx_v_N, __pyx_v_extraptemp);
    goto __pyx_L4;
  }
  __pyx_L4:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line815")'> 815: </pre>
<pre id='line815' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line816")'> 816:         for i in prange(N, nogil=True, num_threads=self.CORES, schedule=static):</pre>
<pre id='line816' class='code' style='background-color: #FFFFff'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
        __pyx_t_6 = __pyx_v_N;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_19 = (__pyx_t_6 - 0) / 1;
            if (__pyx_t_19 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_i) lastprivate(__pyx_v_i)        __pyx_t_6 = __pyx_v_N;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_19 = (__pyx_t_6 - 0) / 1;
            if (__pyx_t_19 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) num_threads(__pyx_v_self-&gt;CORES)
                    #endif /* _OPENMP */
                    for (__pyx_t_18 = 0; __pyx_t_18 &lt; __pyx_t_19; __pyx_t_18++){
                        {
                            __pyx_v_i = 0 + 1 * __pyx_t_18;
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L7;
        }
        __pyx_L7:;
      }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line817")'> 817:             Y[i] = predict(self.D, i, XS, extraptemp[i], self.Tinv, self.offset, self.flat, self.Linv, self.w, self.count, self.min_sample, self.lin_spline, self.lin_w, self.lin_c, self.lin_T, self.SIZE, self.L, self.dohash, self.mem_max, self.key)</pre>
<pre id='line817' class='code' style='background-color: #FFFFff'>                            __pyx_t_20 = __pyx_v_i;
                            __pyx_t_21 = __pyx_v_i;
                            *((double *) ( /* dim=0 */ (__pyx_v_Y.data + __pyx_t_21 * __pyx_v_Y.strides[0]) )) = __pyx_f_9econlearn_8tilecode_predict(__pyx_v_self-&gt;D, __pyx_v_i, __pyx_v_XS, (*((int *) ( /* dim=0 */ (__pyx_v_extraptemp.data + __pyx_t_20 * __pyx_v_extraptemp.strides[0]) ))), __pyx_v_self-&gt;Tinv, __pyx_v_self-&gt;offset, __pyx_v_self-&gt;flat, __pyx_v_self-&gt;Linv, __pyx_v_self-&gt;w, __pyx_v_self-&gt;count, __pyx_v_self-&gt;min_sample, __pyx_v_self-&gt;lin_spline, __pyx_v_self-&gt;lin_w, __pyx_v_self-&gt;lin_c, __pyx_v_self-&gt;lin_T, __pyx_v_self-&gt;SIZE, __pyx_v_self-&gt;L, __pyx_v_self-&gt;dohash, __pyx_v_self-&gt;mem_max, __pyx_v_self-&gt;key);
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line818")'> 818:         return np.array(Y)</pre>
<pre id='line818' class='code' style='background-color: #FFFF62'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 818; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 818; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_Y, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 818; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 818; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 818; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line819")'> 819: </pre>
<pre id='line819' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3b' onclick='toggleDiv("line820")'> 820:     def cross_validate(self, cores = 1):</pre>
<pre id='line820' class='code' style='background-color: #FFFF3b'>/* Python wrapper */
static PyObject *__pyx_pw_9econlearn_8tilecode_8Tilecode_13cross_validate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_9econlearn_8tilecode_8Tilecode_13cross_validate(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_cores = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cross_validate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_cores,0};
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)__pyx_int_1);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_cores);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "cross_validate") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 820; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_cores = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cross_validate", 0, 0, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 820; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Tilecode.cross_validate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9econlearn_8tilecode_8Tilecode_12cross_validate(((struct __pyx_obj_9econlearn_8tilecode_Tilecode *)__pyx_v_self), __pyx_v_cores);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9econlearn_8tilecode_8Tilecode_12cross_validate(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, PyObject *__pyx_v_cores) {
  PyObject *__pyx_v_x1 = NULL;
  PyObject *__pyx_v_y1 = NULL;
  PyObject *__pyx_v_x2 = NULL;
  PyObject *__pyx_v_y2 = NULL;
  PyObject *__pyx_v_R2_1 = NULL;
  PyObject *__pyx_v_R2_2 = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cross_validate", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Tilecode.cross_validate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_R2_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_R2_2);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line821")'> 821: </pre>
<pre id='line821' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line822")'> 822:         x1 = self.X[0:self.N / 2, :]</pre>
<pre id='line822' class='code' style='background-color: #FFFF8d'>  __pyx_t_1 = __pyx_v_self-&gt;X;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((((double)__pyx_v_self-&gt;N) / 2.0));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 822; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 822; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = -1;
  __pyx_t_4.data = __pyx_t_1.data;
  __pyx_t_4.memview = __pyx_t_1.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_4, 0);
  if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_4,
    __pyx_t_1.shape[0], __pyx_t_1.strides[0], __pyx_t_1.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_5,
    0,
    __pyx_t_3,
    0,
    1,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 822; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
}

__pyx_t_4.shape[1] = __pyx_t_1.shape[1];
__pyx_t_4.strides[1] = __pyx_t_1.strides[1];
    __pyx_t_4.suboffsets[1] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_4, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 822; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  __pyx_v_x1 = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line823")'> 823:         y1 = self.Y[0:self.N / 2]</pre>
<pre id='line823' class='code' style='background-color: #FFFF8d'>  __pyx_t_6 = __pyx_v_self-&gt;Y;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_6, 1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((((double)__pyx_v_self-&gt;N) / 2.0));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = -1;
  __pyx_t_7.data = __pyx_t_6.data;
  __pyx_t_7.memview = __pyx_t_6.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
  if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_7,
    __pyx_t_6.shape[0], __pyx_t_6.strides[0], __pyx_t_6.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_5,
    0,
    __pyx_t_3,
    0,
    1,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
}

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_7, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __pyx_v_y1 = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line824")'> 824: </pre>
<pre id='line824' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line825")'> 825:         x2 = self.X[self.N / 2::, :]</pre>
<pre id='line825' class='code' style='background-color: #FFFF8d'>  __pyx_t_1 = __pyx_v_self-&gt;X;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((((double)__pyx_v_self-&gt;N) / 2.0));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = -1;
  __pyx_t_8.data = __pyx_t_1.data;
  __pyx_t_8.memview = __pyx_t_1.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_8, 0);
  if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_8,
    __pyx_t_1.shape[0], __pyx_t_1.strides[0], __pyx_t_1.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_5,
    __pyx_t_3,
    0,
    0,
    1,
    0,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
}

__pyx_t_8.shape[1] = __pyx_t_1.shape[1];
__pyx_t_8.strides[1] = __pyx_t_1.strides[1];
    __pyx_t_8.suboffsets[1] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_8, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 825; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __pyx_v_x2 = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF8d' onclick='toggleDiv("line826")'> 826:         y2 = self.Y[self.N / 2::]</pre>
<pre id='line826' class='code' style='background-color: #FFFF8d'>  __pyx_t_6 = __pyx_v_self-&gt;Y;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_6, 1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((((double)__pyx_v_self-&gt;N) / 2.0));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_3 == (Py_ssize_t)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = -1;
  __pyx_t_9.data = __pyx_t_6.data;
  __pyx_t_9.memview = __pyx_t_6.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
  if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_9,
    __pyx_t_6.shape[0], __pyx_t_6.strides[0], __pyx_t_6.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_5,
    __pyx_t_3,
    0,
    0,
    1,
    0,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
}

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 826; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __pyx_v_y2 = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line827")'> 827: </pre>
<pre id='line827' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line828")'> 828:         self.fit(x1, y1, cores = cores)</pre>
<pre id='line828' class='code' style='background-color: #FFFF44'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_fit);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_v_x1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_v_y1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y1);
  __pyx_t_11 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_cores, __pyx_v_cores) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_10, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line829")'> 829:         R2_1 = self.score(x2, y2)</pre>
<pre id='line829' class='code' style='background-color: #FFFF66'>  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_score);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_v_x2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_v_y2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y2);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_v_R2_1 = __pyx_t_10;
  __pyx_t_10 = 0;
</pre><pre class='line' style='background-color: #FFFF44' onclick='toggleDiv("line830")'> 830:         self.fit(x2, y2, cores = cores)</pre>
<pre id='line830' class='code' style='background-color: #FFFF44'>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_fit);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 830; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 830; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_v_x2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_v_y2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y2);
  __pyx_t_12 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 830; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_s_cores, __pyx_v_cores) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 830; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_11, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 830; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line831")'> 831:         R2_2 = self.score(x1, y1)</pre>
<pre id='line831' class='code' style='background-color: #FFFF66'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_score);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_v_x1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_v_y1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y1);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_v_R2_2 = __pyx_t_11;
  __pyx_t_11 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line832")'> 832: </pre>
<pre id='line832' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line833")'> 833:         self.fit(self.X, self.Y)</pre>
<pre id='line833' class='code' style='background-color: #FFFF6a'>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_fit);<span class='error_goto'> if (unlikely(!__pyx_t_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 833; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_12 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;X, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 833; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;Y, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 833; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 833; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_12 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 833; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line834")'> 834: </pre>
<pre id='line834' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF86' onclick='toggleDiv("line835")'> 835:         return (R2_1 + R2_2) / 2</pre>
<pre id='line835' class='code' style='background-color: #FFFF86'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_R2_1, __pyx_v_R2_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 835; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_2, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 835; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_10;
  __pyx_t_10 = 0;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line836")'> 836: </pre>
<pre id='line836' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF27' onclick='toggleDiv("line837")'> 837:     def opt(self, double[:,:] X, double[:] Al, double[:] Ah):</pre>
<pre id='line837' class='code' style='background-color: #FFFF27'>/* Python wrapper */
static PyObject *__pyx_pw_9econlearn_8tilecode_8Tilecode_15opt(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_9econlearn_8tilecode_8Tilecode_14opt[] = "    \n        Optimise the function over the first dimension (e.g., actions) for a subset of points.\n\n        Subject to feasibility constraints Al &lt;= A* &lt;= Ah\n\n        Parameters\n        -----------\n        X : array, shape=(N, D) \n            Input points to optimise over (unscaled)\n        \n        Al : array, shape=(N) \n            Action lower bound\n        \n        Ah : array, shape=(N) \n            Action upped bound\n        \n        Returns\n        --------\n    \n        actions : array, shape=(&lt;N,)\n            Optimal actions  (e.g. argmax Q(a, s))\n\n        values : array, shape=(&lt;N)\n            Optimal Q values, (e.g. max Q(a, s))\n        \n        points : array, shape(&lt;N, D)\n            Points actually used: some points may be ignored if count &lt; min_sample\n        \n        index : array, shape(&lt;N, D)\n            index of points actually used\n        ";
static PyObject *__pyx_pw_9econlearn_8tilecode_8Tilecode_15opt(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_X = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_Al = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_Ah = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("opt (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_X,&amp;__pyx_n_s_Al,&amp;__pyx_n_s_Ah,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_X)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Al)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("opt", 1, 3, 3, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 837; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Ah)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("opt", 1, 3, 3, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 837; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "opt") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 837; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_X = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[0]);<span class='error_goto'> if (unlikely(!__pyx_v_X.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 837; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_Al = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[1]);<span class='error_goto'> if (unlikely(!__pyx_v_Al.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 837; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_Ah = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[2]);<span class='error_goto'> if (unlikely(!__pyx_v_Ah.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 837; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("opt", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 837; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Tilecode.opt", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9econlearn_8tilecode_8Tilecode_14opt(((struct __pyx_obj_9econlearn_8tilecode_Tilecode *)__pyx_v_self), __pyx_v_X, __pyx_v_Al, __pyx_v_Ah);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9econlearn_8tilecode_8Tilecode_14opt(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, __Pyx_memviewslice __pyx_v_X, __Pyx_memviewslice __pyx_v_Al, __Pyx_memviewslice __pyx_v_Ah) {
  int __pyx_v_N;
  double __pyx_v_v;
  double __pyx_v_A;
  int __pyx_v_i;
  __Pyx_memviewslice __pyx_v_v_opt = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_A_opt = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_GRID;
  double __pyx_v_step;
  double __pyx_v_A_old;
  CYTHON_UNUSED double __pyx_v_xt;
  __Pyx_memviewslice __pyx_v_XS = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_AS;
  __Pyx_memviewslice __pyx_v_extrap = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_index = NULL;
  PyObject *__pyx_v_values = NULL;
  PyObject *__pyx_v_actions = NULL;
  PyObject *__pyx_v_state = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("opt", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Tilecode.opt", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_v_opt, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_A_opt, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_XS, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_extrap, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_index);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_values);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_actions);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_state);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_X, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Al, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Ah, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line838")'> 838: </pre>
<pre id='line838' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line839")'> 839:         """</pre>
<pre id='line839' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line840")'> 840:         Optimise the function over the first dimension (e.g., actions) for a subset of points.</pre>
<pre id='line840' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line841")'> 841: </pre>
<pre id='line841' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line842")'> 842:         Subject to feasibility constraints Al &lt;= A* &lt;= Ah</pre>
<pre id='line842' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line843")'> 843: </pre>
<pre id='line843' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line844")'> 844:         Parameters</pre>
<pre id='line844' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line845")'> 845:         -----------</pre>
<pre id='line845' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line846")'> 846:         X : array, shape=(N, D)</pre>
<pre id='line846' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line847")'> 847:             Input points to optimise over (unscaled)</pre>
<pre id='line847' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line848")'> 848: </pre>
<pre id='line848' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line849")'> 849:         Al : array, shape=(N)</pre>
<pre id='line849' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line850")'> 850:             Action lower bound</pre>
<pre id='line850' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line851")'> 851: </pre>
<pre id='line851' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line852")'> 852:         Ah : array, shape=(N)</pre>
<pre id='line852' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line853")'> 853:             Action upped bound</pre>
<pre id='line853' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line854")'> 854: </pre>
<pre id='line854' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line855")'> 855:         Returns</pre>
<pre id='line855' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line856")'> 856:         --------</pre>
<pre id='line856' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line857")'> 857: </pre>
<pre id='line857' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line858")'> 858:         actions : array, shape=(&lt;N,)</pre>
<pre id='line858' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line859")'> 859:             Optimal actions  (e.g. argmax Q(a, s))</pre>
<pre id='line859' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line860")'> 860: </pre>
<pre id='line860' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line861")'> 861:         values : array, shape=(&lt;N)</pre>
<pre id='line861' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line862")'> 862:             Optimal Q values, (e.g. max Q(a, s))</pre>
<pre id='line862' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line863")'> 863: </pre>
<pre id='line863' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line864")'> 864:         points : array, shape(&lt;N, D)</pre>
<pre id='line864' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line865")'> 865:             Points actually used: some points may be ignored if count &lt; min_sample</pre>
<pre id='line865' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line866")'> 866: </pre>
<pre id='line866' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line867")'> 867:         index : array, shape(&lt;N, D)</pre>
<pre id='line867' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line868")'> 868:             index of points actually used</pre>
<pre id='line868' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line869")'> 869:         """</pre>
<pre id='line869' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line870")'> 870: </pre>
<pre id='line870' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line871")'> 871:         cdef int N = X.shape[0]</pre>
<pre id='line871' class='code' style='background-color: #FFFFff'>  __pyx_v_N = (__pyx_v_X.shape[0]);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line872")'> 872:         cdef double v = 0</pre>
<pre id='line872' class='code' style='background-color: #FFFFff'>  __pyx_v_v = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line873")'> 873:         cdef double A = 0</pre>
<pre id='line873' class='code' style='background-color: #FFFFff'>  __pyx_v_A = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line874")'> 874:         cdef int i, h, j, k</pre>
<pre id='line874' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line875")'> 875:         cdef double[:] v_opt = np.zeros(N)</pre>
<pre id='line875' class='code' style='background-color: #FFFF55'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 875; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 875; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 875; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 875; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 875; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1);
  if (unlikely(!__pyx_t_4.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 875; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_v_opt = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line876")'> 876:         cdef double[:] A_opt = np.zeros(N)</pre>
<pre id='line876' class='code' style='background-color: #FFFF55'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1);
  if (unlikely(!__pyx_t_5.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_A_opt = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line877")'> 877:         cdef int GRID = c_int((self.T[0] + 1) * self.L * 1.3)</pre>
<pre id='line877' class='code' style='background-color: #FFFFff'>  __pyx_t_6 = 0;
  __pyx_v_GRID = Real2Int(((((*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;T.data + __pyx_t_6 * __pyx_v_self-&gt;T.strides[0]) ))) + 1) * __pyx_v_self-&gt;L) * 1.3));
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line878")'> 878:         cdef double step =  (self.b[0] - self.a[0]) / GRID</pre>
<pre id='line878' class='code' style='background-color: #FFFFaa'>  __pyx_t_7 = 0;
  __pyx_t_8 = 0;
  __pyx_t_9 = ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;b.data + __pyx_t_7 * __pyx_v_self-&gt;b.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;a.data + __pyx_t_8 * __pyx_v_self-&gt;a.strides[0]) ))));
  if (unlikely(__pyx_v_GRID == 0)) {
    #ifdef WITH_THREAD
    PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    #ifdef WITH_THREAD
    PyGILState_Release(__pyx_gilstate_save);
    #endif
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 878; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_step = (__pyx_t_9 / ((double)__pyx_v_GRID));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line879")'> 879:         cdef double A_old</pre>
<pre id='line879' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line880")'> 880:         cdef double xt = 0</pre>
<pre id='line880' class='code' style='background-color: #FFFFff'>  __pyx_v_xt = 0.0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line881")'> 881:         cdef double[:,:] XS = np.zeros([N, self.D])</pre>
<pre id='line881' class='code' style='background-color: #FFFF41'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 881; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 881; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 881; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 881; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 881; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  __pyx_t_1 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 881; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 881; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_10);
  if (unlikely(!__pyx_t_11.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 881; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_v_XS = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line882")'> 882:         cdef double AS</pre>
<pre id='line882' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF3e' onclick='toggleDiv("line883")'> 883:         cdef int[:] extrap = np.zeros(N, dtype = 'int32')</pre>
<pre id='line883' class='code' style='background-color: #FFFF3e'>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 883; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 883; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 883; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 883; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 883; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 883; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 883; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_t_1);
  if (unlikely(!__pyx_t_12.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 883; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_extrap = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line884")'> 884: </pre>
<pre id='line884' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line885")'> 885:         XS = self.scale_X(X, N, XS)</pre>
<pre id='line885' class='code' style='background-color: #FFFFff'>  __pyx_t_13 = ((struct __pyx_vtabstruct_9econlearn_8tilecode_Tilecode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;scale_X(__pyx_v_self, __pyx_v_X, __pyx_v_N, __pyx_v_XS);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 885; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_XS, 1);
  __pyx_v_XS = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line886")'> 886:         extrap = self.check_extrap(XS, N, extrap)</pre>
<pre id='line886' class='code' style='background-color: #FFFFff'>  __pyx_t_14 = ((struct __pyx_vtabstruct_9econlearn_8tilecode_Tilecode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;check_extrap(__pyx_v_self, __pyx_v_XS, __pyx_v_N, __pyx_v_extrap);<span class='error_goto'> if (unlikely(!__pyx_t_14.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 886; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_extrap, 1);
  __pyx_v_extrap = __pyx_t_14;
  __pyx_t_14.memview = NULL;
  __pyx_t_14.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line887")'> 887: </pre>
<pre id='line887' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line888")'> 888:         for i in prange(N, nogil=True, num_threads=self.CORES, schedule=static):</pre>
<pre id='line888' class='code' style='background-color: #FFFFff'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
        __pyx_t_15 = __pyx_v_N;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_17 = (__pyx_t_15 - 0) / 1;
            if (__pyx_t_17 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_A) lastprivate(__pyx_v_AS) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_v) lastprivate(__pyx_v_A_old)        __pyx_t_15 = __pyx_v_N;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_17 = (__pyx_t_15 - 0) / 1;
            if (__pyx_t_17 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_A) lastprivate(__pyx_v_AS) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_v) lastprivate(__pyx_v_A_old) num_threads(__pyx_v_self-&gt;CORES)
                    #endif /* _OPENMP */
                    for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_17; __pyx_t_16++){
                        {
                            __pyx_v_i = 0 + 1 * __pyx_t_16;
                            /* Initialize private variables to invalid values */
                            __pyx_v_A = ((double)__PYX_NAN());
                            __pyx_v_AS = ((double)__PYX_NAN());
                            __pyx_v_v = ((double)__PYX_NAN());
                            __pyx_v_A_old = ((double)__PYX_NAN());
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line889")'> 889:             if extrap[i] == 0:</pre>
<pre id='line889' class='code' style='background-color: #FFFFff'>                            __pyx_t_18 = __pyx_v_i;
                            __pyx_t_19 = (((*((int *) ( /* dim=0 */ (__pyx_v_extrap.data + __pyx_t_18 * __pyx_v_extrap.strides[0]) ))) == 0) != 0);
                            if (__pyx_t_19) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line890")'> 890:                 A = Al[i]</pre>
<pre id='line890' class='code' style='background-color: #FFFFff'>                              __pyx_t_20 = __pyx_v_i;
                              __pyx_v_A = (*((double *) ( /* dim=0 */ (__pyx_v_Al.data + __pyx_t_20 * __pyx_v_Al.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line891")'> 891:                 while A &lt;= Ah[i]:</pre>
<pre id='line891' class='code' style='background-color: #FFFFff'>                              while (1) {
                                __pyx_t_21 = __pyx_v_i;
                                __pyx_t_19 = ((__pyx_v_A &lt;= (*((double *) ( /* dim=0 */ (__pyx_v_Ah.data + __pyx_t_21 * __pyx_v_Ah.strides[0]) )))) != 0);
                                if (!__pyx_t_19) break;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line892")'> 892: </pre>
<pre id='line892' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line893")'> 893:                     # Scale A</pre>
<pre id='line893' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line894")'> 894:                     AS = ((A - self.a[0]) * self.d[0]) * self.T[0]</pre>
<pre id='line894' class='code' style='background-color: #FFFFff'>                                __pyx_t_22 = 0;
                                __pyx_t_23 = 0;
                                __pyx_t_24 = 0;
                                __pyx_v_AS = (((__pyx_v_A - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;a.data + __pyx_t_22 * __pyx_v_self-&gt;a.strides[0]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;d.data + __pyx_t_23 * __pyx_v_self-&gt;d.strides[0]) )))) * (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;T.data + __pyx_t_24 * __pyx_v_self-&gt;T.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line895")'> 895:                     XS[i, 0] = AS</pre>
<pre id='line895' class='code' style='background-color: #FFFFff'>                                __pyx_t_25 = __pyx_v_i;
                                __pyx_t_26 = 0;
                                *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_XS.data + __pyx_t_25 * __pyx_v_XS.strides[0]) ) + __pyx_t_26 * __pyx_v_XS.strides[1]) )) = __pyx_v_AS;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line896")'> 896: </pre>
<pre id='line896' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line897")'> 897:                     if AS &lt; -0.0001 or AS &gt; self.T[0] + 0.0001:</pre>
<pre id='line897' class='code' style='background-color: #FFFFff'>                                __pyx_t_19 = ((__pyx_v_AS &lt; -0.0001) != 0);
                                if (!__pyx_t_19) {
                                  __pyx_t_27 = 0;
                                  __pyx_t_28 = ((__pyx_v_AS &gt; ((*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;T.data + __pyx_t_27 * __pyx_v_self-&gt;T.strides[0]) ))) + 0.0001)) != 0);
                                  __pyx_t_29 = __pyx_t_28;
                                } else {
                                  __pyx_t_29 = __pyx_t_19;
                                }
                                if (__pyx_t_29) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line898")'> 898:                         v = 0</pre>
<pre id='line898' class='code' style='background-color: #FFFFff'>                                  __pyx_v_v = 0.0;
                                  goto __pyx_L13;
                                }
                                /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line899")'> 899:                     else:</pre>
<pre id='line899' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line900")'> 900:                         # Predict y</pre>
<pre id='line900' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line901")'> 901:                         v = predict(self.D, i, XS, 0, self.Tinv, self.offset, self.flat, self.Linv, self.w, self.count, self.min_sample, self.lin_spline, self.lin_w, self.lin_c, self.lin_T, self.SIZE, self.L, self.dohash, self.mem_max, self.key)</pre>
<pre id='line901' class='code' style='background-color: #FFFFff'>                                  __pyx_v_v = __pyx_f_9econlearn_8tilecode_predict(__pyx_v_self-&gt;D, __pyx_v_i, __pyx_v_XS, 0, __pyx_v_self-&gt;Tinv, __pyx_v_self-&gt;offset, __pyx_v_self-&gt;flat, __pyx_v_self-&gt;Linv, __pyx_v_self-&gt;w, __pyx_v_self-&gt;count, __pyx_v_self-&gt;min_sample, __pyx_v_self-&gt;lin_spline, __pyx_v_self-&gt;lin_w, __pyx_v_self-&gt;lin_c, __pyx_v_self-&gt;lin_T, __pyx_v_self-&gt;SIZE, __pyx_v_self-&gt;L, __pyx_v_self-&gt;dohash, __pyx_v_self-&gt;mem_max, __pyx_v_self-&gt;key);
                                }
                                __pyx_L13:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line902")'> 902: </pre>
<pre id='line902' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line903")'> 903:                     if v &gt; v_opt[i]:</pre>
<pre id='line903' class='code' style='background-color: #FFFFff'>                                __pyx_t_30 = __pyx_v_i;
                                __pyx_t_29 = ((__pyx_v_v &gt; (*((double *) ( /* dim=0 */ (__pyx_v_v_opt.data + __pyx_t_30 * __pyx_v_v_opt.strides[0]) )))) != 0);
                                if (__pyx_t_29) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line904")'> 904:                         v_opt[i] = v</pre>
<pre id='line904' class='code' style='background-color: #FFFFff'>                                  __pyx_t_31 = __pyx_v_i;
                                  *((double *) ( /* dim=0 */ (__pyx_v_v_opt.data + __pyx_t_31 * __pyx_v_v_opt.strides[0]) )) = __pyx_v_v;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line905")'> 905:                         A_opt[i] = A</pre>
<pre id='line905' class='code' style='background-color: #FFFFff'>                                  __pyx_t_32 = __pyx_v_i;
                                  *((double *) ( /* dim=0 */ (__pyx_v_A_opt.data + __pyx_t_32 * __pyx_v_A_opt.strides[0]) )) = __pyx_v_A;
                                  goto __pyx_L14;
                                }
                                __pyx_L14:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line906")'> 906: </pre>
<pre id='line906' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line907")'> 907:                     A_old = A</pre>
<pre id='line907' class='code' style='background-color: #FFFFff'>                                __pyx_v_A_old = __pyx_v_A;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line908")'> 908:                     A = A + step</pre>
<pre id='line908' class='code' style='background-color: #FFFFff'>                                __pyx_v_A = (__pyx_v_A + __pyx_v_step);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line909")'> 909:                     if A &gt; Ah[i]:</pre>
<pre id='line909' class='code' style='background-color: #FFFFff'>                                __pyx_t_33 = __pyx_v_i;
                                __pyx_t_29 = ((__pyx_v_A &gt; (*((double *) ( /* dim=0 */ (__pyx_v_Ah.data + __pyx_t_33 * __pyx_v_Ah.strides[0]) )))) != 0);
                                if (__pyx_t_29) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line910")'> 910:                         A = Ah[i]</pre>
<pre id='line910' class='code' style='background-color: #FFFFff'>                                  __pyx_t_34 = __pyx_v_i;
                                  __pyx_v_A = (*((double *) ( /* dim=0 */ (__pyx_v_Ah.data + __pyx_t_34 * __pyx_v_Ah.strides[0]) )));
                                  goto __pyx_L15;
                                }
                                __pyx_L15:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line911")'> 911:                     if A_old == Ah[i]:</pre>
<pre id='line911' class='code' style='background-color: #FFFFff'>                                __pyx_t_35 = __pyx_v_i;
                                __pyx_t_29 = ((__pyx_v_A_old == (*((double *) ( /* dim=0 */ (__pyx_v_Ah.data + __pyx_t_35 * __pyx_v_Ah.strides[0]) )))) != 0);
                                if (__pyx_t_29) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line912")'> 912:                         break</pre>
<pre id='line912' class='code' style='background-color: #FFFFff'>                                  goto __pyx_L12_break;
                                }
                              }
                              __pyx_L12_break:;
                              goto __pyx_L10;
                            }
                            /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line913")'> 913:             else:</pre>
<pre id='line913' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line914")'> 914:                 v_opt[i] = 0</pre>
<pre id='line914' class='code' style='background-color: #FFFFff'>                              __pyx_t_36 = __pyx_v_i;
                              *((double *) ( /* dim=0 */ (__pyx_v_v_opt.data + __pyx_t_36 * __pyx_v_v_opt.strides[0]) )) = 0.0;
                            }
                            __pyx_L10:;
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line915")'> 915: </pre>
<pre id='line915' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line916")'> 916:         # return values</pre>
<pre id='line916' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line917")'> 917:         index = np.array(v_opt) &gt; 0</pre>
<pre id='line917' class='code' style='background-color: #FFFF52'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 917; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 917; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_v_opt, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 917; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 917; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 917; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_int_0, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 917; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_index = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line918")'> 918:         values = np.array(v_opt)[index]</pre>
<pre id='line918' class='code' style='background-color: #FFFF52'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 918; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 918; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_v_opt, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 918; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 918; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 918; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_2, __pyx_v_index);<span class='error_goto'> if (unlikely(__pyx_t_10 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 918; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_values = __pyx_t_10;
  __pyx_t_10 = 0;
</pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line919")'> 919:         actions = np.array(A_opt)[index]</pre>
<pre id='line919' class='code' style='background-color: #FFFF52'>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 919; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 919; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_A_opt, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 919; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 919; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 919; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_10, __pyx_v_index);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 919; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_v_actions = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF37' onclick='toggleDiv("line920")'> 920:         state = np.array(X)[index, 1::]</pre>
<pre id='line920' class='code' style='background-color: #FFFF37'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 920; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 920; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_X, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 920; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 920; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 920; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 920; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_index);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_index);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_index);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice_);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_slice_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice_);
  __pyx_t_10 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_10 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 920; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_state = __pyx_t_10;
  __pyx_t_10 = 0;
/* … */
  __pyx_slice_ = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice_)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 920; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice_);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line921")'> 921: </pre>
<pre id='line921' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line922")'> 922:         return [actions, values, state, index]</pre>
<pre id='line922' class='code' style='background-color: #FFFF6a'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 922; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_actions);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 0, __pyx_v_actions);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_actions);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_values);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 1, __pyx_v_values);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_values);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_state);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 2, __pyx_v_state);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_state);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_index);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 3, __pyx_v_index);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_index);
  __pyx_r = __pyx_t_10;
  __pyx_t_10 = 0;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line923")'> 923: </pre>
<pre id='line923' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF22' onclick='toggleDiv("line924")'> 924:     def plot(self, xargs=0, showdata=False, label='', showplot=True, quad=False):</pre>
<pre id='line924' class='code' style='background-color: #FFFF22'>/* Python wrapper */
static PyObject *__pyx_pw_9econlearn_8tilecode_8Tilecode_17plot(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_9econlearn_8tilecode_8Tilecode_16plot[] = "\n        Plot the function on one dimension\n\n        Parameters\n        -----------\n        xargs : list, length = D\n            List of variable default values, set plotting dimension to 'x'\n\n        showdata : boolean, (default=False)\n            Scatter training points\n\n        label : string, (default='')\n            Series label\n\n        showplot : boolean, (default='')\n            &gt; pylab.show()\n        ";
static PyObject *__pyx_pw_9econlearn_8tilecode_8Tilecode_17plot(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_xargs = 0;
  PyObject *__pyx_v_showdata = 0;
  PyObject *__pyx_v_label = 0;
  CYTHON_UNUSED PyObject *__pyx_v_showplot = 0;
  PyObject *__pyx_v_quad = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("plot (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_xargs,&amp;__pyx_n_s_showdata,&amp;__pyx_n_s_label,&amp;__pyx_n_s_showplot,&amp;__pyx_n_s_quad,0};
    PyObject* values[5] = {0,0,0,0,0};
    values[0] = ((PyObject *)__pyx_int_0);
    values[1] = ((PyObject *)Py_False);
    values[2] = ((PyObject *)__pyx_kp_s__2);
    values[3] = ((PyObject *)Py_True);
    values[4] = ((PyObject *)Py_False);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_xargs);
          if (value) { values[0] = value; kw_args--; }
        }
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_showdata);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_label);
          if (value) { values[2] = value; kw_args--; }
        }
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_showplot);
          if (value) { values[3] = value; kw_args--; }
        }
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_quad);
          if (value) { values[4] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "plot") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_xargs = values[0];
    __pyx_v_showdata = values[1];
    __pyx_v_label = values[2];
    __pyx_v_showplot = values[3];
    __pyx_v_quad = values[4];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("plot", 0, 0, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Tilecode.plot", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9econlearn_8tilecode_8Tilecode_16plot(((struct __pyx_obj_9econlearn_8tilecode_Tilecode *)__pyx_v_self), __pyx_v_xargs, __pyx_v_showdata, __pyx_v_label, __pyx_v_showplot, __pyx_v_quad);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9econlearn_8tilecode_8Tilecode_16plot(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, PyObject *__pyx_v_xargs, PyObject *__pyx_v_showdata, PyObject *__pyx_v_label, CYTHON_UNUSED PyObject *__pyx_v_showplot, PyObject *__pyx_v_quad) {
  int __pyx_v_k;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_Xsmooth = NULL;
  PyObject *__pyx_v_Ysmooth = NULL;
  PyObject *__pyx_v_X = NULL;
  PyObject *__pyx_v_Y = NULL;
  PyObject *__pyx_v_xpoints = NULL;
  int __pyx_v_i;
  PyObject *__pyx_v_idx = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("plot", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Tilecode.plot", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Xsmooth);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Ysmooth);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xpoints);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_idx);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line925")'> 925: </pre>
<pre id='line925' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line926")'> 926:         """</pre>
<pre id='line926' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line927")'> 927:         Plot the function on one dimension</pre>
<pre id='line927' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line928")'> 928: </pre>
<pre id='line928' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line929")'> 929:         Parameters</pre>
<pre id='line929' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line930")'> 930:         -----------</pre>
<pre id='line930' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line931")'> 931:         xargs : list, length = D</pre>
<pre id='line931' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line932")'> 932:             List of variable default values, set plotting dimension to 'x'</pre>
<pre id='line932' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line933")'> 933: </pre>
<pre id='line933' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line934")'> 934:         showdata : boolean, (default=False)</pre>
<pre id='line934' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line935")'> 935:             Scatter training points</pre>
<pre id='line935' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line936")'> 936: </pre>
<pre id='line936' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line937")'> 937:         label : string, (default='')</pre>
<pre id='line937' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line938")'> 938:             Series label</pre>
<pre id='line938' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line939")'> 939: </pre>
<pre id='line939' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line940")'> 940:         showplot : boolean, (default='')</pre>
<pre id='line940' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line941")'> 941:             &gt; pylab.show()</pre>
<pre id='line941' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line942")'> 942:         """</pre>
<pre id='line942' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line943")'> 943: </pre>
<pre id='line943' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line944")'> 944:         cdef int k = 0</pre>
<pre id='line944' class='code' style='background-color: #FFFFff'>  __pyx_v_k = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line945")'> 945: </pre>
<pre id='line945' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line946")'> 946:         x = [xargs[i] for i in range(self.D)]</pre>
<pre id='line946' class='code' style='background-color: #FFFF7f'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 946; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = __pyx_v_self-&gt;D;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_xargs, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 946; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_4))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 946; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_v_x = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line947")'> 947: </pre>
<pre id='line947' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line948")'> 948:         if self.D == 1:</pre>
<pre id='line948' class='code' style='background-color: #FFFFff'>  __pyx_t_5 = ((__pyx_v_self-&gt;D == 1) != 0);
  if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line949")'> 949:             Xsmooth = np.linspace(self.b, self.a, 200)</pre>
<pre id='line949' class='code' style='background-color: #FFFF5b'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 949; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_linspace);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 949; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;b, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 949; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;a, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 949; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 949; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_200);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_int_200);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_200);
    __pyx_t_1 = 0;
    __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 949; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_v_Xsmooth = __pyx_t_6;
    __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFF7f' onclick='toggleDiv("line950")'> 950:             Ysmooth = self(Xsmooth)</pre>
<pre id='line950' class='code' style='background-color: #FFFF7f'>    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 950; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Xsmooth);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_Xsmooth);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Xsmooth);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_v_self), __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 950; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_Ysmooth = __pyx_t_7;
    __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line951")'> 951:             X = self.X</pre>
<pre id='line951' class='code' style='background-color: #FFFFff'>    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;X, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_v_X = __pyx_t_7;
    __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line952")'> 952:             Y = self.Y</pre>
<pre id='line952' class='code' style='background-color: #FFFFff'>    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;Y, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 952; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_v_Y = __pyx_t_7;
    __pyx_t_7 = 0;
</pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line953")'> 953:             pylab.plot(X, Y, 'o', Xsmooth, Ysmooth)</pre>
<pre id='line953' class='code' style='background-color: #FFFF48'>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_pylab);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 953; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_plot);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 953; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 953; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_X);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_X);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Y);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_v_Y);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Y);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_o);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_n_s_o);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_o);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Xsmooth);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 3, __pyx_v_Xsmooth);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Xsmooth);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Ysmooth);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 4, __pyx_v_Ysmooth);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Ysmooth);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 953; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L5;
  }
  /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line954")'> 954:         else:</pre>
<pre id='line954' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line955")'> 955:             k = x.index('x')</pre>
<pre id='line955' class='code' style='background-color: #FFFF6e'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_x, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 955; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 955; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_7);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 955; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_v_k = __pyx_t_2;
/* … */
  __pyx_tuple__3 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_x);<span class='error_goto'> if (unlikely(!__pyx_tuple__3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 955; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__3);
</pre><pre class='line' style='background-color: #FFFF43' onclick='toggleDiv("line956")'> 956:             Xsmooth = np.linspace(self.a[k], self.b[k], 200)</pre>
<pre id='line956' class='code' style='background-color: #FFFF43'>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 956; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_linspace);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 956; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_2 = __pyx_v_k;
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;a.data + __pyx_t_2 * __pyx_v_self-&gt;a.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 956; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_3 = __pyx_v_k;
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;b.data + __pyx_t_3 * __pyx_v_self-&gt;b.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 956; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 956; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_200);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_int_200);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_200);
    __pyx_t_7 = 0;
    __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 956; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_Xsmooth = __pyx_t_6;
    __pyx_t_6 = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line957")'> 957: </pre>
<pre id='line957' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF48' onclick='toggleDiv("line958")'> 958:             xpoints = np.ones([200, self.D])</pre>
<pre id='line958' class='code' style='background-color: #FFFF48'>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 958; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 958; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 958; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 958; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_200);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_200);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_200);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 958; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 958; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_xpoints = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line959")'> 959:             xpoints[:, k]  = 1</pre>
<pre id='line959' class='code' style='background-color: #FFFF52'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 959; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 959; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_slice__4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    __pyx_t_4 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_xpoints, __pyx_t_6, __pyx_int_1) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 959; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
  __pyx_slice__4 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 959; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__4);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line960")'> 960:             x[k] = 1</pre>
<pre id='line960' class='code' style='background-color: #FFFFd4'>    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_x, __pyx_v_k, __pyx_int_1, int, 1, __Pyx_PyInt_From_int, 1, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 960; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line961")'> 961: </pre>
<pre id='line961' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line962")'> 962:             for i in range(self.D):</pre>
<pre id='line962' class='code' style='background-color: #FFFFff'>    __pyx_t_8 = __pyx_v_self-&gt;D;
    for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_i = __pyx_t_9;
</pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line963")'> 963:                 xpoints[:, i] = xpoints[:, i] * x[i]</pre>
<pre id='line963' class='code' style='background-color: #FFFF2a'>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 963; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 963; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_slice__5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_6 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_xpoints, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_6 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 963; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_x, __pyx_v_i));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 963; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
  __pyx_slice__5 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 963; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 963; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 963; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_slice__6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      __pyx_t_6 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_xpoints, __pyx_t_1, __pyx_t_4) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 963; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
  __pyx_slice__6 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 963; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__6);
</pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line964")'> 964:             xpoints[:, k] = Xsmooth</pre>
<pre id='line964' class='code' style='background-color: #FFFF52'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 964; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 964; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_slice__7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    __pyx_t_4 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_xpoints, __pyx_t_1, __pyx_v_Xsmooth) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 964; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_slice__7 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 964; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__7);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line965")'> 965:             if quad:</pre>
<pre id='line965' class='code' style='background-color: #FFFFd4'>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_quad);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 965; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line966")'> 966:                 Ysmooth = self.predict_quad(xpoints)</pre>
<pre id='line966' class='code' style='background-color: #FFFF6e'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_predict_quad);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_xpoints);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_xpoints);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_xpoints);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 966; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_v_Ysmooth = __pyx_t_6;
      __pyx_t_6 = 0;
      goto __pyx_L8;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line967")'> 967:             else:</pre>
<pre id='line967' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line968")'> 968:                 Ysmooth = self.predict(xpoints)</pre>
<pre id='line968' class='code' style='background-color: #FFFF6e'>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_predict);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 968; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 968; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_xpoints);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_xpoints);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_xpoints);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 968; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_v_Ysmooth = __pyx_t_1;
      __pyx_t_1 = 0;
    }
    __pyx_L8:;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line969")'> 969:             idx = Ysmooth != 0</pre>
<pre id='line969' class='code' style='background-color: #FFFFaa'>    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_Ysmooth, __pyx_int_0, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 969; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_idx = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line970")'> 970:             if showdata:</pre>
<pre id='line970' class='code' style='background-color: #FFFFd4'>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_showdata);<span class='error_goto'> if (unlikely(__pyx_t_5 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 970; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (__pyx_t_5) {
</pre><pre class='line' style='background-color: #FFFF2c' onclick='toggleDiv("line971")'> 971:                 pylab.plot(self.X[:, k], self.Y, 'o', Xsmooth[idx], Ysmooth[idx], label = label)</pre>
<pre id='line971' class='code' style='background-color: #FFFF2c'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_pylab);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 971; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_plot);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 971; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_10 = __pyx_v_self-&gt;X;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_10, 1);
      __pyx_t_8 = -1;
      __pyx_t_11.data = __pyx_t_10.data;
      __pyx_t_11.memview = __pyx_t_10.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_11, 0);
      __pyx_t_11.shape[0] = __pyx_t_10.shape[0];
__pyx_t_11.strides[0] = __pyx_t_10.strides[0];
    __pyx_t_11.suboffsets[0] = -1;

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_10.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_10.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 971; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_11.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
      __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_t_11, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 971; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
      __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;Y, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 971; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_7 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_Xsmooth, __pyx_v_idx);<span class='error_goto'> if (unlikely(__pyx_t_7 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 971; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_12 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_Ysmooth, __pyx_v_idx);<span class='error_goto'> if (unlikely(__pyx_t_12 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 971; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 971; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 1, __pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_o);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 2, __pyx_n_s_o);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_o);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 3, __pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 4, __pyx_t_12);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
      __pyx_t_1 = 0;
      __pyx_t_6 = 0;
      __pyx_t_7 = 0;
      __pyx_t_12 = 0;
      __pyx_t_12 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 971; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_s_label, __pyx_v_label) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 971; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_13, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 971; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      goto __pyx_L9;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line972")'> 972:             else:</pre>
<pre id='line972' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line973")'> 973:                 pylab.plot(Xsmooth[idx], Ysmooth[idx], label = label)</pre>
<pre id='line973' class='code' style='background-color: #FFFF35'>      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_pylab);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_plot);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_Xsmooth, __pyx_v_idx);<span class='error_goto'> if (unlikely(__pyx_t_7 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_13 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_Ysmooth, __pyx_v_idx);<span class='error_goto'> if (unlikely(__pyx_t_13 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_13);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
      __pyx_t_7 = 0;
      __pyx_t_13 = 0;
      __pyx_t_13 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_13, __pyx_n_s_label, __pyx_v_label) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_4, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 973; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
    __pyx_L9:;
  }
  __pyx_L5:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line974")'> 974: </pre>
<pre id='line974' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line975")'> 975:     #==========================================================================</pre>
<pre id='line975' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line976")'> 976:     # Convenience functions</pre>
<pre id='line976' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line977")'> 977:     #===========================================================================</pre>
<pre id='line977' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line978")'> 978: </pre>
<pre id='line978' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line979")'> 979:     cdef double one_value(self, double[:] X):</pre>
<pre id='line979' class='code' style='background-color: #FFFFff'>static double __pyx_f_9econlearn_8tilecode_8Tilecode_one_value(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, __Pyx_memviewslice __pyx_v_X) {
  int __pyx_v_k;
  double __pyx_v_xs;
  int __pyx_v_extrap;
  __Pyx_memviewslice __pyx_v_XS = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_val;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("one_value", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_XS, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line980")'> 980: </pre>
<pre id='line980' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line981")'> 981:         cdef int k</pre>
<pre id='line981' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line982")'> 982:         cdef double xs</pre>
<pre id='line982' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line983")'> 983:         cdef int extrap = 0</pre>
<pre id='line983' class='code' style='background-color: #FFFFff'>  __pyx_v_extrap = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line984")'> 984:         cdef double[:,:] XS = self.xs</pre>
<pre id='line984' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_self-&gt;xs;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_XS = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line985")'> 985:         cdef double val</pre>
<pre id='line985' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line986")'> 986: </pre>
<pre id='line986' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line987")'> 987:         for k in range(self.D):</pre>
<pre id='line987' class='code' style='background-color: #FFFFff'>  __pyx_t_2 = __pyx_v_self-&gt;D;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_k = __pyx_t_3;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line988")'> 988:             xs = (X[k] - self.a[k]) * self.d[k]</pre>
<pre id='line988' class='code' style='background-color: #FFFFff'>    __pyx_t_4 = __pyx_v_k;
    __pyx_t_5 = __pyx_v_k;
    __pyx_t_6 = __pyx_v_k;
    __pyx_v_xs = (((*((double *) ( /* dim=0 */ (__pyx_v_X.data + __pyx_t_4 * __pyx_v_X.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;a.data + __pyx_t_5 * __pyx_v_self-&gt;a.strides[0]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;d.data + __pyx_t_6 * __pyx_v_self-&gt;d.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line989")'> 989:             if xs &lt; -0.0001 or xs &gt; 1.0001:</pre>
<pre id='line989' class='code' style='background-color: #FFFFff'>    __pyx_t_7 = ((__pyx_v_xs &lt; -0.0001) != 0);
    if (!__pyx_t_7) {
      __pyx_t_8 = ((__pyx_v_xs &gt; 1.0001) != 0);
      __pyx_t_9 = __pyx_t_8;
    } else {
      __pyx_t_9 = __pyx_t_7;
    }
    if (__pyx_t_9) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line990")'> 990:                 extrap = 1</pre>
<pre id='line990' class='code' style='background-color: #FFFFff'>      __pyx_v_extrap = 1;
      goto __pyx_L5;
    }
    __pyx_L5:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line991")'> 991:             XS[0, k] = xs * self.T[k]</pre>
<pre id='line991' class='code' style='background-color: #FFFFff'>    __pyx_t_10 = __pyx_v_k;
    __pyx_t_11 = 0;
    __pyx_t_12 = __pyx_v_k;
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_XS.data + __pyx_t_11 * __pyx_v_XS.strides[0]) ) + __pyx_t_12 * __pyx_v_XS.strides[1]) )) = (__pyx_v_xs * (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;T.data + __pyx_t_10 * __pyx_v_self-&gt;T.strides[0]) ))));
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line992")'> 992: </pre>
<pre id='line992' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line993")'> 993:         val = predict(self.D, 0, XS, extrap, self.Tinv, self.offset, self.flat, self.Linv, self.w, self.count, self.min_sample, self.lin_spline, self.lin_w, self.lin_c, self.lin_T, self.SIZE, self.L, self.dohash, self.mem_max, self.key)</pre>
<pre id='line993' class='code' style='background-color: #FFFFff'>  __pyx_v_val = __pyx_f_9econlearn_8tilecode_predict(__pyx_v_self-&gt;D, 0, __pyx_v_XS, __pyx_v_extrap, __pyx_v_self-&gt;Tinv, __pyx_v_self-&gt;offset, __pyx_v_self-&gt;flat, __pyx_v_self-&gt;Linv, __pyx_v_self-&gt;w, __pyx_v_self-&gt;count, __pyx_v_self-&gt;min_sample, __pyx_v_self-&gt;lin_spline, __pyx_v_self-&gt;lin_w, __pyx_v_self-&gt;lin_c, __pyx_v_self-&gt;lin_T, __pyx_v_self-&gt;SIZE, __pyx_v_self-&gt;L, __pyx_v_self-&gt;dohash, __pyx_v_self-&gt;mem_max, __pyx_v_self-&gt;key);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line994")'> 994: </pre>
<pre id='line994' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line995")'> 995:         return val</pre>
<pre id='line995' class='code' style='background-color: #FFFFff'>  __pyx_r = __pyx_v_val;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line996")'> 996: </pre>
<pre id='line996' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF96' onclick='toggleDiv("line997")'> 997:     cdef double[:] N_values(self, double[:,:] X, int N, double[:] values, double[:,:] XS):</pre>
<pre id='line997' class='code' style='background-color: #FFFF96'>static __Pyx_memviewslice __pyx_f_9econlearn_8tilecode_8Tilecode_N_values(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, __Pyx_memviewslice __pyx_v_X, int __pyx_v_N, __Pyx_memviewslice __pyx_v_values, __Pyx_memviewslice __pyx_v_XS) {
  int __pyx_v_i;
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("N_values", 0);
  __PYX_INC_MEMVIEW(&amp;__pyx_v_XS, 1);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Tilecode.N_values", __pyx_clineno, __pyx_lineno, __pyx_filename);

  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError,"Memoryview return value is not initialized");
  }
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_XS, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line998")'> 998: </pre>
<pre id='line998' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line999")'> 999:         cdef int i, k</pre>
<pre id='line999' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1000")'> 1000: </pre>
<pre id='line1000' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1001")'> 1001:         XS = self.scale_X(X, N, XS)</pre>
<pre id='line1001' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = ((struct __pyx_vtabstruct_9econlearn_8tilecode_Tilecode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;scale_X(__pyx_v_self, __pyx_v_X, __pyx_v_N, __pyx_v_XS);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1001; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_XS, 1);
  __pyx_v_XS = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1002")'> 1002: </pre>
<pre id='line1002' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1003")'> 1003:         for i in prange(N, nogil=True, num_threads=self.CORES, schedule=static):</pre>
<pre id='line1003' class='code' style='background-color: #FFFFff'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
        __pyx_t_2 = __pyx_v_N;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_4 = (__pyx_t_2 - 0) / 1;
            if (__pyx_t_4 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_i) lastprivate(__pyx_v_i)        __pyx_t_2 = __pyx_v_N;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_4 = (__pyx_t_2 - 0) / 1;
            if (__pyx_t_4 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) num_threads(__pyx_v_self-&gt;CORES)
                    #endif /* _OPENMP */
                    for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_4; __pyx_t_3++){
                        {
                            __pyx_v_i = 0 + 1 * __pyx_t_3;
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1004")'> 1004:             values[i] = predict(self.D, i, XS, 0, self.Tinv, self.offset, self.flat, self.Linv, self.w, self.count, self.min_sample, self.lin_spline, self.lin_w, self.lin_c, self.lin_T, self.SIZE, self.L, self.dohash, self.mem_max, self.key)</pre>
<pre id='line1004' class='code' style='background-color: #FFFFff'>                            __pyx_t_5 = __pyx_v_i;
                            *((double *) ( /* dim=0 */ (__pyx_v_values.data + __pyx_t_5 * __pyx_v_values.strides[0]) )) = __pyx_f_9econlearn_8tilecode_predict(__pyx_v_self-&gt;D, __pyx_v_i, __pyx_v_XS, 0, __pyx_v_self-&gt;Tinv, __pyx_v_self-&gt;offset, __pyx_v_self-&gt;flat, __pyx_v_self-&gt;Linv, __pyx_v_self-&gt;w, __pyx_v_self-&gt;count, __pyx_v_self-&gt;min_sample, __pyx_v_self-&gt;lin_spline, __pyx_v_self-&gt;lin_w, __pyx_v_self-&gt;lin_c, __pyx_v_self-&gt;lin_T, __pyx_v_self-&gt;SIZE, __pyx_v_self-&gt;L, __pyx_v_self-&gt;dohash, __pyx_v_self-&gt;mem_max, __pyx_v_self-&gt;key);
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1005")'> 1005: </pre>
<pre id='line1005' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1006")'> 1006:         return values</pre>
<pre id='line1006' class='code' style='background-color: #FFFFff'>  __PYX_INC_MEMVIEW(&amp;__pyx_v_values, 0);
  __pyx_r = __pyx_v_values;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1007")'> 1007: </pre>
<pre id='line1007' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1008")'> 1008:     cdef double[:] N_values_policy(self, double[:,:] X, int N, double[:] values):</pre>
<pre id='line1008' class='code' style='background-color: #FFFFaa'>static __Pyx_memviewslice __pyx_f_9econlearn_8tilecode_8Tilecode_N_values_policy(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, __Pyx_memviewslice __pyx_v_X, int __pyx_v_N, __Pyx_memviewslice __pyx_v_values) {
  int __pyx_v_i;
  int __pyx_v_k;
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("N_values_policy", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError,"Memoryview return value is not initialized");
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1009")'> 1009: </pre>
<pre id='line1009' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1010")'> 1010:         cdef int i, k</pre>
<pre id='line1010' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1011")'> 1011: </pre>
<pre id='line1011' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1012")'> 1012:         for i in range(N):</pre>
<pre id='line1012' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_N;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1013")'> 1013:             for k in range(self.D):</pre>
<pre id='line1013' class='code' style='background-color: #FFFFff'>    __pyx_t_3 = __pyx_v_self-&gt;D;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_k = __pyx_t_4;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1014")'> 1014:                 X[i, k] = ((X[i, k] - self.a[k]) * self.d[k]) * self.T[k]</pre>
<pre id='line1014' class='code' style='background-color: #FFFFff'>      __pyx_t_5 = __pyx_v_i;
      __pyx_t_6 = __pyx_v_k;
      __pyx_t_7 = __pyx_v_k;
      __pyx_t_8 = __pyx_v_k;
      __pyx_t_9 = __pyx_v_k;
      __pyx_t_10 = __pyx_v_i;
      __pyx_t_11 = __pyx_v_k;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_X.data + __pyx_t_10 * __pyx_v_X.strides[0]) ) + __pyx_t_11 * __pyx_v_X.strides[1]) )) = ((((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_X.data + __pyx_t_5 * __pyx_v_X.strides[0]) ) + __pyx_t_6 * __pyx_v_X.strides[1]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;a.data + __pyx_t_7 * __pyx_v_self-&gt;a.strides[0]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;d.data + __pyx_t_8 * __pyx_v_self-&gt;d.strides[0]) )))) * (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;T.data + __pyx_t_9 * __pyx_v_self-&gt;T.strides[0]) ))));
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1015")'> 1015:             values[i] = predict(self.D, i, X, 0, self.Tinv, self.offset, self.flat, self.Linv, self.w, self.count, self.min_sample, self.lin_spline, self.lin_w, self.lin_c, self.lin_T, self.SIZE, self.L, self.dohash, self.mem_max, self.key)</pre>
<pre id='line1015' class='code' style='background-color: #FFFFff'>    __pyx_t_3 = __pyx_v_i;
    *((double *) ( /* dim=0 */ (__pyx_v_values.data + __pyx_t_3 * __pyx_v_values.strides[0]) )) = __pyx_f_9econlearn_8tilecode_predict(__pyx_v_self-&gt;D, __pyx_v_i, __pyx_v_X, 0, __pyx_v_self-&gt;Tinv, __pyx_v_self-&gt;offset, __pyx_v_self-&gt;flat, __pyx_v_self-&gt;Linv, __pyx_v_self-&gt;w, __pyx_v_self-&gt;count, __pyx_v_self-&gt;min_sample, __pyx_v_self-&gt;lin_spline, __pyx_v_self-&gt;lin_w, __pyx_v_self-&gt;lin_c, __pyx_v_self-&gt;lin_T, __pyx_v_self-&gt;SIZE, __pyx_v_self-&gt;L, __pyx_v_self-&gt;dohash, __pyx_v_self-&gt;mem_max, __pyx_v_self-&gt;key);
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1016")'> 1016: </pre>
<pre id='line1016' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1017")'> 1017:         return values</pre>
<pre id='line1017' class='code' style='background-color: #FFFFff'>  __PYX_INC_MEMVIEW(&amp;__pyx_v_values, 0);
  __pyx_r = __pyx_v_values;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1018")'> 1018: </pre>
<pre id='line1018' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1019")'> 1019:     def fast_values(self, ):</pre>
<pre id='line1019' class='code' style='background-color: #FFFFaa'>/* Python wrapper */
static PyObject *__pyx_pw_9econlearn_8tilecode_8Tilecode_19fast_values(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_9econlearn_8tilecode_8Tilecode_19fast_values(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fast_values (wrapper)", 0);
  __pyx_r = __pyx_pf_9econlearn_8tilecode_8Tilecode_18fast_values(((struct __pyx_obj_9econlearn_8tilecode_Tilecode *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9econlearn_8tilecode_8Tilecode_18fast_values(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self) {
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fast_values", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Tilecode.fast_values", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1020")'> 1020: </pre>
<pre id='line1020' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1021")'> 1021:         cdef int i</pre>
<pre id='line1021' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1022")'> 1022: </pre>
<pre id='line1022' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1023")'> 1023:         for i in prange(self.XSN, nogil=True, num_threads=self.CORES, schedule=static):</pre>
<pre id='line1023' class='code' style='background-color: #FFFFff'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_self-&gt;XSN;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_i) lastprivate(__pyx_v_i)        __pyx_t_1 = __pyx_v_self-&gt;XSN;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) num_threads(__pyx_v_self-&gt;CORES)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_i = 0 + 1 * __pyx_t_2;
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1024")'> 1024: </pre>
<pre id='line1024' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1025")'> 1025:             self.fastvalues[i] = predict_fast(self.D, i, self.XS, self.extrapXS[i], self.Tinv, self.Linv, self.w, self.count, self.min_sample, self.lin_spline, self.lin_w, self.lin_c, self.lin_T, self.L, self.datastruct_reverse)</pre>
<pre id='line1025' class='code' style='background-color: #FFFFff'>                            __pyx_t_4 = __pyx_v_i;
                            __pyx_t_5 = __pyx_v_i;
                            *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;fastvalues.data + __pyx_t_5 * __pyx_v_self-&gt;fastvalues.strides[0]) )) = __pyx_f_9econlearn_8tilecode_predict_fast(__pyx_v_self-&gt;D, __pyx_v_i, __pyx_v_self-&gt;XS, (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;extrapXS.data + __pyx_t_4 * __pyx_v_self-&gt;extrapXS.strides[0]) ))), __pyx_v_self-&gt;Tinv, __pyx_v_self-&gt;Linv, __pyx_v_self-&gt;w, __pyx_v_self-&gt;count, __pyx_v_self-&gt;min_sample, __pyx_v_self-&gt;lin_spline, __pyx_v_self-&gt;lin_w, __pyx_v_self-&gt;lin_c, __pyx_v_self-&gt;lin_T, __pyx_v_self-&gt;L, __pyx_v_self-&gt;datastruct_reverse);
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1026")'> 1026: </pre>
<pre id='line1026' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF62' onclick='toggleDiv("line1027")'> 1027:         return np.array(self.fastvalues)</pre>
<pre id='line1027' class='code' style='background-color: #FFFF62'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1027; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1027; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;fastvalues, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1027; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1027; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1027; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1028")'> 1028: </pre>
<pre id='line1028' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1029")'> 1029: </pre>
<pre id='line1029' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1030")'> 1030:     cdef double[:,:] matrix_values(self,  double[:,:,:] X, int N1, int N2, double[:,:] values, double[:,:, :] XS, double[:,:] Xi):</pre>
<pre id='line1030' class='code' style='background-color: #FFFFaa'>static __Pyx_memviewslice __pyx_f_9econlearn_8tilecode_8Tilecode_matrix_values(struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_self, __Pyx_memviewslice __pyx_v_X, int __pyx_v_N1, int __pyx_v_N2, __Pyx_memviewslice __pyx_v_values, __Pyx_memviewslice __pyx_v_XS, __Pyx_memviewslice __pyx_v_Xi) {
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_k;
  double __pyx_v_xs;
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("matrix_values", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError,"Memoryview return value is not initialized");
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1031")'> 1031: </pre>
<pre id='line1031' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1032")'> 1032:         cdef int i, j, k</pre>
<pre id='line1032' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1033")'> 1033:         cdef double xs = 0</pre>
<pre id='line1033' class='code' style='background-color: #FFFFff'>  __pyx_v_xs = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1034")'> 1034: </pre>
<pre id='line1034' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1035")'> 1035:         for i in prange(N1, nogil=True, num_threads=self.CORES, schedule=static):</pre>
<pre id='line1035' class='code' style='background-color: #FFFFff'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_N1;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_xs) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_k) lastprivate(__pyx_v_j)        __pyx_t_1 = __pyx_v_N1;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for lastprivate(__pyx_v_xs) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_k) lastprivate(__pyx_v_j) num_threads(__pyx_v_self-&gt;CORES)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_i = 0 + 1 * __pyx_t_2;
                            /* Initialize private variables to invalid values */
                            __pyx_v_xs = ((double)__PYX_NAN());
                            __pyx_v_k = ((int)0xbad0bad0);
                            __pyx_v_j = ((int)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1036")'> 1036:             for j in range(N2):</pre>
<pre id='line1036' class='code' style='background-color: #FFFFff'>                            __pyx_t_4 = __pyx_v_N2;
                            for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
                              __pyx_v_j = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1037")'> 1037:                 for k in range(self.D):</pre>
<pre id='line1037' class='code' style='background-color: #FFFFff'>                              __pyx_t_6 = __pyx_v_self-&gt;D;
                              for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
                                __pyx_v_k = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1038")'> 1038:                     xs = (X[i,j,k] - self.a[k]) * self.d[k]</pre>
<pre id='line1038' class='code' style='background-color: #FFFFff'>                                __pyx_t_8 = __pyx_v_i;
                                __pyx_t_9 = __pyx_v_j;
                                __pyx_t_10 = __pyx_v_k;
                                __pyx_t_11 = __pyx_v_k;
                                __pyx_t_12 = __pyx_v_k;
                                __pyx_v_xs = (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_X.data + __pyx_t_8 * __pyx_v_X.strides[0]) ) + __pyx_t_9 * __pyx_v_X.strides[1]) ) + __pyx_t_10 * __pyx_v_X.strides[2]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;a.data + __pyx_t_11 * __pyx_v_self-&gt;a.strides[0]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;d.data + __pyx_t_12 * __pyx_v_self-&gt;d.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1039")'> 1039:                     XS[i,j,k] = xs * self.T[k]</pre>
<pre id='line1039' class='code' style='background-color: #FFFFff'>                                __pyx_t_13 = __pyx_v_k;
                                __pyx_t_14 = __pyx_v_i;
                                __pyx_t_15 = __pyx_v_j;
                                __pyx_t_16 = __pyx_v_k;
                                *((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_XS.data + __pyx_t_14 * __pyx_v_XS.strides[0]) ) + __pyx_t_15 * __pyx_v_XS.strides[1]) ) + __pyx_t_16 * __pyx_v_XS.strides[2]) )) = (__pyx_v_xs * (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;T.data + __pyx_t_13 * __pyx_v_self-&gt;T.strides[0]) ))));
                              }
                            }
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1040")'> 1040: </pre>
<pre id='line1040' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1041")'> 1041:         for i in range(N1):</pre>
<pre id='line1041' class='code' style='background-color: #FFFFff'>  __pyx_t_3 = __pyx_v_N1;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1042")'> 1042:             for j in prange(N2, nogil=True, num_threads=self.CORES, schedule=static):</pre>
<pre id='line1042' class='code' style='background-color: #FFFFff'>    {
        #ifdef WITH_THREAD
        PyThreadState *_save;
        Py_UNBLOCK_THREADS
        #endif
        /*try:*/ {
          __pyx_t_1 = __pyx_v_N2;
          if (1 == 0) abort();
          {
              #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                  #undef likely
                  #undef unlikely
                  #define likely(x)   (x)
                  #define unlikely(x) (x)
              #endif
              __pyx_t_5 = (__pyx_t_1 - 0) / 1;
              if (__pyx_t_5 &gt; 0)
              {
                  #ifdef _OPENMP
                  #pragma omp parallel
                  #endif /* _OPENMP */
                  {
                      #ifdef _OPENMP
                      #pragma omp for lastprivate(__pyx_v_k) firstprivate(__pyx_v_j) lastprivate(__pyx_v_j)          __pyx_t_1 = __pyx_v_N2;
          if (1 == 0) abort();
          {
              #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                  #undef likely
                  #undef unlikely
                  #define likely(x)   (x)
                  #define unlikely(x) (x)
              #endif
              __pyx_t_5 = (__pyx_t_1 - 0) / 1;
              if (__pyx_t_5 &gt; 0)
              {
                  #ifdef _OPENMP
                  #pragma omp parallel
                  #endif /* _OPENMP */
                  {
                      #ifdef _OPENMP
                      #pragma omp for lastprivate(__pyx_v_k) firstprivate(__pyx_v_j) lastprivate(__pyx_v_j) num_threads(__pyx_v_self-&gt;CORES)
                      #endif /* _OPENMP */
                      for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_5; __pyx_t_4++){
                          {
                              __pyx_v_j = 0 + 1 * __pyx_t_4;
                              /* Initialize private variables to invalid values */
                              __pyx_v_k = ((int)0xbad0bad0);
/* … */
        /*finally:*/ {
          /*normal exit:*/{
            #ifdef WITH_THREAD
            Py_BLOCK_THREADS
            #endif
            goto __pyx_L22;
          }
          __pyx_L22:;
        }
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1043")'> 1043:                 for k in range(self.D):</pre>
<pre id='line1043' class='code' style='background-color: #FFFFff'>                              __pyx_t_6 = __pyx_v_self-&gt;D;
                              for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
                                __pyx_v_k = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1044")'> 1044:                     Xi[j, k] = XS[i,j,k]</pre>
<pre id='line1044' class='code' style='background-color: #FFFFff'>                                __pyx_t_17 = __pyx_v_i;
                                __pyx_t_18 = __pyx_v_j;
                                __pyx_t_19 = __pyx_v_k;
                                __pyx_t_20 = __pyx_v_j;
                                __pyx_t_21 = __pyx_v_k;
                                *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Xi.data + __pyx_t_20 * __pyx_v_Xi.strides[0]) ) + __pyx_t_21 * __pyx_v_Xi.strides[1]) )) = (*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_XS.data + __pyx_t_17 * __pyx_v_XS.strides[0]) ) + __pyx_t_18 * __pyx_v_XS.strides[1]) ) + __pyx_t_19 * __pyx_v_XS.strides[2]) )));
                              }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1045")'> 1045:                 values[i, j] = predict(self.D, j, Xi, 0, self.Tinv, self.offset, self.flat, self.Linv, self.w, self.count, self.min_sample, self.lin_spline, self.lin_w, self.lin_c, self.lin_T, self.SIZE, self.L, self.dohash, self.mem_max, self.key)</pre>
<pre id='line1045' class='code' style='background-color: #FFFFff'>                              __pyx_t_6 = __pyx_v_i;
                              __pyx_t_7 = __pyx_v_j;
                              *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_values.data + __pyx_t_6 * __pyx_v_values.strides[0]) ) + __pyx_t_7 * __pyx_v_values.strides[1]) )) = __pyx_f_9econlearn_8tilecode_predict(__pyx_v_self-&gt;D, __pyx_v_j, __pyx_v_Xi, 0, __pyx_v_self-&gt;Tinv, __pyx_v_self-&gt;offset, __pyx_v_self-&gt;flat, __pyx_v_self-&gt;Linv, __pyx_v_self-&gt;w, __pyx_v_self-&gt;count, __pyx_v_self-&gt;min_sample, __pyx_v_self-&gt;lin_spline, __pyx_v_self-&gt;lin_w, __pyx_v_self-&gt;lin_c, __pyx_v_self-&gt;lin_T, __pyx_v_self-&gt;SIZE, __pyx_v_self-&gt;L, __pyx_v_self-&gt;dohash, __pyx_v_self-&gt;mem_max, __pyx_v_self-&gt;key);
                          }
                      }
                  }
              }
          }
          #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
              #undef likely
              #undef unlikely
              #define likely(x)   __builtin_expect(!!(x), 1)
              #define unlikely(x) __builtin_expect(!!(x), 0)
          #endif
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1046")'> 1046: </pre>
<pre id='line1046' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1047")'> 1047:         return values</pre>
<pre id='line1047' class='code' style='background-color: #FFFFff'>  __PYX_INC_MEMVIEW(&amp;__pyx_v_values, 0);
  __pyx_r = __pyx_v_values;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1048")'> 1048: </pre>
<pre id='line1048' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1049")'> 1049: cdef class Function_Group:</pre>
<pre id='line1049' class='code' style='background-color: #FFFFff'>struct __pyx_vtabstruct_9econlearn_8tilecode_Function_Group {
  void (*scale_X)(struct __pyx_obj_9econlearn_8tilecode_Function_Group *, __Pyx_memviewslice, int);
  __Pyx_memviewslice (*get_values)(struct __pyx_obj_9econlearn_8tilecode_Function_Group *, __Pyx_memviewslice, __Pyx_memviewslice);
};
static struct __pyx_vtabstruct_9econlearn_8tilecode_Function_Group *__pyx_vtabptr_9econlearn_8tilecode_Function_Group;

</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1050")'> 1050: </pre>
<pre id='line1050' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1051")'> 1051:     """</pre>
<pre id='line1051' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1052")'> 1052:     Container for a group of Tilecode instances (user policy functions)</pre>
<pre id='line1052' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1053")'> 1053: </pre>
<pre id='line1053' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1054")'> 1054:     Assumes all Tilecode instances use identical grids</pre>
<pre id='line1054' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1055")'> 1055: </pre>
<pre id='line1055' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1056")'> 1056:     Assumes lin_spline == 1</pre>
<pre id='line1056' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1057")'> 1057: </pre>
<pre id='line1057' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1058")'> 1058:     Assumes no hashing</pre>
<pre id='line1058' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1059")'> 1059: </pre>
<pre id='line1059' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1060")'> 1060:         Parameters</pre>
<pre id='line1060' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1061")'> 1061:         -----------</pre>
<pre id='line1061' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1062")'> 1062:         N : int</pre>
<pre id='line1062' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1063")'> 1063:             Number of users</pre>
<pre id='line1063' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1064")'> 1064: </pre>
<pre id='line1064' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1065")'> 1065:         N_low : array</pre>
<pre id='line1065' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1066")'> 1066:             Number of low reliability users</pre>
<pre id='line1066' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1067")'> 1067: </pre>
<pre id='line1067' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1068")'> 1068:         wlow: Tilecode instance</pre>
<pre id='line1068' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1069")'> 1069:             Low user policy function</pre>
<pre id='line1069' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1070")'> 1070: </pre>
<pre id='line1070' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1071")'> 1071:         whigh: Tilecode instance</pre>
<pre id='line1071' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1072")'> 1072:             High user policy function</pre>
<pre id='line1072' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1073")'> 1073: </pre>
<pre id='line1073' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1074")'> 1074:     """</pre>
<pre id='line1074' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1075")'> 1075: </pre>
<pre id='line1075' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF24' onclick='toggleDiv("line1076")'> 1076:     def __init__(self, N, N_low, Tilecode wlow, Tilecode whigh):</pre>
<pre id='line1076' class='code' style='background-color: #FFFF24'>/* Python wrapper */
static int __pyx_pw_9econlearn_8tilecode_14Function_Group_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_9econlearn_8tilecode_14Function_Group_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_N = 0;
  PyObject *__pyx_v_N_low = 0;
  struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_wlow = 0;
  struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_whigh = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_N,&amp;__pyx_n_s_N_low,&amp;__pyx_n_s_wlow,&amp;__pyx_n_s_whigh,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_N)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_N_low)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1076; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_wlow)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1076; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_whigh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1076; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1076; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_N = values[0];
    __pyx_v_N_low = values[1];
    __pyx_v_wlow = ((struct __pyx_obj_9econlearn_8tilecode_Tilecode *)values[2]);
    __pyx_v_whigh = ((struct __pyx_obj_9econlearn_8tilecode_Tilecode *)values[3]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1076; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Function_Group.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_wlow), __pyx_ptype_9econlearn_8tilecode_Tilecode, 1, "wlow", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1076; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_whigh), __pyx_ptype_9econlearn_8tilecode_Tilecode, 1, "whigh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1076; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_9econlearn_8tilecode_14Function_Group___init__(((struct __pyx_obj_9econlearn_8tilecode_Function_Group *)__pyx_v_self), __pyx_v_N, __pyx_v_N_low, __pyx_v_wlow, __pyx_v_whigh);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_9econlearn_8tilecode_14Function_Group___init__(struct __pyx_obj_9econlearn_8tilecode_Function_Group *__pyx_v_self, PyObject *__pyx_v_N, PyObject *__pyx_v_N_low, struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_wlow, struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_whigh) {
  int __pyx_v_i;
  int __pyx_v_k;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_20, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_21, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_23, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_24, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_26, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_27, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_28, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_29, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_30, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_31, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_32, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_33, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_35, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_36, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_38, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_39, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_40, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_41, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_42, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_43, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_44, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_45, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_46, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_47, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_48, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_49, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_50, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_51, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_52, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_53, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Function_Group.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1077")'> 1077: </pre>
<pre id='line1077' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1078")'> 1078:         self.N = N                                   # Number of instances (e.g., users)</pre>
<pre id='line1078' class='code' style='background-color: #FFFFd4'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_N);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1078; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self-&gt;N = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1079")'> 1079:         self.N_low = N_low</pre>
<pre id='line1079' class='code' style='background-color: #FFFFd4'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_N_low);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1079; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self-&gt;N_low = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1080")'> 1080: </pre>
<pre id='line1080' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1081")'> 1081:         # Assuming all these parameters are the same for each instance</pre>
<pre id='line1081' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1082")'> 1082: </pre>
<pre id='line1082' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1083")'> 1083:         self.D = wlow.D                              # Number of dimensions</pre>
<pre id='line1083' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_wlow-&gt;D;
  __pyx_v_self-&gt;D = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1084")'> 1084:         self.L = wlow.L                              # Number of layers</pre>
<pre id='line1084' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_wlow-&gt;L;
  __pyx_v_self-&gt;L = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1085")'> 1085:         self.T = wlow.T</pre>
<pre id='line1085' class='code' style='background-color: #FFFFff'>  __pyx_t_2 = __pyx_v_wlow-&gt;T;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;T, 0);
  __pyx_v_self-&gt;T = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1086")'> 1086:         self.flat = wlow.flat</pre>
<pre id='line1086' class='code' style='background-color: #FFFFff'>  __pyx_t_3 = __pyx_v_wlow-&gt;flat;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;flat, 0);
  __pyx_v_self-&gt;flat = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1087")'> 1087:         self.SIZE = wlow.SIZE</pre>
<pre id='line1087' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_wlow-&gt;SIZE;
  __pyx_v_self-&gt;SIZE = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1088")'> 1088:         self.offset = wlow.offset</pre>
<pre id='line1088' class='code' style='background-color: #FFFFff'>  __pyx_t_4 = __pyx_v_wlow-&gt;offset;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_4, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;offset, 0);
  __pyx_v_self-&gt;offset = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1089")'> 1089:         self.lin_SIZE = wlow.lin_SIZE</pre>
<pre id='line1089' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_wlow-&gt;lin_SIZE;
  __pyx_v_self-&gt;lin_SIZE = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1090")'> 1090:         self.lin_T = wlow.lin_T[0]</pre>
<pre id='line1090' class='code' style='background-color: #FFFFff'>  __pyx_t_5 = 0;
  __pyx_v_self-&gt;lin_T = (*((int *) ( /* dim=0 */ (__pyx_v_wlow-&gt;lin_T.data + __pyx_t_5 * __pyx_v_wlow-&gt;lin_T.strides[0]) )));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1091")'> 1091:         self.min_sample = wlow.min_sample</pre>
<pre id='line1091' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_wlow-&gt;min_sample;
  __pyx_v_self-&gt;min_sample = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1092")'> 1092:         self.Tinv = wlow.Tinv</pre>
<pre id='line1092' class='code' style='background-color: #FFFFff'>  __pyx_t_6 = __pyx_v_wlow-&gt;Tinv;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;Tinv, 0);
  __pyx_v_self-&gt;Tinv = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1093")'> 1093:         self.Linv = wlow.Linv</pre>
<pre id='line1093' class='code' style='background-color: #FFFFff'>  __pyx_t_7 = __pyx_v_wlow-&gt;Linv;
  __pyx_v_self-&gt;Linv = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1094")'> 1094:         self.mem_max = wlow.mem_max</pre>
<pre id='line1094' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_wlow-&gt;mem_max;
  __pyx_v_self-&gt;mem_max = __pyx_t_1;
</pre><pre class='line' style='background-color: #FFFF55' onclick='toggleDiv("line1095")'> 1095:         self.xs_zeros = np.zeros(self.D)</pre>
<pre id='line1095' class='code' style='background-color: #FFFF55'>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1095; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1095; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1095; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1095; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1095; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_8);
  if (unlikely(!__pyx_t_11.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1095; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;xs_zeros, 0);
  __pyx_v_self-&gt;xs_zeros = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1096")'> 1096: </pre>
<pre id='line1096' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1097")'> 1097:         # These ones vary across users</pre>
<pre id='line1097' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1098")'> 1098: </pre>
<pre id='line1098' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line1099")'> 1099:         self.a = np.zeros([self.N, self.D])</pre>
<pre id='line1099' class='code' style='background-color: #FFFF41'>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1099; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1099; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;N);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1099; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1099; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_12 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1099; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_12, 1, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  __pyx_t_8 = 0;
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1099; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
  __pyx_t_12 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1099; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_12);
  if (unlikely(!__pyx_t_13.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1099; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;a, 0);
  __pyx_v_self-&gt;a = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line1100")'> 1100:         self.b = np.zeros([self.N, self.D])</pre>
<pre id='line1100' class='code' style='background-color: #FFFF41'>  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;N);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  __pyx_t_12 = 0;
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_8);
  if (unlikely(!__pyx_t_14.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;b, 0);
  __pyx_v_self-&gt;b = __pyx_t_14;
  __pyx_t_14.memview = NULL;
  __pyx_t_14.data = NULL;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line1101")'> 1101:         self.d = np.zeros([self.N, self.D])</pre>
<pre id='line1101' class='code' style='background-color: #FFFF41'>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;N);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_12 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_12, 1, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  __pyx_t_8 = 0;
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
  __pyx_t_12 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_12);
  if (unlikely(!__pyx_t_15.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;d, 0);
  __pyx_v_self-&gt;d = __pyx_t_15;
  __pyx_t_15.memview = NULL;
  __pyx_t_15.data = NULL;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line1102")'> 1102:         self.w = np.zeros([self.N, self.mem_max])</pre>
<pre id='line1102' class='code' style='background-color: #FFFF41'>  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;N);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;mem_max);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  __pyx_t_12 = 0;
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_8);
  if (unlikely(!__pyx_t_16.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;w, 0);
  __pyx_v_self-&gt;w = __pyx_t_16;
  __pyx_t_16.memview = NULL;
  __pyx_t_16.data = NULL;
</pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line1103")'> 1103:         self.count = np.zeros([self.N, self.mem_max], dtype='int32')</pre>
<pre id='line1103' class='code' style='background-color: #FFFF33'>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;N);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;mem_max);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_12 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_12, 1, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  __pyx_t_8 = 0;
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
  __pyx_t_12 = 0;
  __pyx_t_12 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_9, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_8);
  if (unlikely(!__pyx_t_17.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;count, 0);
  __pyx_v_self-&gt;count = __pyx_t_17;
  __pyx_t_17.memview = NULL;
  __pyx_t_17.data = NULL;
</pre><pre class='line' style='background-color: #FFFF33' onclick='toggleDiv("line1104")'> 1104:         self.key = np.zeros([self.N, self.mem_max], dtype='int32')</pre>
<pre id='line1104' class='code' style='background-color: #FFFF33'>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;N);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;mem_max);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  __pyx_t_8 = 0;
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_dtype, __pyx_n_s_int32) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_9, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_8);
  if (unlikely(!__pyx_t_18.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;key, 0);
  __pyx_v_self-&gt;key = __pyx_t_18;
  __pyx_t_18.memview = NULL;
  __pyx_t_18.data = NULL;
</pre><pre class='line' style='background-color: #FFFF3c' onclick='toggleDiv("line1105")'> 1105:         self.lin_w = np.zeros([self.N, self.D, self.lin_T])</pre>
<pre id='line1105' class='code' style='background-color: #FFFF3c'>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;N);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;lin_T);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_19 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_19, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_19, 1, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_19, 2, __pyx_t_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
  __pyx_t_8 = 0;
  __pyx_t_9 = 0;
  __pyx_t_12 = 0;
  __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_19);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
  __pyx_t_19 = 0;
  __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_double</span>(__pyx_t_19);
  if (unlikely(!__pyx_t_20.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;lin_w, 0);
  __pyx_v_self-&gt;lin_w = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class='line' style='background-color: #FFFF3c' onclick='toggleDiv("line1106")'> 1106:         self.lin_c = np.zeros([self.N, self.D, self.lin_T])</pre>
<pre id='line1106' class='code' style='background-color: #FFFF3c'>  __pyx_t_19 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_19, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
  __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;N);<span class='error_goto'> if (unlikely(!__pyx_t_19)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;lin_T);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_19);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 2, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  __pyx_t_19 = 0;
  __pyx_t_10 = 0;
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_double</span>(__pyx_t_8);
  if (unlikely(!__pyx_t_21.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;lin_c, 0);
  __pyx_v_self-&gt;lin_c = __pyx_t_21;
  __pyx_t_21.memview = NULL;
  __pyx_t_21.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1107")'> 1107: </pre>
<pre id='line1107' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1108")'> 1108:         cdef int i, k, z, j</pre>
<pre id='line1108' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1109")'> 1109: </pre>
<pre id='line1109' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1110")'> 1110:         # Load parameters - Low users first</pre>
<pre id='line1110' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1111")'> 1111:         for i in range(self.N_low):</pre>
<pre id='line1111' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_self-&gt;N_low;
  for (__pyx_t_22 = 0; __pyx_t_22 &lt; __pyx_t_1; __pyx_t_22+=1) {
    __pyx_v_i = __pyx_t_22;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1112")'> 1112:             self.a[i,:] = wlow.a</pre>
<pre id='line1112' class='code' style='background-color: #FFFFaa'>    __pyx_t_23 = __pyx_v_wlow-&gt;a;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_23, 1);
    __pyx_t_13 = __pyx_v_self-&gt;a;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_13, 1);
    __pyx_t_25 = -1;
    __pyx_t_24.data = __pyx_t_13.data;
    __pyx_t_24.memview = __pyx_t_13.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_24, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_13.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_13.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_24.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_24.shape[0] = __pyx_t_13.shape[1];
__pyx_t_24.strides[0] = __pyx_t_13.strides[1];
    __pyx_t_24.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_23, __pyx_t_24, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_24, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_23, 1);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1113")'> 1113:             self.b[i,:] = wlow.b</pre>
<pre id='line1113' class='code' style='background-color: #FFFFaa'>    __pyx_t_23 = __pyx_v_wlow-&gt;b;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_23, 1);
    __pyx_t_14 = __pyx_v_self-&gt;b;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_14, 1);
    __pyx_t_25 = -1;
    __pyx_t_26.data = __pyx_t_14.data;
    __pyx_t_26.memview = __pyx_t_14.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_26, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_14.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_14.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_26.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_26.shape[0] = __pyx_t_14.shape[1];
__pyx_t_26.strides[0] = __pyx_t_14.strides[1];
    __pyx_t_26.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_23, __pyx_t_26, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_26, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_23, 1);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1114")'> 1114:             self.d[i,:] = wlow.d</pre>
<pre id='line1114' class='code' style='background-color: #FFFFaa'>    __pyx_t_23 = __pyx_v_wlow-&gt;d;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_23, 1);
    __pyx_t_15 = __pyx_v_self-&gt;d;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_15, 1);
    __pyx_t_25 = -1;
    __pyx_t_27.data = __pyx_t_15.data;
    __pyx_t_27.memview = __pyx_t_15.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_27, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_15.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_15.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_27.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_27.shape[0] = __pyx_t_15.shape[1];
__pyx_t_27.strides[0] = __pyx_t_15.strides[1];
    __pyx_t_27.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_23, __pyx_t_27, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_27, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_23, 1);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1115")'> 1115:             self.w[i, :] = wlow.w</pre>
<pre id='line1115' class='code' style='background-color: #FFFFaa'>    __pyx_t_28 = __pyx_v_wlow-&gt;w;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_28, 1);
    __pyx_t_16 = __pyx_v_self-&gt;w;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_16, 1);
    __pyx_t_25 = -1;
    __pyx_t_29.data = __pyx_t_16.data;
    __pyx_t_29.memview = __pyx_t_16.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_29, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_16.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_16.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_29.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_29.shape[0] = __pyx_t_16.shape[1];
__pyx_t_29.strides[0] = __pyx_t_16.strides[1];
    __pyx_t_29.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_28, __pyx_t_29, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_29, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_28, 1);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1116")'> 1116:             self.count[i, :] = wlow.count</pre>
<pre id='line1116' class='code' style='background-color: #FFFFaa'>    __pyx_t_30 = __pyx_v_wlow-&gt;count;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_30, 1);
    __pyx_t_17 = __pyx_v_self-&gt;count;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_17, 1);
    __pyx_t_25 = -1;
    __pyx_t_31.data = __pyx_t_17.data;
    __pyx_t_31.memview = __pyx_t_17.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_31, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_17.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_17.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1116; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_31.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_31.shape[0] = __pyx_t_17.shape[1];
__pyx_t_31.strides[0] = __pyx_t_17.strides[1];
    __pyx_t_31.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_30, __pyx_t_31, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1116; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_31, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_30, 1);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1117")'> 1117:             self.key[i, :] = wlow.key</pre>
<pre id='line1117' class='code' style='background-color: #FFFFaa'>    __pyx_t_32 = __pyx_v_wlow-&gt;key;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_32, 1);
    __pyx_t_18 = __pyx_v_self-&gt;key;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_18, 1);
    __pyx_t_25 = -1;
    __pyx_t_33.data = __pyx_t_18.data;
    __pyx_t_33.memview = __pyx_t_18.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_33, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_18.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_18.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_33.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_33.shape[0] = __pyx_t_18.shape[1];
__pyx_t_33.strides[0] = __pyx_t_18.strides[1];
    __pyx_t_33.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_32, __pyx_t_33, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_33, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_32, 1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1118")'> 1118:             for k in range(self.D):</pre>
<pre id='line1118' class='code' style='background-color: #FFFFff'>    __pyx_t_25 = __pyx_v_self-&gt;D;
    for (__pyx_t_34 = 0; __pyx_t_34 &lt; __pyx_t_25; __pyx_t_34+=1) {
      __pyx_v_k = __pyx_t_34;
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line1119")'> 1119:                 self.lin_w[i, k, :] = wlow.lin_w[k, :]</pre>
<pre id='line1119' class='code' style='background-color: #FFFF66'>      __pyx_t_35 = __pyx_v_wlow-&gt;lin_w;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_35, 1);
      __pyx_t_37 = -1;
      __pyx_t_36.data = __pyx_t_35.data;
      __pyx_t_36.memview = __pyx_t_35.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_36, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_35.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_35.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_36.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_36.shape[0] = __pyx_t_35.shape[1];
__pyx_t_36.strides[0] = __pyx_t_35.strides[1];
    __pyx_t_36.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_35, 1);
      __pyx_t_20 = __pyx_v_self-&gt;lin_w;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_20, 1);
      __pyx_t_37 = -1;
      __pyx_t_38.data = __pyx_t_20.data;
      __pyx_t_38.memview = __pyx_t_20.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_38, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_20.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_20.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_38.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_20.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_20.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_38.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_38.shape[0] = __pyx_t_20.shape[2];
__pyx_t_38.strides[0] = __pyx_t_20.strides[2];
    __pyx_t_38.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_20, 1);
      if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_36, __pyx_t_38, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_38, 1);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_36, 1);
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line1120")'> 1120:                 self.lin_c[i, k, :] = wlow.lin_c[k, :]</pre>
<pre id='line1120' class='code' style='background-color: #FFFF66'>      __pyx_t_39 = __pyx_v_wlow-&gt;lin_c;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_39, 1);
      __pyx_t_37 = -1;
      __pyx_t_40.data = __pyx_t_39.data;
      __pyx_t_40.memview = __pyx_t_39.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_40, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_39.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_39.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_40.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_40.shape[0] = __pyx_t_39.shape[1];
__pyx_t_40.strides[0] = __pyx_t_39.strides[1];
    __pyx_t_40.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_39, 1);
      __pyx_t_21 = __pyx_v_self-&gt;lin_c;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_21, 1);
      __pyx_t_37 = -1;
      __pyx_t_41.data = __pyx_t_21.data;
      __pyx_t_41.memview = __pyx_t_21.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_41, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_21.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_21.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_41.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_21.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_21.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_41.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_41.shape[0] = __pyx_t_21.shape[2];
__pyx_t_41.strides[0] = __pyx_t_21.strides[2];
    __pyx_t_41.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_21, 1);
      if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_40, __pyx_t_41, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_41, 1);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_40, 1);
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1121")'> 1121: </pre>
<pre id='line1121' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1122")'> 1122:         for i in range(self.N_low, self.N):</pre>
<pre id='line1122' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_self-&gt;N;
  for (__pyx_t_22 = __pyx_v_self-&gt;N_low; __pyx_t_22 &lt; __pyx_t_1; __pyx_t_22+=1) {
    __pyx_v_i = __pyx_t_22;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1123")'> 1123:             self.a[i,:] = whigh.a</pre>
<pre id='line1123' class='code' style='background-color: #FFFFaa'>    __pyx_t_23 = __pyx_v_whigh-&gt;a;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_23, 1);
    __pyx_t_13 = __pyx_v_self-&gt;a;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_13, 1);
    __pyx_t_25 = -1;
    __pyx_t_42.data = __pyx_t_13.data;
    __pyx_t_42.memview = __pyx_t_13.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_42, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_13.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_13.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_42.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_42.shape[0] = __pyx_t_13.shape[1];
__pyx_t_42.strides[0] = __pyx_t_13.strides[1];
    __pyx_t_42.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_23, __pyx_t_42, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_42, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_23, 1);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1124")'> 1124:             self.b[i,:] = whigh.b</pre>
<pre id='line1124' class='code' style='background-color: #FFFFaa'>    __pyx_t_23 = __pyx_v_whigh-&gt;b;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_23, 1);
    __pyx_t_14 = __pyx_v_self-&gt;b;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_14, 1);
    __pyx_t_25 = -1;
    __pyx_t_43.data = __pyx_t_14.data;
    __pyx_t_43.memview = __pyx_t_14.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_43, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_14.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_14.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_43.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_43.shape[0] = __pyx_t_14.shape[1];
__pyx_t_43.strides[0] = __pyx_t_14.strides[1];
    __pyx_t_43.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_23, __pyx_t_43, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_43, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_23, 1);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1125")'> 1125:             self.d[i,:] = whigh.d</pre>
<pre id='line1125' class='code' style='background-color: #FFFFaa'>    __pyx_t_23 = __pyx_v_whigh-&gt;d;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_23, 1);
    __pyx_t_15 = __pyx_v_self-&gt;d;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_15, 1);
    __pyx_t_25 = -1;
    __pyx_t_44.data = __pyx_t_15.data;
    __pyx_t_44.memview = __pyx_t_15.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_44, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_15.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_15.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_44.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_44.shape[0] = __pyx_t_15.shape[1];
__pyx_t_44.strides[0] = __pyx_t_15.strides[1];
    __pyx_t_44.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_23, __pyx_t_44, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1125; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_44, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_23, 1);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1126")'> 1126:             self.w[i, :] = whigh.w</pre>
<pre id='line1126' class='code' style='background-color: #FFFFaa'>    __pyx_t_28 = __pyx_v_whigh-&gt;w;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_28, 1);
    __pyx_t_16 = __pyx_v_self-&gt;w;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_16, 1);
    __pyx_t_25 = -1;
    __pyx_t_45.data = __pyx_t_16.data;
    __pyx_t_45.memview = __pyx_t_16.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_45, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_16.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_16.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_45.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_45.shape[0] = __pyx_t_16.shape[1];
__pyx_t_45.strides[0] = __pyx_t_16.strides[1];
    __pyx_t_45.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_28, __pyx_t_45, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_45, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_28, 1);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1127")'> 1127:             self.count[i, :] = whigh.count</pre>
<pre id='line1127' class='code' style='background-color: #FFFFaa'>    __pyx_t_30 = __pyx_v_whigh-&gt;count;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_30, 1);
    __pyx_t_17 = __pyx_v_self-&gt;count;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_17, 1);
    __pyx_t_25 = -1;
    __pyx_t_46.data = __pyx_t_17.data;
    __pyx_t_46.memview = __pyx_t_17.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_46, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_17.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_17.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_46.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_46.shape[0] = __pyx_t_17.shape[1];
__pyx_t_46.strides[0] = __pyx_t_17.strides[1];
    __pyx_t_46.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_30, __pyx_t_46, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_46, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_30, 1);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1128")'> 1128:             self.key[i, :] = whigh.key</pre>
<pre id='line1128' class='code' style='background-color: #FFFFaa'>    __pyx_t_32 = __pyx_v_whigh-&gt;key;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_32, 1);
    __pyx_t_18 = __pyx_v_self-&gt;key;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_18, 1);
    __pyx_t_25 = -1;
    __pyx_t_47.data = __pyx_t_18.data;
    __pyx_t_47.memview = __pyx_t_18.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_47, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_18.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_18.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_47.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_47.shape[0] = __pyx_t_18.shape[1];
__pyx_t_47.strides[0] = __pyx_t_18.strides[1];
    __pyx_t_47.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_32, __pyx_t_47, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_47, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_32, 1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1129")'> 1129:             for k in range(self.D):</pre>
<pre id='line1129' class='code' style='background-color: #FFFFff'>    __pyx_t_25 = __pyx_v_self-&gt;D;
    for (__pyx_t_34 = 0; __pyx_t_34 &lt; __pyx_t_25; __pyx_t_34+=1) {
      __pyx_v_k = __pyx_t_34;
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line1130")'> 1130:                 self.lin_w[i, k, :] = whigh.lin_w[k, :]</pre>
<pre id='line1130' class='code' style='background-color: #FFFF66'>      __pyx_t_35 = __pyx_v_whigh-&gt;lin_w;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_35, 1);
      __pyx_t_37 = -1;
      __pyx_t_48.data = __pyx_t_35.data;
      __pyx_t_48.memview = __pyx_t_35.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_48, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_35.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_35.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_48.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_48.shape[0] = __pyx_t_35.shape[1];
__pyx_t_48.strides[0] = __pyx_t_35.strides[1];
    __pyx_t_48.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_35, 1);
      __pyx_t_20 = __pyx_v_self-&gt;lin_w;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_20, 1);
      __pyx_t_37 = -1;
      __pyx_t_49.data = __pyx_t_20.data;
      __pyx_t_49.memview = __pyx_t_20.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_49, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_20.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_20.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_49.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_20.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_20.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_49.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_49.shape[0] = __pyx_t_20.shape[2];
__pyx_t_49.strides[0] = __pyx_t_20.strides[2];
    __pyx_t_49.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_20, 1);
      if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_48, __pyx_t_49, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_49, 1);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_48, 1);
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line1131")'> 1131:                 self.lin_c[i, k, :] = whigh.lin_c[k, :]</pre>
<pre id='line1131' class='code' style='background-color: #FFFF66'>      __pyx_t_39 = __pyx_v_whigh-&gt;lin_c;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_39, 1);
      __pyx_t_37 = -1;
      __pyx_t_50.data = __pyx_t_39.data;
      __pyx_t_50.memview = __pyx_t_39.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_50, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_39.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_39.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_50.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_50.shape[0] = __pyx_t_39.shape[1];
__pyx_t_50.strides[0] = __pyx_t_39.strides[1];
    __pyx_t_50.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_39, 1);
      __pyx_t_21 = __pyx_v_self-&gt;lin_c;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_21, 1);
      __pyx_t_37 = -1;
      __pyx_t_51.data = __pyx_t_21.data;
      __pyx_t_51.memview = __pyx_t_21.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_51, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_21.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_21.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_51.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_21.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_21.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_51.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_51.shape[0] = __pyx_t_21.shape[2];
__pyx_t_51.strides[0] = __pyx_t_21.strides[2];
    __pyx_t_51.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_21, 1);
      if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_50, __pyx_t_51, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_51, 1);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_50, 1);
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1132")'> 1132: </pre>
<pre id='line1132' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line1133")'> 1133:         self.w = np.ascontiguousarray(self.w)</pre>
<pre id='line1133' class='code' style='background-color: #FFFF5b'>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;w, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_8);
  if (unlikely(!__pyx_t_16.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;w, 0);
  __pyx_v_self-&gt;w = __pyx_t_16;
  __pyx_t_16.memview = NULL;
  __pyx_t_16.data = NULL;
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line1134")'> 1134:         self.count = np.ascontiguousarray(self.count)</pre>
<pre id='line1134' class='code' style='background-color: #FFFF5b'>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;count, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_8);
  if (unlikely(!__pyx_t_17.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;count, 0);
  __pyx_v_self-&gt;count = __pyx_t_17;
  __pyx_t_17.memview = NULL;
  __pyx_t_17.data = NULL;
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line1135")'> 1135:         self.key = np.ascontiguousarray(self.key)</pre>
<pre id='line1135' class='code' style='background-color: #FFFF5b'>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;key, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_8);
  if (unlikely(!__pyx_t_18.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1135; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;key, 0);
  __pyx_v_self-&gt;key = __pyx_t_18;
  __pyx_t_18.memview = NULL;
  __pyx_t_18.data = NULL;
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line1136")'> 1136:         self.lin_w = np.ascontiguousarray(self.lin_w)</pre>
<pre id='line1136' class='code' style='background-color: #FFFF5b'>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;lin_w, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_double</span>(__pyx_t_8);
  if (unlikely(!__pyx_t_20.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;lin_w, 0);
  __pyx_v_self-&gt;lin_w = __pyx_t_20;
  __pyx_t_20.memview = NULL;
  __pyx_t_20.data = NULL;
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line1137")'> 1137:         self.lin_c = np.ascontiguousarray(self.lin_c)</pre>
<pre id='line1137' class='code' style='background-color: #FFFF5b'>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;lin_c, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_double</span>(__pyx_t_8);
  if (unlikely(!__pyx_t_21.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1137; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;lin_c, 0);
  __pyx_v_self-&gt;lin_c = __pyx_t_21;
  __pyx_t_21.memview = NULL;
  __pyx_t_21.data = NULL;
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line1138")'> 1138:         self.a = np.ascontiguousarray(self.a)</pre>
<pre id='line1138' class='code' style='background-color: #FFFF5b'>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;a, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_8);
  if (unlikely(!__pyx_t_13.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1138; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;a, 0);
  __pyx_v_self-&gt;a = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line1139")'> 1139:         self.b = np.ascontiguousarray(self.b)</pre>
<pre id='line1139' class='code' style='background-color: #FFFF5b'>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;b, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_8);
  if (unlikely(!__pyx_t_14.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1139; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;b, 0);
  __pyx_v_self-&gt;b = __pyx_t_14;
  __pyx_t_14.memview = NULL;
  __pyx_t_14.data = NULL;
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line1140")'> 1140:         self.d = np.ascontiguousarray(self.d)</pre>
<pre id='line1140' class='code' style='background-color: #FFFF5b'>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;d, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_8);
  if (unlikely(!__pyx_t_15.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;d, 0);
  __pyx_v_self-&gt;d = __pyx_t_15;
  __pyx_t_15.memview = NULL;
  __pyx_t_15.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1141")'> 1141: </pre>
<pre id='line1141' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line1142")'> 1142:         self.XS = np.zeros([self.N, self.D])</pre>
<pre id='line1142' class='code' style='background-color: #FFFF41'>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;N);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
  __pyx_t_8 = 0;
  __pyx_t_12 = 0;
  __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_52 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_10);
  if (unlikely(!__pyx_t_52.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1142; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;XS, 0);
  __pyx_v_self-&gt;XS = __pyx_t_52;
  __pyx_t_52.memview = NULL;
  __pyx_t_52.data = NULL;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line1143")'> 1143:         self.extrap = np.zeros([self.N])</pre>
<pre id='line1143' class='code' style='background-color: #FFFF46'>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;N);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_9 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_53 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_9);
  if (unlikely(!__pyx_t_53.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;extrap, 0);
  __pyx_v_self-&gt;extrap = __pyx_t_53;
  __pyx_t_53.memview = NULL;
  __pyx_t_53.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1144")'> 1144: </pre>
<pre id='line1144' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF23' onclick='toggleDiv("line1145")'> 1145:     def update(self, int[:] Ilow, Tilecode wlow, int[:] Ihigh, Tilecode whigh):</pre>
<pre id='line1145' class='code' style='background-color: #FFFF23'>/* Python wrapper */
static PyObject *__pyx_pw_9econlearn_8tilecode_14Function_Group_3update(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_9econlearn_8tilecode_14Function_Group_3update(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  CYTHON_UNUSED __Pyx_memviewslice __pyx_v_Ilow = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_wlow = 0;
  CYTHON_UNUSED __Pyx_memviewslice __pyx_v_Ihigh = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_whigh = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_Ilow,&amp;__pyx_n_s_wlow,&amp;__pyx_n_s_Ihigh,&amp;__pyx_n_s_whigh,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Ilow)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_wlow)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_Ihigh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_whigh)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_Ilow = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[0]);<span class='error_goto'> if (unlikely(!__pyx_v_Ilow.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_wlow = ((struct __pyx_obj_9econlearn_8tilecode_Tilecode *)values[1]);
    __pyx_v_Ihigh = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[2]);<span class='error_goto'> if (unlikely(!__pyx_v_Ihigh.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_whigh = ((struct __pyx_obj_9econlearn_8tilecode_Tilecode *)values[3]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Function_Group.update", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_wlow), __pyx_ptype_9econlearn_8tilecode_Tilecode, 1, "wlow", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_whigh), __pyx_ptype_9econlearn_8tilecode_Tilecode, 1, "whigh", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_9econlearn_8tilecode_14Function_Group_2update(((struct __pyx_obj_9econlearn_8tilecode_Function_Group *)__pyx_v_self), __pyx_v_Ilow, __pyx_v_wlow, __pyx_v_Ihigh, __pyx_v_whigh);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9econlearn_8tilecode_14Function_Group_2update(struct __pyx_obj_9econlearn_8tilecode_Function_Group *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_Ilow, struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_wlow, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_Ihigh, struct __pyx_obj_9econlearn_8tilecode_Tilecode *__pyx_v_whigh) {
  int __pyx_v_i;
  int __pyx_v_k;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_19, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_21, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_22, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_24, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_25, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_26, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_27, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_28, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_29, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_30, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_31, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_32, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_33, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_34, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_35, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_36, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_37, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_38, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_39, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_40);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_41);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_42);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Function_Group.update", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Ilow, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Ihigh, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1146")'> 1146: </pre>
<pre id='line1146' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1147")'> 1147:         cdef int i, k, z, j, h</pre>
<pre id='line1147' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1148")'> 1148: </pre>
<pre id='line1148' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1149")'> 1149:         # Load parameters - Low users first</pre>
<pre id='line1149' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1150")'> 1150:         for i in range(self.N_low):</pre>
<pre id='line1150' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_self-&gt;N_low;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1151")'> 1151:             self.a[i,:] = wlow.a</pre>
<pre id='line1151' class='code' style='background-color: #FFFFaa'>    __pyx_t_3 = __pyx_v_wlow-&gt;a;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 1);
    __pyx_t_4 = __pyx_v_self-&gt;a;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_4, 1);
    __pyx_t_6 = -1;
    __pyx_t_5.data = __pyx_t_4.data;
    __pyx_t_5.memview = __pyx_t_4.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_5, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_4.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_4.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_5.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_5.shape[0] = __pyx_t_4.shape[1];
__pyx_t_5.strides[0] = __pyx_t_4.strides[1];
    __pyx_t_5.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_3, __pyx_t_5, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1152")'> 1152:             self.b[i,:] = wlow.b</pre>
<pre id='line1152' class='code' style='background-color: #FFFFaa'>    __pyx_t_3 = __pyx_v_wlow-&gt;b;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 1);
    __pyx_t_7 = __pyx_v_self-&gt;b;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_6 = -1;
    __pyx_t_8.data = __pyx_t_7.data;
    __pyx_t_8.memview = __pyx_t_7.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_8, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_7.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_7.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_8.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_8.shape[0] = __pyx_t_7.shape[1];
__pyx_t_8.strides[0] = __pyx_t_7.strides[1];
    __pyx_t_8.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_3, __pyx_t_8, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1153")'> 1153:             self.d[i,:] = wlow.d</pre>
<pre id='line1153' class='code' style='background-color: #FFFFaa'>    __pyx_t_3 = __pyx_v_wlow-&gt;d;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 1);
    __pyx_t_9 = __pyx_v_self-&gt;d;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_6 = -1;
    __pyx_t_10.data = __pyx_t_9.data;
    __pyx_t_10.memview = __pyx_t_9.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_10, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_9.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_9.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_10.shape[0] = __pyx_t_9.shape[1];
__pyx_t_10.strides[0] = __pyx_t_9.strides[1];
    __pyx_t_10.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_3, __pyx_t_10, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1154")'> 1154:             self.w[i, :] = wlow.w</pre>
<pre id='line1154' class='code' style='background-color: #FFFFaa'>    __pyx_t_11 = __pyx_v_wlow-&gt;w;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_11, 1);
    __pyx_t_12 = __pyx_v_self-&gt;w;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_12, 1);
    __pyx_t_6 = -1;
    __pyx_t_13.data = __pyx_t_12.data;
    __pyx_t_13.memview = __pyx_t_12.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_13, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_12.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_12.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1154; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_13.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_13.shape[0] = __pyx_t_12.shape[1];
__pyx_t_13.strides[0] = __pyx_t_12.strides[1];
    __pyx_t_13.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_11, __pyx_t_13, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1154; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1155")'> 1155:             self.count[i, :] = wlow.count</pre>
<pre id='line1155' class='code' style='background-color: #FFFFaa'>    __pyx_t_14 = __pyx_v_wlow-&gt;count;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_14, 1);
    __pyx_t_15 = __pyx_v_self-&gt;count;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_15, 1);
    __pyx_t_6 = -1;
    __pyx_t_16.data = __pyx_t_15.data;
    __pyx_t_16.memview = __pyx_t_15.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_16, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_15.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_15.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_16.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_16.shape[0] = __pyx_t_15.shape[1];
__pyx_t_16.strides[0] = __pyx_t_15.strides[1];
    __pyx_t_16.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_14, __pyx_t_16, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1156")'> 1156:             self.key[i, :] = wlow.key</pre>
<pre id='line1156' class='code' style='background-color: #FFFFaa'>    __pyx_t_17 = __pyx_v_wlow-&gt;key;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_17, 1);
    __pyx_t_18 = __pyx_v_self-&gt;key;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_18, 1);
    __pyx_t_6 = -1;
    __pyx_t_19.data = __pyx_t_18.data;
    __pyx_t_19.memview = __pyx_t_18.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_19, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_18.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_18.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_19.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_19.shape[0] = __pyx_t_18.shape[1];
__pyx_t_19.strides[0] = __pyx_t_18.strides[1];
    __pyx_t_19.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_17, __pyx_t_19, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_19, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1157")'> 1157:             for k in range(self.D):</pre>
<pre id='line1157' class='code' style='background-color: #FFFFff'>    __pyx_t_6 = __pyx_v_self-&gt;D;
    for (__pyx_t_20 = 0; __pyx_t_20 &lt; __pyx_t_6; __pyx_t_20+=1) {
      __pyx_v_k = __pyx_t_20;
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line1158")'> 1158:                 self.lin_w[i, k, :] = wlow.lin_w[k, :]</pre>
<pre id='line1158' class='code' style='background-color: #FFFF66'>      __pyx_t_21 = __pyx_v_wlow-&gt;lin_w;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_21, 1);
      __pyx_t_23 = -1;
      __pyx_t_22.data = __pyx_t_21.data;
      __pyx_t_22.memview = __pyx_t_21.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_22, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_21.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_21.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_22.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_22.shape[0] = __pyx_t_21.shape[1];
__pyx_t_22.strides[0] = __pyx_t_21.strides[1];
    __pyx_t_22.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_21, 1);
      __pyx_t_24 = __pyx_v_self-&gt;lin_w;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_24, 1);
      __pyx_t_23 = -1;
      __pyx_t_25.data = __pyx_t_24.data;
      __pyx_t_25.memview = __pyx_t_24.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_25, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_24.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_24.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_25.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_24.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_24.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_25.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_25.shape[0] = __pyx_t_24.shape[2];
__pyx_t_25.strides[0] = __pyx_t_24.strides[2];
    __pyx_t_25.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_24, 1);
      if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_22, __pyx_t_25, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_25, 1);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_22, 1);
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line1159")'> 1159:                 self.lin_c[i, k, :] = wlow.lin_c[k, :]</pre>
<pre id='line1159' class='code' style='background-color: #FFFF66'>      __pyx_t_26 = __pyx_v_wlow-&gt;lin_c;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_26, 1);
      __pyx_t_23 = -1;
      __pyx_t_27.data = __pyx_t_26.data;
      __pyx_t_27.memview = __pyx_t_26.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_27, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_26.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_26.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_27.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_27.shape[0] = __pyx_t_26.shape[1];
__pyx_t_27.strides[0] = __pyx_t_26.strides[1];
    __pyx_t_27.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_26, 1);
      __pyx_t_28 = __pyx_v_self-&gt;lin_c;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_28, 1);
      __pyx_t_23 = -1;
      __pyx_t_29.data = __pyx_t_28.data;
      __pyx_t_29.memview = __pyx_t_28.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_29, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_28.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_28.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_29.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_28.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_28.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_29.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_29.shape[0] = __pyx_t_28.shape[2];
__pyx_t_29.strides[0] = __pyx_t_28.strides[2];
    __pyx_t_29.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_28, 1);
      if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_27, __pyx_t_29, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_29, 1);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_27, 1);
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1160")'> 1160: </pre>
<pre id='line1160' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1161")'> 1161:         for i in range(self.N_low, self.N):</pre>
<pre id='line1161' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_self-&gt;N;
  for (__pyx_t_2 = __pyx_v_self-&gt;N_low; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1162")'> 1162:             self.a[i,:] = whigh.a</pre>
<pre id='line1162' class='code' style='background-color: #FFFFaa'>    __pyx_t_3 = __pyx_v_whigh-&gt;a;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 1);
    __pyx_t_4 = __pyx_v_self-&gt;a;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_4, 1);
    __pyx_t_6 = -1;
    __pyx_t_30.data = __pyx_t_4.data;
    __pyx_t_30.memview = __pyx_t_4.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_30, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_4.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_4.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_30.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_30.shape[0] = __pyx_t_4.shape[1];
__pyx_t_30.strides[0] = __pyx_t_4.strides[1];
    __pyx_t_30.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_3, __pyx_t_30, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_30, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1163")'> 1163:             self.b[i,:] = whigh.b</pre>
<pre id='line1163' class='code' style='background-color: #FFFFaa'>    __pyx_t_3 = __pyx_v_whigh-&gt;b;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 1);
    __pyx_t_7 = __pyx_v_self-&gt;b;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_6 = -1;
    __pyx_t_31.data = __pyx_t_7.data;
    __pyx_t_31.memview = __pyx_t_7.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_31, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_7.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_7.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_31.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_31.shape[0] = __pyx_t_7.shape[1];
__pyx_t_31.strides[0] = __pyx_t_7.strides[1];
    __pyx_t_31.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_3, __pyx_t_31, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_31, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1164")'> 1164:             self.d[i,:] = whigh.d</pre>
<pre id='line1164' class='code' style='background-color: #FFFFaa'>    __pyx_t_3 = __pyx_v_whigh-&gt;d;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 1);
    __pyx_t_9 = __pyx_v_self-&gt;d;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_6 = -1;
    __pyx_t_32.data = __pyx_t_9.data;
    __pyx_t_32.memview = __pyx_t_9.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_32, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_9.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_9.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_32.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_32.shape[0] = __pyx_t_9.shape[1];
__pyx_t_32.strides[0] = __pyx_t_9.strides[1];
    __pyx_t_32.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_3, __pyx_t_32, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_32, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1165")'> 1165:             self.w[i, :] = whigh.w</pre>
<pre id='line1165' class='code' style='background-color: #FFFFaa'>    __pyx_t_11 = __pyx_v_whigh-&gt;w;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_11, 1);
    __pyx_t_12 = __pyx_v_self-&gt;w;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_12, 1);
    __pyx_t_6 = -1;
    __pyx_t_33.data = __pyx_t_12.data;
    __pyx_t_33.memview = __pyx_t_12.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_33, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_12.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_12.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_33.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_33.shape[0] = __pyx_t_12.shape[1];
__pyx_t_33.strides[0] = __pyx_t_12.strides[1];
    __pyx_t_33.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_11, __pyx_t_33, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1165; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_33, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1166")'> 1166:             self.count[i, :] = whigh.count</pre>
<pre id='line1166' class='code' style='background-color: #FFFFaa'>    __pyx_t_14 = __pyx_v_whigh-&gt;count;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_14, 1);
    __pyx_t_15 = __pyx_v_self-&gt;count;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_15, 1);
    __pyx_t_6 = -1;
    __pyx_t_34.data = __pyx_t_15.data;
    __pyx_t_34.memview = __pyx_t_15.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_34, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_15.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_15.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_34.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_34.shape[0] = __pyx_t_15.shape[1];
__pyx_t_34.strides[0] = __pyx_t_15.strides[1];
    __pyx_t_34.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_14, __pyx_t_34, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1166; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_34, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
</pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1167")'> 1167:             self.key[i, :] = whigh.key</pre>
<pre id='line1167' class='code' style='background-color: #FFFFaa'>    __pyx_t_17 = __pyx_v_whigh-&gt;key;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_17, 1);
    __pyx_t_18 = __pyx_v_self-&gt;key;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_18, 1);
    __pyx_t_6 = -1;
    __pyx_t_35.data = __pyx_t_18.data;
    __pyx_t_35.memview = __pyx_t_18.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_35, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_18.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_18.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_35.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_35.shape[0] = __pyx_t_18.shape[1];
__pyx_t_35.strides[0] = __pyx_t_18.strides[1];
    __pyx_t_35.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
    if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_17, __pyx_t_35, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1167; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_35, 1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1168")'> 1168:             for k in range(self.D):</pre>
<pre id='line1168' class='code' style='background-color: #FFFFff'>    __pyx_t_6 = __pyx_v_self-&gt;D;
    for (__pyx_t_20 = 0; __pyx_t_20 &lt; __pyx_t_6; __pyx_t_20+=1) {
      __pyx_v_k = __pyx_t_20;
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line1169")'> 1169:                 self.lin_w[i, k, :] = whigh.lin_w[k, :]</pre>
<pre id='line1169' class='code' style='background-color: #FFFF66'>      __pyx_t_21 = __pyx_v_whigh-&gt;lin_w;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_21, 1);
      __pyx_t_23 = -1;
      __pyx_t_36.data = __pyx_t_21.data;
      __pyx_t_36.memview = __pyx_t_21.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_36, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_21.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_21.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1169; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_36.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_36.shape[0] = __pyx_t_21.shape[1];
__pyx_t_36.strides[0] = __pyx_t_21.strides[1];
    __pyx_t_36.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_21, 1);
      __pyx_t_24 = __pyx_v_self-&gt;lin_w;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_24, 1);
      __pyx_t_23 = -1;
      __pyx_t_37.data = __pyx_t_24.data;
      __pyx_t_37.memview = __pyx_t_24.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_37, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_24.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_24.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1169; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_37.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_24.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_24.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1169; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_37.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_37.shape[0] = __pyx_t_24.shape[2];
__pyx_t_37.strides[0] = __pyx_t_24.strides[2];
    __pyx_t_37.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_24, 1);
      if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_36, __pyx_t_37, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1169; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_37, 1);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_36, 1);
</pre><pre class='line' style='background-color: #FFFF66' onclick='toggleDiv("line1170")'> 1170:                 self.lin_c[i, k, :] = whigh.lin_c[k, :]</pre>
<pre id='line1170' class='code' style='background-color: #FFFF66'>      __pyx_t_26 = __pyx_v_whigh-&gt;lin_c;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_26, 1);
      __pyx_t_23 = -1;
      __pyx_t_38.data = __pyx_t_26.data;
      __pyx_t_38.memview = __pyx_t_26.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_38, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_26.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_26.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_38.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_38.shape[0] = __pyx_t_26.shape[1];
__pyx_t_38.strides[0] = __pyx_t_26.strides[1];
    __pyx_t_38.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_26, 1);
      __pyx_t_28 = __pyx_v_self-&gt;lin_c;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_28, 1);
      __pyx_t_23 = -1;
      __pyx_t_39.data = __pyx_t_28.data;
      __pyx_t_39.memview = __pyx_t_28.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_39, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_28.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_28.strides[0];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 0)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_39.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_k;
    Py_ssize_t __pyx_tmp_shape = __pyx_t_28.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_t_28.strides[1];
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0))
        __pyx_tmp_idx += __pyx_tmp_shape;
    if (0 &amp;&amp; (__pyx_tmp_idx &lt; 0 || __pyx_tmp_idx &gt;= __pyx_tmp_shape)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError, "Index out of bounds (axis 1)");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
        __pyx_t_39.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_39.shape[0] = __pyx_t_28.shape[2];
__pyx_t_39.strides[0] = __pyx_t_28.strides[2];
    __pyx_t_39.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_t_28, 1);
      if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_38, __pyx_t_39, 1, 1, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_39, 1);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_38, 1);
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1171")'> 1171: </pre>
<pre id='line1171' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line1172")'> 1172:         self.w = np.ascontiguousarray(self.w)</pre>
<pre id='line1172' class='code' style='background-color: #FFFF5b'>  __pyx_t_40 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  __pyx_t_41 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_40, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_41)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_41);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_40); __pyx_t_40 = 0;
  __pyx_t_40 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;w, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  __pyx_t_42 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_42)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_42);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_42, 0, __pyx_t_40);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_40);
  __pyx_t_40 = 0;
  __pyx_t_40 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_41, __pyx_t_42, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_41); __pyx_t_41 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_42); __pyx_t_42 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_40);
  if (unlikely(!__pyx_t_12.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_40); __pyx_t_40 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;w, 0);
  __pyx_v_self-&gt;w = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line1173")'> 1173:         self.count = np.ascontiguousarray(self.count)</pre>
<pre id='line1173' class='code' style='background-color: #FFFF5b'>  __pyx_t_40 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  __pyx_t_42 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_40, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_42)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_42);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_40); __pyx_t_40 = 0;
  __pyx_t_40 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;count, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  __pyx_t_41 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_41)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_41);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_41, 0, __pyx_t_40);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_40);
  __pyx_t_40 = 0;
  __pyx_t_40 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_42, __pyx_t_41, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_42); __pyx_t_42 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_41); __pyx_t_41 = 0;
  __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_40);
  if (unlikely(!__pyx_t_15.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1173; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_40); __pyx_t_40 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;count, 0);
  __pyx_v_self-&gt;count = __pyx_t_15;
  __pyx_t_15.memview = NULL;
  __pyx_t_15.data = NULL;
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line1174")'> 1174:         self.key = np.ascontiguousarray(self.key)</pre>
<pre id='line1174' class='code' style='background-color: #FFFF5b'>  __pyx_t_40 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  __pyx_t_41 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_40, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_41)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_41);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_40); __pyx_t_40 = 0;
  __pyx_t_40 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;key, 2, (PyObject *(*)(char *)) __pyx_memview_get_int, (int (*)(char *, PyObject *)) __pyx_memview_set_int, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  __pyx_t_42 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_42)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_42);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_42, 0, __pyx_t_40);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_40);
  __pyx_t_40 = 0;
  __pyx_t_40 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_41, __pyx_t_42, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_41); __pyx_t_41 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_42); __pyx_t_42 = 0;
  __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(__pyx_t_40);
  if (unlikely(!__pyx_t_18.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1174; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_40); __pyx_t_40 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;key, 0);
  __pyx_v_self-&gt;key = __pyx_t_18;
  __pyx_t_18.memview = NULL;
  __pyx_t_18.data = NULL;
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line1175")'> 1175:         self.lin_w = np.ascontiguousarray(self.lin_w)</pre>
<pre id='line1175' class='code' style='background-color: #FFFF5b'>  __pyx_t_40 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  __pyx_t_42 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_40, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_42)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_42);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_40); __pyx_t_40 = 0;
  __pyx_t_40 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;lin_w, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  __pyx_t_41 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_41)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_41);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_41, 0, __pyx_t_40);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_40);
  __pyx_t_40 = 0;
  __pyx_t_40 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_42, __pyx_t_41, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_42); __pyx_t_42 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_41); __pyx_t_41 = 0;
  __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_double</span>(__pyx_t_40);
  if (unlikely(!__pyx_t_24.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_40); __pyx_t_40 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;lin_w, 0);
  __pyx_v_self-&gt;lin_w = __pyx_t_24;
  __pyx_t_24.memview = NULL;
  __pyx_t_24.data = NULL;
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line1176")'> 1176:         self.lin_c = np.ascontiguousarray(self.lin_c)</pre>
<pre id='line1176' class='code' style='background-color: #FFFF5b'>  __pyx_t_40 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  __pyx_t_41 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_40, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_41)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_41);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_40); __pyx_t_40 = 0;
  __pyx_t_40 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;lin_c, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  __pyx_t_42 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_42)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_42);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_42, 0, __pyx_t_40);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_40);
  __pyx_t_40 = 0;
  __pyx_t_40 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_41, __pyx_t_42, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_41); __pyx_t_41 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_42); __pyx_t_42 = 0;
  __pyx_t_28 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_double</span>(__pyx_t_40);
  if (unlikely(!__pyx_t_28.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1176; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_40); __pyx_t_40 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;lin_c, 0);
  __pyx_v_self-&gt;lin_c = __pyx_t_28;
  __pyx_t_28.memview = NULL;
  __pyx_t_28.data = NULL;
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line1177")'> 1177:         self.a = np.ascontiguousarray(self.a)</pre>
<pre id='line1177' class='code' style='background-color: #FFFF5b'>  __pyx_t_40 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  __pyx_t_42 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_40, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_42)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_42);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_40); __pyx_t_40 = 0;
  __pyx_t_40 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;a, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  __pyx_t_41 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_41)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_41);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_41, 0, __pyx_t_40);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_40);
  __pyx_t_40 = 0;
  __pyx_t_40 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_42, __pyx_t_41, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_42); __pyx_t_42 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_41); __pyx_t_41 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_40);
  if (unlikely(!__pyx_t_4.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_40); __pyx_t_40 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;a, 0);
  __pyx_v_self-&gt;a = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line1178")'> 1178:         self.b = np.ascontiguousarray(self.b)</pre>
<pre id='line1178' class='code' style='background-color: #FFFF5b'>  __pyx_t_40 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  __pyx_t_41 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_40, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_41)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_41);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_40); __pyx_t_40 = 0;
  __pyx_t_40 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;b, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  __pyx_t_42 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_42)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_42);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_42, 0, __pyx_t_40);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_40);
  __pyx_t_40 = 0;
  __pyx_t_40 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_41, __pyx_t_42, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_41); __pyx_t_41 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_42); __pyx_t_42 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_40);
  if (unlikely(!__pyx_t_7.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1178; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_40); __pyx_t_40 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;b, 0);
  __pyx_v_self-&gt;b = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class='line' style='background-color: #FFFF5b' onclick='toggleDiv("line1179")'> 1179:         self.d = np.ascontiguousarray(self.d)</pre>
<pre id='line1179' class='code' style='background-color: #FFFF5b'>  __pyx_t_40 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  __pyx_t_42 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_40, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_42)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_42);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_40); __pyx_t_40 = 0;
  __pyx_t_40 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;d, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  __pyx_t_41 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_41)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_41);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_41, 0, __pyx_t_40);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_40);
  __pyx_t_40 = 0;
  __pyx_t_40 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_42, __pyx_t_41, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_40)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_40);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_42); __pyx_t_42 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_41); __pyx_t_41 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_40);
  if (unlikely(!__pyx_t_9.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1179; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_40); __pyx_t_40 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;d, 0);
  __pyx_v_self-&gt;d = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1180")'> 1180: </pre>
<pre id='line1180' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF9f' onclick='toggleDiv("line1181")'> 1181:     def predict(self, X):</pre>
<pre id='line1181' class='code' style='background-color: #FFFF9f'>/* Python wrapper */
static PyObject *__pyx_pw_9econlearn_8tilecode_14Function_Group_5predict(PyObject *__pyx_v_self, PyObject *__pyx_v_X); /*proto*/
static PyObject *__pyx_pw_9econlearn_8tilecode_14Function_Group_5predict(PyObject *__pyx_v_self, PyObject *__pyx_v_X) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("predict (wrapper)", 0);
  __pyx_r = __pyx_pf_9econlearn_8tilecode_14Function_Group_4predict(((struct __pyx_obj_9econlearn_8tilecode_Function_Group *)__pyx_v_self), ((PyObject *)__pyx_v_X));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9econlearn_8tilecode_14Function_Group_4predict(struct __pyx_obj_9econlearn_8tilecode_Function_Group *__pyx_v_self, PyObject *__pyx_v_X) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("predict", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Function_Group.predict", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1182")'> 1182: </pre>
<pre id='line1182' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line1183")'> 1183:         return np.array(self.get_values(X, np.zeros(self.N)))</pre>
<pre id='line1183' class='code' style='background-color: #FFFF35'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_v_X);
  if (unlikely(!__pyx_t_3.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1);
  if (unlikely(!__pyx_t_6.memview)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_7 = ((struct __pyx_vtabstruct_9econlearn_8tilecode_Function_Group *)__pyx_v_self-&gt;__pyx_vtab)-&gt;get_values(__pyx_v_self, __pyx_t_3, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_t_7, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1183; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1184")'> 1184: </pre>
<pre id='line1184' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1185")'> 1185:     cdef void scale_X(self, double[:,:] X, int N):</pre>
<pre id='line1185' class='code' style='background-color: #FFFFff'>static void __pyx_f_9econlearn_8tilecode_14Function_Group_scale_X(struct __pyx_obj_9econlearn_8tilecode_Function_Group *__pyx_v_self, __Pyx_memviewslice __pyx_v_X, int __pyx_v_N) {
  int __pyx_v_i;
  int __pyx_v_k;
  double __pyx_v_xs;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("scale_X", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1186")'> 1186: </pre>
<pre id='line1186' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1187")'> 1187:         cdef int i, k</pre>
<pre id='line1187' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1188")'> 1188:         cdef double xs</pre>
<pre id='line1188' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1189")'> 1189: </pre>
<pre id='line1189' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1190")'> 1190:         for i in range(N):</pre>
<pre id='line1190' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_N;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1191")'> 1191:             self.extrap[i] = 0</pre>
<pre id='line1191' class='code' style='background-color: #FFFFff'>    __pyx_t_3 = __pyx_v_i;
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;extrap.data + __pyx_t_3 * __pyx_v_self-&gt;extrap.strides[0]) )) = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1192")'> 1192:             for k in range(self.D):</pre>
<pre id='line1192' class='code' style='background-color: #FFFFff'>    __pyx_t_4 = __pyx_v_self-&gt;D;
    for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
      __pyx_v_k = __pyx_t_5;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1193")'> 1193:                 xs = (X[i, k] - self.a[i, k]) * self.d[i, k]</pre>
<pre id='line1193' class='code' style='background-color: #FFFFff'>      __pyx_t_6 = __pyx_v_i;
      __pyx_t_7 = __pyx_v_k;
      __pyx_t_8 = __pyx_v_i;
      __pyx_t_9 = __pyx_v_k;
      __pyx_t_10 = __pyx_v_i;
      __pyx_t_11 = __pyx_v_k;
      __pyx_v_xs = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_X.data + __pyx_t_6 * __pyx_v_X.strides[0]) ) + __pyx_t_7 * __pyx_v_X.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;a.data + __pyx_t_8 * __pyx_v_self-&gt;a.strides[0]) ) + __pyx_t_9 * __pyx_v_self-&gt;a.strides[1]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;d.data + __pyx_t_10 * __pyx_v_self-&gt;d.strides[0]) ) + __pyx_t_11 * __pyx_v_self-&gt;d.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1194")'> 1194:                 if xs &lt; -0.0001 or xs &gt; 1.0001:</pre>
<pre id='line1194' class='code' style='background-color: #FFFFff'>      __pyx_t_12 = ((__pyx_v_xs &lt; -0.0001) != 0);
      if (!__pyx_t_12) {
        __pyx_t_13 = ((__pyx_v_xs &gt; 1.0001) != 0);
        __pyx_t_14 = __pyx_t_13;
      } else {
        __pyx_t_14 = __pyx_t_12;
      }
      if (__pyx_t_14) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1195")'> 1195:                     self.extrap[i] = 1</pre>
<pre id='line1195' class='code' style='background-color: #FFFFff'>        __pyx_t_15 = __pyx_v_i;
        *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;extrap.data + __pyx_t_15 * __pyx_v_self-&gt;extrap.strides[0]) )) = 1.0;
        goto __pyx_L7;
      }
      __pyx_L7:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1196")'> 1196:                 self.XS[i, k] = xs * self.T[k]</pre>
<pre id='line1196' class='code' style='background-color: #FFFFff'>      __pyx_t_16 = __pyx_v_k;
      __pyx_t_17 = __pyx_v_i;
      __pyx_t_18 = __pyx_v_k;
      *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;XS.data + __pyx_t_17 * __pyx_v_self-&gt;XS.strides[0]) ) + __pyx_t_18 * __pyx_v_self-&gt;XS.strides[1]) )) = (__pyx_v_xs * (*((int *) ( /* dim=0 */ (__pyx_v_self-&gt;T.data + __pyx_t_16 * __pyx_v_self-&gt;T.strides[0]) ))));
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1197")'> 1197: </pre>
<pre id='line1197' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFaa' onclick='toggleDiv("line1198")'> 1198:     cdef double[:] get_values(self, double[:,:] X, double[:] values):</pre>
<pre id='line1198' class='code' style='background-color: #FFFFaa'>static __Pyx_memviewslice __pyx_f_9econlearn_8tilecode_14Function_Group_get_values(struct __pyx_obj_9econlearn_8tilecode_Function_Group *__pyx_v_self, __Pyx_memviewslice __pyx_v_X, __Pyx_memviewslice __pyx_v_values) {
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_k;
  double __pyx_v_y;
  int __pyx_v_idx;
  double __pyx_v_x;
  double __pyx_v_extrap;
  __Pyx_memviewslice __pyx_v_xs = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_T = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_w = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_offset = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_flat = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_SIZE;
  __Pyx_memviewslice __pyx_v_count = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_a = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_d = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_L;
  __Pyx_memviewslice __pyx_v_Tinv = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_lin_T;
  __Pyx_memviewslice __pyx_v_lin_w = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_lin_c = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_Linv;
  int __pyx_v_D;
  int __pyx_v_N;
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_values", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError,"Memoryview return value is not initialized");
  }
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xs, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_T, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_w, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_offset, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_flat, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_count, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_a, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_d, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Tinv, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_lin_w, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_lin_c, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1199")'> 1199: </pre>
<pre id='line1199' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1200")'> 1200:         cdef int i, j, k</pre>
<pre id='line1200' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1201")'> 1201:         cdef double y = 0</pre>
<pre id='line1201' class='code' style='background-color: #FFFFff'>  __pyx_v_y = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1202")'> 1202:         cdef int idx = 0</pre>
<pre id='line1202' class='code' style='background-color: #FFFFff'>  __pyx_v_idx = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1203")'> 1203:         cdef double x = 0</pre>
<pre id='line1203' class='code' style='background-color: #FFFFff'>  __pyx_v_x = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1204")'> 1204:         cdef double extrap = 0</pre>
<pre id='line1204' class='code' style='background-color: #FFFFff'>  __pyx_v_extrap = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1205")'> 1205:         cdef double[:] xs = self.xs_zeros</pre>
<pre id='line1205' class='code' style='background-color: #FFFFff'>  __pyx_t_1 = __pyx_v_self-&gt;xs_zeros;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_v_xs = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1206")'> 1206:         cdef int[:] T = self.T</pre>
<pre id='line1206' class='code' style='background-color: #FFFFff'>  __pyx_t_2 = __pyx_v_self-&gt;T;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_v_T = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1207")'> 1207:         cdef double[:,:] w = self.w</pre>
<pre id='line1207' class='code' style='background-color: #FFFFff'>  __pyx_t_3 = __pyx_v_self-&gt;w;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_v_w = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1208")'> 1208:         cdef double[:,:] offset = self.offset</pre>
<pre id='line1208' class='code' style='background-color: #FFFFff'>  __pyx_t_4 = __pyx_v_self-&gt;offset;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_4, 1);
  __pyx_v_offset = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1209")'> 1209:         cdef int[:] flat = self.flat</pre>
<pre id='line1209' class='code' style='background-color: #FFFFff'>  __pyx_t_5 = __pyx_v_self-&gt;flat;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_5, 1);
  __pyx_v_flat = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1210")'> 1210:         cdef int SIZE = self.SIZE</pre>
<pre id='line1210' class='code' style='background-color: #FFFFff'>  __pyx_t_6 = __pyx_v_self-&gt;SIZE;
  __pyx_v_SIZE = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1211")'> 1211:         cdef int[:,:] count = self.count</pre>
<pre id='line1211' class='code' style='background-color: #FFFFff'>  __pyx_t_7 = __pyx_v_self-&gt;count;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 1);
  __pyx_v_count = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1212")'> 1212:         cdef double[:,:] a = self.a</pre>
<pre id='line1212' class='code' style='background-color: #FFFFff'>  __pyx_t_8 = __pyx_v_self-&gt;a;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_8, 1);
  __pyx_v_a = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1213")'> 1213:         cdef double[:,:] d = self.d</pre>
<pre id='line1213' class='code' style='background-color: #FFFFff'>  __pyx_t_9 = __pyx_v_self-&gt;d;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 1);
  __pyx_v_d = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1214")'> 1214:         cdef int L = self.L</pre>
<pre id='line1214' class='code' style='background-color: #FFFFff'>  __pyx_t_6 = __pyx_v_self-&gt;L;
  __pyx_v_L = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1215")'> 1215:         cdef double[:] Tinv = self.Tinv</pre>
<pre id='line1215' class='code' style='background-color: #FFFFff'>  __pyx_t_10 = __pyx_v_self-&gt;Tinv;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_10, 1);
  __pyx_v_Tinv = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1216")'> 1216:         cdef int lin_T = self.lin_T</pre>
<pre id='line1216' class='code' style='background-color: #FFFFff'>  __pyx_t_6 = __pyx_v_self-&gt;lin_T;
  __pyx_v_lin_T = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1217")'> 1217:         cdef double[:,:,:] lin_w = self.lin_w</pre>
<pre id='line1217' class='code' style='background-color: #FFFFff'>  __pyx_t_11 = __pyx_v_self-&gt;lin_w;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_11, 1);
  __pyx_v_lin_w = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1218")'> 1218:         cdef double[:,:,:] lin_c = self.lin_c</pre>
<pre id='line1218' class='code' style='background-color: #FFFFff'>  __pyx_t_12 = __pyx_v_self-&gt;lin_c;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_12, 1);
  __pyx_v_lin_c = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1219")'> 1219:         cdef double Linv = self.Linv</pre>
<pre id='line1219' class='code' style='background-color: #FFFFff'>  __pyx_t_13 = __pyx_v_self-&gt;Linv;
  __pyx_v_Linv = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1220")'> 1220:         cdef int D = self.D</pre>
<pre id='line1220' class='code' style='background-color: #FFFFff'>  __pyx_t_6 = __pyx_v_self-&gt;D;
  __pyx_v_D = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1221")'> 1221:         cdef int N = self.N</pre>
<pre id='line1221' class='code' style='background-color: #FFFFff'>  __pyx_t_6 = __pyx_v_self-&gt;N;
  __pyx_v_N = __pyx_t_6;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1222")'> 1222: </pre>
<pre id='line1222' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1223")'> 1223: </pre>
<pre id='line1223' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1224")'> 1224:         for i in range(N):</pre>
<pre id='line1224' class='code' style='background-color: #FFFFff'>  __pyx_t_6 = __pyx_v_N;
  for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_6; __pyx_t_14+=1) {
    __pyx_v_i = __pyx_t_14;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1225")'> 1225: </pre>
<pre id='line1225' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1226")'> 1226:             y = 0</pre>
<pre id='line1226' class='code' style='background-color: #FFFFff'>    __pyx_v_y = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1227")'> 1227:             extrap = 0</pre>
<pre id='line1227' class='code' style='background-color: #FFFFff'>    __pyx_v_extrap = 0.0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1228")'> 1228: </pre>
<pre id='line1228' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1229")'> 1229:             for k in range(D):</pre>
<pre id='line1229' class='code' style='background-color: #FFFFff'>    __pyx_t_15 = __pyx_v_D;
    for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_15; __pyx_t_16+=1) {
      __pyx_v_k = __pyx_t_16;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1230")'> 1230:                 x = ((X[i, k] - a[i, k]) * d[i, k] )</pre>
<pre id='line1230' class='code' style='background-color: #FFFFff'>      __pyx_t_17 = __pyx_v_i;
      __pyx_t_18 = __pyx_v_k;
      __pyx_t_19 = __pyx_v_i;
      __pyx_t_20 = __pyx_v_k;
      __pyx_t_21 = __pyx_v_i;
      __pyx_t_22 = __pyx_v_k;
      __pyx_v_x = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_X.data + __pyx_t_17 * __pyx_v_X.strides[0]) ) + __pyx_t_18 * __pyx_v_X.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_a.data + __pyx_t_19 * __pyx_v_a.strides[0]) ) + __pyx_t_20 * __pyx_v_a.strides[1]) )))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_d.data + __pyx_t_21 * __pyx_v_d.strides[0]) ) + __pyx_t_22 * __pyx_v_d.strides[1]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1231")'> 1231:                 if x &lt; -0.0001 or x &gt; 1.0001:</pre>
<pre id='line1231' class='code' style='background-color: #FFFFff'>      __pyx_t_23 = ((__pyx_v_x &lt; -0.0001) != 0);
      if (!__pyx_t_23) {
        __pyx_t_24 = ((__pyx_v_x &gt; 1.0001) != 0);
        __pyx_t_25 = __pyx_t_24;
      } else {
        __pyx_t_25 = __pyx_t_23;
      }
      if (__pyx_t_25) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1232")'> 1232:                     extrap = 1</pre>
<pre id='line1232' class='code' style='background-color: #FFFFff'>        __pyx_v_extrap = 1.0;
        goto __pyx_L7;
      }
      __pyx_L7:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1233")'> 1233:                 xs[k] = x * T[k]</pre>
<pre id='line1233' class='code' style='background-color: #FFFFff'>      __pyx_t_26 = __pyx_v_k;
      __pyx_t_27 = __pyx_v_k;
      *((double *) ( /* dim=0 */ (__pyx_v_xs.data + __pyx_t_27 * __pyx_v_xs.strides[0]) )) = (__pyx_v_x * (*((int *) ( /* dim=0 */ (__pyx_v_T.data + __pyx_t_26 * __pyx_v_T.strides[0]) ))));
    }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1234")'> 1234: </pre>
<pre id='line1234' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1235")'> 1235:             if extrap == 0:</pre>
<pre id='line1235' class='code' style='background-color: #FFFFff'>    __pyx_t_25 = ((__pyx_v_extrap == 0.0) != 0);
    if (__pyx_t_25) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1236")'> 1236:                 for j in range(L):</pre>
<pre id='line1236' class='code' style='background-color: #FFFFff'>      __pyx_t_15 = __pyx_v_L;
      for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_15; __pyx_t_16+=1) {
        __pyx_v_j = __pyx_t_16;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1237")'> 1237:                     idx = 0</pre>
<pre id='line1237' class='code' style='background-color: #FFFFff'>        __pyx_v_idx = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1238")'> 1238:                     for k in range(D):</pre>
<pre id='line1238' class='code' style='background-color: #FFFFff'>        __pyx_t_28 = __pyx_v_D;
        for (__pyx_t_29 = 0; __pyx_t_29 &lt; __pyx_t_28; __pyx_t_29+=1) {
          __pyx_v_k = __pyx_t_29;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1239")'> 1239:                         idx +=  c_int(xs[k] + offset[j, k]) * flat[k]</pre>
<pre id='line1239' class='code' style='background-color: #FFFFff'>          __pyx_t_30 = __pyx_v_k;
          __pyx_t_31 = __pyx_v_j;
          __pyx_t_32 = __pyx_v_k;
          __pyx_t_33 = __pyx_v_k;
          __pyx_v_idx = (__pyx_v_idx + (Real2Int(((*((double *) ( /* dim=0 */ (__pyx_v_xs.data + __pyx_t_30 * __pyx_v_xs.strides[0]) ))) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_offset.data + __pyx_t_31 * __pyx_v_offset.strides[0]) ) + __pyx_t_32 * __pyx_v_offset.strides[1]) ))))) * (*((int *) ( /* dim=0 */ (__pyx_v_flat.data + __pyx_t_33 * __pyx_v_flat.strides[0]) )))));
        }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1240")'> 1240:                     idx += SIZE * j</pre>
<pre id='line1240' class='code' style='background-color: #FFFFff'>        __pyx_v_idx = (__pyx_v_idx + (__pyx_v_SIZE * __pyx_v_j));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1241")'> 1241: </pre>
<pre id='line1241' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1242")'> 1242:                     if count[i, idx] &gt; 0:</pre>
<pre id='line1242' class='code' style='background-color: #FFFFff'>        __pyx_t_28 = __pyx_v_i;
        __pyx_t_29 = __pyx_v_idx;
        __pyx_t_25 = (((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_count.data + __pyx_t_28 * __pyx_v_count.strides[0]) ) + __pyx_t_29 * __pyx_v_count.strides[1]) ))) &gt; 0) != 0);
        if (__pyx_t_25) {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1243")'> 1243:                         y += w[i, idx]</pre>
<pre id='line1243' class='code' style='background-color: #FFFFff'>          __pyx_t_34 = __pyx_v_i;
          __pyx_t_35 = __pyx_v_idx;
          __pyx_v_y = (__pyx_v_y + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_w.data + __pyx_t_34 * __pyx_v_w.strides[0]) ) + __pyx_t_35 * __pyx_v_w.strides[1]) ))));
          goto __pyx_L13;
        }
        /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1244")'> 1244:                     else:</pre>
<pre id='line1244' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1245")'> 1245:                         # Linear value</pre>
<pre id='line1245' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1246")'> 1246:                         idx = 0</pre>
<pre id='line1246' class='code' style='background-color: #FFFFff'>          __pyx_v_idx = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1247")'> 1247:                         for k in range(D):</pre>
<pre id='line1247' class='code' style='background-color: #FFFFff'>          __pyx_t_36 = __pyx_v_D;
          for (__pyx_t_37 = 0; __pyx_t_37 &lt; __pyx_t_36; __pyx_t_37+=1) {
            __pyx_v_k = __pyx_t_37;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1248")'> 1248:                             x = xs[k] * Tinv[k]</pre>
<pre id='line1248' class='code' style='background-color: #FFFFff'>            __pyx_t_38 = __pyx_v_k;
            __pyx_t_39 = __pyx_v_k;
            __pyx_v_x = ((*((double *) ( /* dim=0 */ (__pyx_v_xs.data + __pyx_t_38 * __pyx_v_xs.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_Tinv.data + __pyx_t_39 * __pyx_v_Tinv.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1249")'> 1249:                             idx = c_int(c_min(c_max(x, 0.000001), 0.99999) * lin_T)</pre>
<pre id='line1249' class='code' style='background-color: #FFFFff'>            __pyx_v_idx = Real2Int((fmin(fmax(__pyx_v_x, 0.000001), 0.99999) * __pyx_v_lin_T));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1250")'> 1250:                             y += lin_w[i, k, idx] * x + lin_c[i, k, idx]</pre>
<pre id='line1250' class='code' style='background-color: #FFFFff'>            __pyx_t_40 = __pyx_v_i;
            __pyx_t_41 = __pyx_v_k;
            __pyx_t_42 = __pyx_v_idx;
            __pyx_t_43 = __pyx_v_i;
            __pyx_t_44 = __pyx_v_k;
            __pyx_t_45 = __pyx_v_idx;
            __pyx_v_y = (__pyx_v_y + (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_lin_w.data + __pyx_t_40 * __pyx_v_lin_w.strides[0]) ) + __pyx_t_41 * __pyx_v_lin_w.strides[1]) ) + __pyx_t_42 * __pyx_v_lin_w.strides[2]) ))) * __pyx_v_x) + (*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_lin_c.data + __pyx_t_43 * __pyx_v_lin_c.strides[0]) ) + __pyx_t_44 * __pyx_v_lin_c.strides[1]) ) + __pyx_t_45 * __pyx_v_lin_c.strides[2]) )))));
          }
        }
        __pyx_L13:;
      }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1251")'> 1251: </pre>
<pre id='line1251' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1252")'> 1252:                 y =  y * Linv</pre>
<pre id='line1252' class='code' style='background-color: #FFFFff'>      __pyx_v_y = (__pyx_v_y * __pyx_v_Linv);
      goto __pyx_L8;
    }
    /*else*/ {
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1253")'> 1253: </pre>
<pre id='line1253' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1254")'> 1254:             else:</pre>
<pre id='line1254' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1255")'> 1255: </pre>
<pre id='line1255' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1256")'> 1256:                 # Linear value</pre>
<pre id='line1256' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1257")'> 1257:                 idx = 0</pre>
<pre id='line1257' class='code' style='background-color: #FFFFff'>      __pyx_v_idx = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1258")'> 1258:                 for k in range(D):</pre>
<pre id='line1258' class='code' style='background-color: #FFFFff'>      __pyx_t_15 = __pyx_v_D;
      for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_15; __pyx_t_16+=1) {
        __pyx_v_k = __pyx_t_16;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1259")'> 1259:                     x = xs[k] * Tinv[k]</pre>
<pre id='line1259' class='code' style='background-color: #FFFFff'>        __pyx_t_36 = __pyx_v_k;
        __pyx_t_37 = __pyx_v_k;
        __pyx_v_x = ((*((double *) ( /* dim=0 */ (__pyx_v_xs.data + __pyx_t_36 * __pyx_v_xs.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_Tinv.data + __pyx_t_37 * __pyx_v_Tinv.strides[0]) ))));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1260")'> 1260:                     idx = c_int(c_min(c_max(x, 0.000001), 0.99999) * lin_T)</pre>
<pre id='line1260' class='code' style='background-color: #FFFFff'>        __pyx_v_idx = Real2Int((fmin(fmax(__pyx_v_x, 0.000001), 0.99999) * __pyx_v_lin_T));
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1261")'> 1261:                     y += lin_w[i, k, idx] * x + lin_c[i, k, idx]</pre>
<pre id='line1261' class='code' style='background-color: #FFFFff'>        __pyx_t_46 = __pyx_v_i;
        __pyx_t_47 = __pyx_v_k;
        __pyx_t_48 = __pyx_v_idx;
        __pyx_t_49 = __pyx_v_i;
        __pyx_t_50 = __pyx_v_k;
        __pyx_t_51 = __pyx_v_idx;
        __pyx_v_y = (__pyx_v_y + (((*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_lin_w.data + __pyx_t_46 * __pyx_v_lin_w.strides[0]) ) + __pyx_t_47 * __pyx_v_lin_w.strides[1]) ) + __pyx_t_48 * __pyx_v_lin_w.strides[2]) ))) * __pyx_v_x) + (*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_lin_c.data + __pyx_t_49 * __pyx_v_lin_c.strides[0]) ) + __pyx_t_50 * __pyx_v_lin_c.strides[1]) ) + __pyx_t_51 * __pyx_v_lin_c.strides[2]) )))));
      }
    }
    __pyx_L8:;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1262")'> 1262: </pre>
<pre id='line1262' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1263")'> 1263:             # Apply feasibility constraint</pre>
<pre id='line1263' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1264")'> 1264:             values[i] = c_min(c_max(y, 0), X[i, 1])</pre>
<pre id='line1264' class='code' style='background-color: #FFFFff'>    __pyx_t_15 = __pyx_v_i;
    __pyx_t_52 = 1;
    __pyx_t_16 = __pyx_v_i;
    *((double *) ( /* dim=0 */ (__pyx_v_values.data + __pyx_t_16 * __pyx_v_values.strides[0]) )) = fmin(fmax(__pyx_v_y, 0.0), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_X.data + __pyx_t_15 * __pyx_v_X.strides[0]) ) + __pyx_t_52 * __pyx_v_X.strides[1]) ))));
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1265")'> 1265: </pre>
<pre id='line1265' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1266")'> 1266:         return values</pre>
<pre id='line1266' class='code' style='background-color: #FFFFff'>  __PYX_INC_MEMVIEW(&amp;__pyx_v_values, 0);
  __pyx_r = __pyx_v_values;
  goto __pyx_L0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1267")'> 1267: </pre>
<pre id='line1267' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFF26' onclick='toggleDiv("line1268")'> 1268:     def plot(self, xargs=0, showdata=False, label='', showplot=True):</pre>
<pre id='line1268' class='code' style='background-color: #FFFF26'>/* Python wrapper */
static PyObject *__pyx_pw_9econlearn_8tilecode_14Function_Group_7plot(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_9econlearn_8tilecode_14Function_Group_6plot[] = "\n        Plot all the user functions on one dimension\n\n        Parameters\n        -----------\n        xargs : list, length = D\n            List of variable default values, set plotting dimension to 'x'\n\n        showdata : boolean, (default=False)\n            Scatter training points\n\n        label : string, (default='')\n            Series label\n\n        showplot : boolean, (default='')\n            &gt; pylab.show()\n        ";
static PyObject *__pyx_pw_9econlearn_8tilecode_14Function_Group_7plot(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_xargs = 0;
  CYTHON_UNUSED PyObject *__pyx_v_showdata = 0;
  CYTHON_UNUSED PyObject *__pyx_v_label = 0;
  CYTHON_UNUSED PyObject *__pyx_v_showplot = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("plot (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_xargs,&amp;__pyx_n_s_showdata,&amp;__pyx_n_s_label,&amp;__pyx_n_s_showplot,0};
    PyObject* values[4] = {0,0,0,0};
    values[0] = ((PyObject *)__pyx_int_0);
    values[1] = ((PyObject *)Py_False);
    values[2] = ((PyObject *)__pyx_kp_s__2);
    values[3] = ((PyObject *)Py_True);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_xargs);
          if (value) { values[0] = value; kw_args--; }
        }
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_showdata);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_label);
          if (value) { values[2] = value; kw_args--; }
        }
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_showplot);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "plot") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_xargs = values[0];
    __pyx_v_showdata = values[1];
    __pyx_v_label = values[2];
    __pyx_v_showplot = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("plot", 0, 0, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1268; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Function_Group.plot", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_9econlearn_8tilecode_14Function_Group_6plot(((struct __pyx_obj_9econlearn_8tilecode_Function_Group *)__pyx_v_self), __pyx_v_xargs, __pyx_v_showdata, __pyx_v_label, __pyx_v_showplot);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_9econlearn_8tilecode_14Function_Group_6plot(struct __pyx_obj_9econlearn_8tilecode_Function_Group *__pyx_v_self, PyObject *__pyx_v_xargs, CYTHON_UNUSED PyObject *__pyx_v_showdata, CYTHON_UNUSED PyObject *__pyx_v_label, CYTHON_UNUSED PyObject *__pyx_v_showplot) {
  int __pyx_v_i;
  int __pyx_v_k;
  long __pyx_v_points;
  PyObject *__pyx_v_X = NULL;
  PyObject *__pyx_v_Xsmooth = NULL;
  PyObject *__pyx_v_xpoints = NULL;
  PyObject *__pyx_v_Ysmooth = NULL;
  PyObject *__pyx_v_xval = NULL;
  long __pyx_v_h;
  int __pyx_v_j;
  PyObject *__pyx_v_Y = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("plot", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("econlearn.tilecode.Function_Group.plot", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Xsmooth);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xpoints);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Ysmooth);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xval);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Y);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1269")'> 1269: </pre>
<pre id='line1269' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1270")'> 1270:         """</pre>
<pre id='line1270' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1271")'> 1271:         Plot all the user functions on one dimension</pre>
<pre id='line1271' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1272")'> 1272: </pre>
<pre id='line1272' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1273")'> 1273:         Parameters</pre>
<pre id='line1273' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1274")'> 1274:         -----------</pre>
<pre id='line1274' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1275")'> 1275:         xargs : list, length = D</pre>
<pre id='line1275' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1276")'> 1276:             List of variable default values, set plotting dimension to 'x'</pre>
<pre id='line1276' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1277")'> 1277: </pre>
<pre id='line1277' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1278")'> 1278:         showdata : boolean, (default=False)</pre>
<pre id='line1278' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1279")'> 1279:             Scatter training points</pre>
<pre id='line1279' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1280")'> 1280: </pre>
<pre id='line1280' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1281")'> 1281:         label : string, (default='')</pre>
<pre id='line1281' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1282")'> 1282:             Series label</pre>
<pre id='line1282' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1283")'> 1283: </pre>
<pre id='line1283' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1284")'> 1284:         showplot : boolean, (default='')</pre>
<pre id='line1284' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1285")'> 1285:             &gt; pylab.show()</pre>
<pre id='line1285' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1286")'> 1286:         """</pre>
<pre id='line1286' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1287")'> 1287: </pre>
<pre id='line1287' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1288")'> 1288: </pre>
<pre id='line1288' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1289")'> 1289:         cdef int i, k = 0</pre>
<pre id='line1289' class='code' style='background-color: #FFFFff'>  __pyx_v_k = 0;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1290")'> 1290: </pre>
<pre id='line1290' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1291")'> 1291:         points = 1000</pre>
<pre id='line1291' class='code' style='background-color: #FFFFff'>  __pyx_v_points = 1000;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line1292")'> 1292:         X = np.zeros([self.N, self.D])</pre>
<pre id='line1292' class='code' style='background-color: #FFFF46'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  __pyx_t_1 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_X = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line1293")'> 1293:         Xsmooth = np.zeros([self.N, points])</pre>
<pre id='line1293' class='code' style='background-color: #FFFF46'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;N);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_points);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_4 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1293; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_Xsmooth = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line1294")'> 1294:         xpoints = np.ones([self.N, points, self.D])</pre>
<pre id='line1294' class='code' style='background-color: #FFFF41'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;N);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_points);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;D);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 2, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_1 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_xpoints = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class='line' style='background-color: #FFFF46' onclick='toggleDiv("line1295")'> 1295:         Ysmooth = np.zeros([self.N, points])</pre>
<pre id='line1295' class='code' style='background-color: #FFFF46'>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;N);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_points);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_5 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1295; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_Ysmooth = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class='line' style='background-color: #FFFF6e' onclick='toggleDiv("line1296")'> 1296:         k = xargs.index('x')</pre>
<pre id='line1296' class='code' style='background-color: #FFFF6e'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_xargs, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_2);<span class='error_goto'> if (unlikely((__pyx_t_6 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_k = __pyx_t_6;
/* … */
  __pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_x);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1297")'> 1297:         for i in range(self.N):</pre>
<pre id='line1297' class='code' style='background-color: #FFFFff'>  __pyx_t_6 = __pyx_v_self-&gt;N;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFF29' onclick='toggleDiv("line1298")'> 1298:             Xsmooth[i,:] = np.linspace(self.a[i, k]*0.8, self.b[i, k]*1.2, points)</pre>
<pre id='line1298' class='code' style='background-color: #FFFF29'>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1298; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_linspace);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1298; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_8 = __pyx_v_i;
    __pyx_t_9 = __pyx_v_k;
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;a.data + __pyx_t_8 * __pyx_v_self-&gt;a.strides[0]) ) + __pyx_t_9 * __pyx_v_self-&gt;a.strides[1]) ))) * 0.8));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1298; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = __pyx_v_k;
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;b.data + __pyx_t_10 * __pyx_v_self-&gt;b.strides[0]) ) + __pyx_t_11 * __pyx_v_self-&gt;b.strides[1]) ))) * 1.2));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1298; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_points);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1298; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1298; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    __pyx_t_2 = 0;
    __pyx_t_4 = 0;
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1298; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1298; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1298; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_slice__9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
    __pyx_t_1 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_Xsmooth, __pyx_t_3, __pyx_t_5) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1298; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
  __pyx_slice__9 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1298; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1299")'> 1299:             xval = xargs</pre>
<pre id='line1299' class='code' style='background-color: #FFFFd4'>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_xargs);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_xval, __pyx_v_xargs);
</pre><pre class='line' style='background-color: #FFFFd4' onclick='toggleDiv("line1300")'> 1300:             xval[k] = 1</pre>
<pre id='line1300' class='code' style='background-color: #FFFFd4'>    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_xval, __pyx_v_k, __pyx_int_1, int, 1, __Pyx_PyInt_From_int, 0, 0, 0) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1301")'> 1301:             for h in range(points):</pre>
<pre id='line1301' class='code' style='background-color: #FFFFff'>    __pyx_t_12 = __pyx_v_points;
    for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
      __pyx_v_h = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1302")'> 1302:                 for j in range(self.D):</pre>
<pre id='line1302' class='code' style='background-color: #FFFFff'>      __pyx_t_14 = __pyx_v_self-&gt;D;
      for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_14; __pyx_t_15+=1) {
        __pyx_v_j = __pyx_t_15;
</pre><pre class='line' style='background-color: #FFFF2a' onclick='toggleDiv("line1303")'> 1303:                     xpoints[i, h, j] = xpoints[i, h, j] * xval[j]</pre>
<pre id='line1303' class='code' style='background-color: #FFFF2a'>        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_h);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        __pyx_t_5 = 0;
        __pyx_t_3 = 0;
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_xpoints, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_xval, __pyx_v_j, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_h);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_t_5);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
        __pyx_t_4 = 0;
        __pyx_t_1 = 0;
        __pyx_t_5 = 0;
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_xpoints, __pyx_t_2, __pyx_t_3) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
</pre><pre class='line' style='background-color: #FFFF35' onclick='toggleDiv("line1304")'> 1304:                 xpoints[i, h, k] = Xsmooth[i,h]</pre>
<pre id='line1304' class='code' style='background-color: #FFFF35'>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_h);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      __pyx_t_3 = 0;
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_Xsmooth, __pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_h);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      __pyx_t_5 = 0;
      __pyx_t_3 = 0;
      __pyx_t_1 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_xpoints, __pyx_t_4, __pyx_t_2) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1304; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
  }
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1305")'> 1305: </pre>
<pre id='line1305' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1306")'> 1306:         for h in range(points):</pre>
<pre id='line1306' class='code' style='background-color: #FFFFff'>  __pyx_t_12 = __pyx_v_points;
  for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
    __pyx_v_h = __pyx_t_13;
</pre><pre class='line' style='background-color: #FFFF41' onclick='toggleDiv("line1307")'> 1307:             X = xpoints[:, h, :]</pre>
<pre id='line1307' class='code' style='background-color: #FFFF41'>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_h);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  __pyx_slice__10 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__10);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__10);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_slice__10);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__10);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_slice__11);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__11);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_xpoints, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_X, __pyx_t_2);
    __pyx_t_2 = 0;
  __pyx_slice__11 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__11);
</pre><pre class='line' style='background-color: #FFFF6a' onclick='toggleDiv("line1308")'> 1308:             Y = self.predict(X)</pre>
<pre id='line1308' class='code' style='background-color: #FFFF6a'>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_predict);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_X);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_X);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1308; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_Y, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='line' style='background-color: #FFFF52' onclick='toggleDiv("line1309")'> 1309:             Ysmooth[:, h] = Y</pre>
<pre id='line1309' class='code' style='background-color: #FFFF52'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_h);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_slice__12);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__12);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    __pyx_t_1 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_Ysmooth, __pyx_t_4, __pyx_v_Y) &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
/* … */
  __pyx_slice__12 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__12);
</pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1310")'> 1310: </pre>
<pre id='line1310' class='code' style='background-color: #FFFFff'></pre><pre class='line' style='background-color: #FFFFff' onclick='toggleDiv("line1311")'> 1311:         for i in range(self.N):</pre>
<pre id='line1311' class='code' style='background-color: #FFFFff'>  __pyx_t_6 = __pyx_v_self-&gt;N;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class='line' style='background-color: #FFFF1a' onclick='toggleDiv("line1312")'> 1312:             pylab.plot(Xsmooth[i, :], Ysmooth[i, :], label = ("user " + str(i)))</pre>
<pre id='line1312' class='code' style='background-color: #FFFF1a'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_pylab);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_plot);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__13);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_slice__13);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__13);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_Xsmooth, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_4 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  __pyx_slice__13 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__13);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__14);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_slice__14);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__14);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetItem</span>(__pyx_v_Ysmooth, __pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_2 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    __pyx_t_4 = 0;
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyString_Type))), __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_user, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_label, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  __pyx_slice__14 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__14);
</pre></body></html>
